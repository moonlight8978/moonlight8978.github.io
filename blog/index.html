<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="moonlight8978's Blog Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="moonlight8978's Blog Blog Atom Feed"><title data-react-helmet="true">Blog | moonlight8978&#x27;s Blog</title><meta data-react-helmet="true" property="og:title" content="Blog | moonlight8978&#x27;s Blog"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" property="og:url" content="https://moonlight8978.github.io/blog"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_posts_list"><link data-react-helmet="true" rel="shortcut icon" href="https://avatars.githubusercontent.com/u/26299310?v=4"><link data-react-helmet="true" rel="canonical" href="https://moonlight8978.github.io/blog"><link data-react-helmet="true" rel="alternate" href="https://moonlight8978.github.io/blog" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://moonlight8978.github.io/blog" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5f3c8191.css">
<link rel="preload" href="/assets/js/runtime~main.2e9fde40.js" as="script">
<link rel="preload" href="/assets/js/main.f5ae6226.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">My Site</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Programming notes</a><a class="navbar__item navbar__link" href="/books/intro">Book notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">My Site</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Programming notes</a></li><li class="menu__list-item"><a class="menu__link" href="/books/intro">Book notes</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_2ahu thin-scrollbar"><h3 class="sidebarItemTitle_2hhb">All posts</h3><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cung-tim-hieu-ve-puma-ruby-on-rails">CÃ¹ng tÃ¬m hiá»ƒu vá» Puma (Ruby on Rails)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cuoi-react-native-xem-appium-phan-1-cung-tim-hieu-cach-hoat-dong-cua-appium">CÆ°á»¡i React Native xem Appium (Pháº§n 1 - CÃ¹ng tÃ¬m hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Appium)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/gioi-thieu-ve-kubernetes">Giá»›i thiá»‡u vá» Kubernetes</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/toi-uu-menh-de-where-mysql">Tá»‘i Æ°u má»‡nh Ä‘á» WHERE (MySQL)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cung-tim-hieu-ve-actiontext-trong-rails-6">CÃ¹ng tÃ¬m hiá»ƒu vá» ActionText trong Rails 6</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cung-tim-hieu-ve-railway-oriented-programming">CÃ¹ng tÃ¬m hiá»ƒu vá» Railway Oriented Programming</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/mot-vai-mindset-khi-lam-viec-voi-react">Má»™t vÃ i mindset khi lÃ m viá»‡c vá»›i React</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cung-tim-hieu-ve-nguyen-tu-cua-the-gioi-front-end-phan-2-density-independent-pixel">CÃ¹ng tÃ¬m hiá»ƒu vá» nguyÃªn tá»­ cá»§a tháº¿ giá»›i FrontEnd (Pháº§n 2 - Density-independent Pixel)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/cung-tim-hieu-ve-nguyen-tu-cua-the-gioi-front-end-phan-1-pixel">CÃ¹ng tÃ¬m hiá»ƒu vá» nguyÃªn tá»­ cá»§a tháº¿ giá»›i FrontEnd (Pháº§n 1 - Pixel)</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/tdd-bdd-noi-de-hon-lam">TDD/BDD - NÃ³i dá»… hÆ¡n lÃ m</a></li></ul></div></div><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cung-tim-hieu-ve-puma-ruby-on-rails">CÃ¹ng tÃ¬m hiá»ƒu vá» Puma (Ruby on Rails)</a></h2><div class="margin-vert--md"><time datetime="2021-05-31T00:00:00.000Z" class="blogPostDate_fNvV">May 31, 2021 Â· 11 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-má»Ÿ-Ä‘áº§u"></a>1. Má»Ÿ Ä‘áº§u<a class="hash-link" href="#1-má»Ÿ-Ä‘áº§u" title="Direct link to heading">#</a></h2><p>Cháº¯c háº³n Puma khÃ´ng pháº£i má»™t cÃ¡i tÃªn xa láº¡ Ä‘á»‘i vá»›i má»—i Rails developer, má»™t pháº§n cÅ©ng vÃ¬ Ä‘Ã¢y lÃ  appserver máº·c Ä‘á»‹nh khi táº¡o má»›i má»™t project Rails.</p><p>HÃ£y cÃ¹ng nhÃ¬n qua nhá»¯ng config cÆ¡ báº£n khi cháº¡y 1 á»©ng dá»¥ng Rails vá»›i Puma server. <a href="https://github.com/rails/rails/blob/0f5700ac3589081126fbfde1e4037dc1d4166cce/railties/lib/rails/generators/rails/app/templates/config/puma.rb.tt" target="_blank" rel="noopener noreferrer">link</a></p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">config/puma.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">max_threads_count = ENV.fetch(&quot;RAILS_MAX_THREADS&quot;) { 5 }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">min_threads_count = ENV.fetch(&quot;RAILS_MIN_THREADS&quot;) { max_threads_count }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">threads min_threads_count, max_threads_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">worker_timeout 3600 if ENV.fetch(&quot;RAILS_ENV&quot;, &quot;development&quot;) == &quot;development&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">port ENV.fetch(&quot;PORT&quot;) { 3000 }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">environment ENV.fetch(&quot;RAILS_ENV&quot;) { &quot;development&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pidfile ENV.fetch(&quot;PIDFILE&quot;) { &quot;tmp/pids/server.pid&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">workers ENV.fetch(&quot;WEB_CONCURRENCY&quot;) { 2 }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">preload_app!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plugin :tmp_restart</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Äá»‘i vá»›i nhá»¯ng ngÆ°á»i má»›i báº¯t Ä‘áº§u, khi deploy puma, cÃ³ láº½ sáº½ tá»« chá»‘i hiá»ƒu Ä‘á»‘ng config trÃªn vÃ  set má»™t sá»‘ biáº¿n mÃ´i trÆ°á»ng nhÆ° sau:</p><ul><li><code>WEB_CONCURRENCY</code>: báº±ng vá»›i sá»‘ lÆ°á»£ng vcore/process cá»§a mÃ¡y</li><li><code>RAILS_MAX_THREADS</code>: á» thÃ¬ nhiá»u RAM thÃ¬ set 16, 32 cho oÃ¡ch, khÃ´ng thÃ¬ thÃ´i dÃ¹ng máº·c Ä‘á»‹nh 5 vÃ  máº·c do dÃ²ng Ä‘á»i xÃ´ Ä‘áº©y :v</li></ul><p>HÃ£y cÃ¹ng tÃ¬m hiá»ƒu thÃªm vá» Puma Ä‘á»ƒ gÃ³p pháº§n lÃ m chá»§ tá»«ng dÃ²ng code trong app cá»§a chÃºng ta.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-multi-processing-vÃ -multi-threading"></a>2. Multi-processing vÃ  Multi-threading<a class="hash-link" href="#2-multi-processing-vÃ -multi-threading" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="21-puma-dÃ¹ng-loáº¡i-nÃ o"></a>2.1. Puma dÃ¹ng loáº¡i nÃ o?<a class="hash-link" href="#21-puma-dÃ¹ng-loáº¡i-nÃ o" title="Direct link to heading">#</a></h3><ul><li>Khi cháº¡y 1 Rails app má»›i táº¡o, hÃ£y Ä‘á»ƒ Ã½ lÃºc boot server, báº¡n sáº½ tháº¥y:</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Puma starting in single mode...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Puma version: 5.3.1 (ruby 3.0.1-p64) (&quot;Sweetnighter&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*  Min threads: 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*  Max threads: 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*  Environment: development</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*          PID: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* Listening on http://0.0.0.0:3000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Use Ctrl-C to stop</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ÄÃ¢y lÃ  dáº¥u hiá»‡u cho ta tháº¥y, Rails Ä‘ang cháº¡y á»Ÿ cháº¿ Ä‘á»™ single process (1 process), vÃ  multi-thread (cá»¥ thá»ƒ lÃ  5 thread)</p><ul><li>CÃ²n khi config deploy, cÃ³ thá»ƒ báº¡n sáº½ Ä‘Æ°á»£c 1 ngÆ°á»i cÃ³ kinh nghiá»‡m hÆ¡n báº£o ráº±ng <em>&quot;Bá» comment cÃ¡i dÃ²ng <code>workers ENV.fetch(&quot;WEB_CONCURRENCY&quot;) { 2 }</code> Ä‘i em Ãªi&quot;</em></li></ul><p>VÃ  Ä‘Ã¢y lÃ  káº¿t quáº£ khi ta lÃ m nhÆ° váº­y</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] Puma starting in cluster mode...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] * Puma version: 5.3.1 (ruby 3.0.1-p64) (&quot;Sweetnighter&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *  Min threads: 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *  Max threads: 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *  Environment: development</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *   Master PID: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *      Workers: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] *     Restarts: (ï¿½ï¿½ï¿½) hot (ï¿½ï¿½ï¿½) phased</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] * Preloading application</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] * Listening on htp://0.0.0.0:3000</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] Use Ctrl-C to stop</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] - Worker 0 (PID: 16) booted in 0.02s, phase: 0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[1] - Worker 1 (PID: 17) booted in 0.05s, phase: 0</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Puma Ä‘ang cháº¡y Ä‘á»“ng thá»i multi-process (2 process) vÃ  multi-thread (5 thread)</p><blockquote><p>Multi-process, multi-thread lÃ  cÃ¡i cá»§a ná»£ gÃ¬ váº­y?</p></blockquote><p>ChÃºng ta sáº½ tÃ¬m hiá»ƒu vá» nÃ³ ngay sau Ä‘Ã¢y. Tuy nhiÃªn chÃºng ta sáº½ focus vÃ o cluster mode cá»§a Puma nhÃ©.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="22-multi-threading"></a>2.2. Multi-threading<a class="hash-link" href="#22-multi-threading" title="Direct link to heading">#</a></h3><p>TrÆ°á»›c tiÃªn ta hÃ£y nhá»› láº¡i Ä‘á»‹nh nghÄ©a vá» <code>process</code> - tiáº¿n trÃ¬nh, má»—i khi ta cháº¡y 1 command nÃ o Ä‘Ã³ (vÃ­ dá»¥ nhÆ° <code>ruby xxx.rb</code> hay báº­t chrome cháº³ng háº¡n), OS sáº½ táº¡o 1 process Ä‘á»ƒ xá»­ lÃ½ command cá»§a ta.</p><p>Má»—i <em>process</em> cÃ³ thá»ƒ táº¡o ra nhiá»u <em>thread</em> Ä‘á»ƒ xá»­ lÃ½ task (vÃ­ dá»¥ má»—i tab chrome Ä‘Æ°á»£c handle bá»Ÿi 1 thread). CÃ¡c thread Ä‘Æ°á»£c táº¡o bá»Ÿi 1 process sáº½ share nhau 1 vÃ¹ng nhá»› (memory), trong shared memory nÃ y, má»—i thread sáº½ cÃ³ stack, register (google Ä‘á»ƒ biáº¿t thÃªm Ä‘á»‘ng nÃ y lÃ  gÃ¬ =)) ) riÃªng cá»§a mÃ¬nh. Tuy nhiÃªn, viá»‡c chung Ä‘á»¥ng memory nhÆ° trÃªn sáº½ dáº«n Ä‘áº¿n 1 váº¥n Ä‘á» lÃ  nhiá»u thread cÃ¹ng chá»c tá»›i 1 resource nÃ o Ä‘Ã³, dáº«n tá»›i conflict vá» data, hay cÃ²n Ä‘Æ°á»£c biáº¿t Ä‘áº¿n vá»›i cÃ¡i tÃªn nguy hiá»ƒm hÆ¡n lÃ  <strong>race condition</strong>. Code cá»§a ta sáº½ cáº§n <em>thread-safe</em> (cÃ¡c báº¡n cÃ³ thá»ƒ google thÃªm :v)</p><p>Äá»‘i vá»›i á»©ng dá»¥ng Ruby thÃ¬ khi cháº¡y á»Ÿ mÃ´i trÆ°á»ng MRI... Ã€ Ä‘áº¥y láº¡i nháº¯c tá»›i MRI, cháº¯c nhiá»u ngÆ°á»i sáº½ tháº¯c máº¯c liá»‡u Ä‘Ã³ lÃ  gÃ¬. ÄÃ¢y lÃ  tÃªn cá»§a 1 Ruby Runtime. Ruby 1 chuáº©n spec, implement kiá»ƒu gÃ¬ cÅ©ng Ä‘Æ°á»£c, miá»…n lÃ  Ä‘Ã¡p á»©ng Ä‘Æ°á»£c spec Ä‘Ã³ thÃ¬ Ä‘á»u lÃ  Ruby. CÃ³ thá»ƒ ká»ƒ Ä‘áº¿n cÃ¡c Runtime phá»• biáº¿n sau</p><ul><li><p>MRI - aka CRuby: Matzâ€™s Ruby Interpreter (Matz - hay Matsumoto Yukihiro) lÃ  ngÆ°á»i táº¡o ra runtime nÃ y, Ä‘Æ°á»£c viáº¿t báº±ng C, nÃªn cÃ²n gá»i lÃ  CRuby</p><p>Äa sá»‘ lÃ  dÃ¹ng MRI</p></li><li><p>JRuby: Ruby implement báº±ng Java</p></li><li><p>Rubinius</p></li><li><p>mruby</p></li><li><p>...</p></li></ul><p>MRI cÃ³ 1 cÆ¡ cháº¿ lÃ  <strong>Global Interpreter Lock</strong> (GIL), khi cháº¡y multi-thread, nÃ³ chá»‰ cho phÃ©p 1 thread cháº¡y source code Ruby táº¡i 1 thá»i Ä‘iá»ƒm, nÃªn lÃ  ta cÃ³ nhiá»u thread Ä‘i chÄƒng ná»¯a thÃ¬ cÅ©ng chá»‰ cÃ³ 1 thread Ä‘Æ°á»£c cháº¡y mÃ  thÃ´i.</p><p>Tuy nhiÃªn vá»›i cÃ¡c thao tÃ¡c IO nhÆ° Ä‘á»c DB, request external resource, Ä‘á»c ghi file, ... thÃ¬ GIL khÃ´ng block. Puma Ä‘Ã£ táº­n dá»¥ng Ä‘iá»u nÃ y, khi 1 thread Ä‘ang xá»­ lÃ½ IO, nÃ³ sáº½ quay trá»Ÿ láº¡i xá»­ lÃ½ á»Ÿ process, nháº­n thÃªm cÃ¡c request khÃ¡c Ä‘á»ƒ xá»­ lÃ½.</p><p>ChÃ­nh vÃ¬ váº­y, ngay cáº£ khi chá»‰ cháº¡y á»Ÿ single mode, Puma váº«n cÃ³ thá»ƒ handle Ä‘Æ°á»£c concurrent request. Tuy nhiÃªn vá»›i cÃ¡c request cáº§n thá»i gian dÃ i Ä‘á»ƒ xá»­ lÃ½, do chá»‰ cÃ³ 1 thread Ä‘Æ°á»£c cháº¡y, nÃªn request sau sáº½ pháº£i chá» request trÆ°á»›c xá»­ lÃ½ xong, dáº«n Ä‘áº¿n Puma bá»‹ thá»t trong trÆ°á»ng há»£p nÃ y.</p><p>Ta cÃ³ thá»ƒ kiá»ƒm tra vá» tráº¡ng thÃ¡i cÃ¡c thread cá»§a Puma báº±ng Ä‘oáº¡n code sau:</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">app/controllers/homes_controller.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class HomesController &lt; ApplicationController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def show</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Thread.list.select { |t| t.name&amp;.match?(/puma threadpool \d+/) }.each do |t|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Rails.logger.info(&quot;Thread #{t.name}: #{t.status}, alive: #{t.alive?}, current: #{t == Thread.current}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    head :ok</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>VÃ¬ sao láº¡i lÃ  <code>/puma threadpool \d+/</code>? CÃ¡c báº¡n cÃ³ thá»ƒ xem táº¡i <a href="https://github.com/puma/puma/blob/3e80f7c704e5585da4faa32edf0fa7a0abed3689/lib/puma/thread_pool.rb#L104" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a>.</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">config/routes.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Rails.application.routes.draw do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  resource :home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">config/puma.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">max_threads_count = ENV.fetch(&#x27;RAILS_MAX_THREADS&#x27;, 5)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">min_threads_count = ENV.fetch(&#x27;RAILS_MIN_THREADS&#x27;) { max_threads_count }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">threads min_threads_count, max_threads_count</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">worker_timeout 3600 if ENV.fetch(&#x27;RAILS_ENV&#x27;, &#x27;development&#x27;) == &#x27;development&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">port ENV.fetch(&#x27;PORT&#x27;, 3000)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">environment ENV.fetch(&#x27;RAILS_ENV&#x27;, &#x27;development&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pidfile ENV.fetch(&#x27;PIDFILE&#x27;, &#x27;tmp/pids/server.pid&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">plugin :tmp_restart</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly curl"><div tabindex="0" class="prism-code language-curl codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:3000/home</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">tail -n 50 log/development.log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>VÃ  Ä‘Ã¢y lÃ  output:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread puma threadpool 001: sleep, alive: true, current: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread puma threadpool 002: sleep, alive: true, current: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread puma threadpool 003: sleep, alive: true, current: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread puma threadpool 004: sleep, alive: true, current: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Thread puma threadpool 005: run, alive: true, current: true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ÄÃ³ chÃ­nh lÃ  5 thread cá»§a chÃºng ta, nhÆ° vÃ­ dá»¥ lÃ  thread 5 Ä‘ang tiáº¿n hÃ nh xá»­ lÃ½ request, cÃ²n nhá»¯ng thread khÃ¡c náº¿u ráº£nh nÃ³ sáº½ á»Ÿ tráº¡ng thÃ¡i <code>sleep</code>. á» Ä‘Ã¢y cÃ³ 1 Ä‘iá»ƒm Ä‘Ã¡ng chÃº Ã½ lÃ  sau khi káº¿t thÃºc request, thread khÃ´ng bá»‹ kill mÃ  chá»‰ vá» tráº¡ng thÃ¡i <code>sleep</code>, do váº­y náº¿u ta tuá»³ tiá»‡n modify biáº¿n global, nÃ³ sáº½ áº£nh hÆ°á»Ÿng tá»›i request tiáº¿p theo mÃ  thread Ä‘Ã³ handle.</p><p>VÃ­ dá»¥:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">before_action :set_locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def set_locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  I18n.locale = params[:locale] || I18n.default_locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>KhÃ´ng cáº§n biáº¿t code cÃ¡i gÃ¬, nhÆ°ng modify 1 biáº¿n global táº¡i runtime nhÆ° trÃªn lÃ  Ä‘Ã£ tháº¥y nguy hiá»ƒm rá»“i. VÃ  ta hÃ£y tiáº¿n hÃ nh test xem</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">app/controllers/homes_controller.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class HomesController &lt; ApplicationController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def show</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Thread.current.tap { |t| Rails.logger.info(&quot;Current thread #{t.name}: #{t.status}, alive: #{t.alive?}&quot;) }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Rails.logger.info(&quot;Before: #{I18n.locale}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    I18n.locale = params[:locale]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Rails.logger.info(&quot;After: #{I18n.locale}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    head :ok</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>rá»“i sau Ä‘Ã³ spam khoáº£ng chá»¥c cÃ¡i request</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://localhost:3000/home?locale</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">vi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>vÃ  ta sáº½ tháº¥y káº¿t quáº£ nhÆ° sau</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">log/development.log</div><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Current thread puma threadpool 003: run, alive: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Before: en</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">After: vi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Current thread puma threadpool 003: run, alive: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Before: vi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">After: vi</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ³ thá»ƒ dá»… dÃ ng nháº­n ra ráº±ng viá»‡c set <code>I18n.locale = &quot;vi&quot;</code> á»Ÿ request trÆ°á»›c Ä‘Ã£ bá»‹ leak sang request sau. Náº¿u á»Ÿ táº¥t cáº£ cÃ¡c request, trÆ°á»›c khi xá»­ lÃ½ ta Ä‘á»u set <code>I18n.locale</code> thÃ¬ viá»‡c leak trÃªn sáº½ Ã­t áº£nh hÆ°á»Ÿng hÆ¡n.</p><p>Tuy nhiÃªn hÃ£y thá»­ tÆ°á»Ÿng tÆ°á»£ng khi app cá»§a báº¡n cÃ³ chá»©a cáº£ code admin vÃ  api, bÃªn admin cÃ³ thá»ƒ Ä‘á»•i ngÃ´n ngá»¯, cÃ²n api thÃ¬ khÃ´ng, thÃ¬ káº¿t quáº£ sáº½ ra sao. Khi admin Ä‘á»•i ngÃ´n ngá»¯, tÃ¬nh cá», 1 user vÃ´ phÃºc nÃ o Ä‘Ã³ request tá»›i trÃºng cÃ¡i thread vá»«a handle viá»‡c admin Ä‘á»•i ngÃ´n ngá»¯, vÃ  API sáº½ tráº£ vá» locale cá»§a Ã´ng admin kia :v</p><p>ChÃ­nh vÃ¬ váº­y, á»Ÿ docs cá»§a Rails cÅ©ng cÃ³ recommend chÃºng ta xá»­ lÃ½ chuyá»ƒn locale báº±ng <code>I18n.with_locale</code>, cÃ¡c báº¡n cÃ³ thá»ƒ xem táº¡i <a href="https://guides.rubyonrails.org/i18n.html#managing-the-locale-across-requests" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">around_action :switch_locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def switch_locale(&amp;action)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  locale = params[:locale] || I18n.default_locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  I18n.with_locale(locale, &amp;action)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>TÃºm vÃ¡y láº¡i lÃ  multi-threading há»— trá»£ concurrent ráº¥t tá»‘t, tuy nhiÃªn cÅ©ng áº©n chá»©a 1 vÃ i váº¥n Ä‘á». NÃªn sáº½ cáº§n chÃº Ã½ hÆ¡n khi code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="23-multi-processing"></a>2.3. Multi-processing<a class="hash-link" href="#23-multi-processing" title="Direct link to heading">#</a></h3><p>MÃ¡y tÃ­nh hiá»‡n nay Ä‘a sá»‘ Ä‘á»u cÃ³ khÃ¡ nhiá»u core, vÃ  Ä‘á»u há»— trá»£ Ä‘a nhiá»‡m Ä‘á»ƒ tá»‘i Æ°u hoÃ¡ viá»‡c xá»­ lÃ½ song song. Váº­y vá»›i webserver thÃ¬ sao? CÃ³ cáº§n chá»©, multi-processing giÃºp ta cÃ³ thá»ƒ xá»­ lÃ½ thÃªm nhiá»u request Ä‘á»“ng thá»i hÆ¡n ná»¯a. Trá»« khi server cá»§a ta quÃ¡ yáº¿u, chá»© khÃ´ng thÃ¬ tá»™i gÃ¬, nhÃ  cháº£ cÃ³ gÃ¬ ngoÃ i core mÃ  láº¡i cháº¡y Ä‘Æ¡n nhÃ¢n thÃ¬ phÃ­ cá»§a giá»i quÃ¡ :v</p><p>Máº·c Ä‘á»‹nh Puma sáº½ cháº¡y á»Ÿ single mode, khi Ä‘Ã³ chá»‰ cÃ³ 1 process, process nÃ y sáº½ Ä‘áº£m nháº­n háº¿t tá»« viá»‡c lÆ°u code cá»§a app, tiáº¿p nháº­n request, ... sau Ä‘Ã³ sáº½ Ä‘áº©y request sang cho cÃ¡c thread xá»­ lÃ½ nhÆ° Ä‘Ã£ mÃ´ táº£ á»Ÿ trÃªn.</p><p>CÃ²n Ä‘á»‘i vá»›i cluster mode, trÆ°á»›c háº¿t Puma sáº½ táº¡o ra má»™t master process. Tá»« process nÃ y, dá»±a vÃ o giÃ¡ trá»‹ cá»§a config dÆ°á»›i, Puma sáº½ <em>fork</em> Ä‘á»ƒ táº¡o ra sá»‘ process tÆ°Æ¡ng á»©ng, hay cÃ²n gá»i lÃ  <em>worker</em>.</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">config/puma.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">workers ENV.fetch(&quot;WEB_CONCURRENCY&quot;) { 2 }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Láº¡i nÃ³i vá» fork, Ä‘Ã¢y lÃ  quÃ¡ trÃ¬nh mÃ  1 process táº¡o ra 1 process má»›i, gá»i lÃ  <em>child process</em>. Má»—i child process Ä‘á»u cÃ³ process id (PID) riÃªng biá»‡t, vÃ  má»™t mÃ´i trÆ°á»ng riÃªng tÃ¡ch biá»‡t hoÃ n toÃ n vá»›i parent process (source code, memory, stack, ...). KhÃ´ng nhÆ° thread váº«n share code vá»›i process, nhÆ°ng cÃ³ stack, register riÃªng. Do váº­y, cÃ³ thá»ƒ nÃ³i forking an toÃ n vÃ  báº£o máº­t hÆ¡n so vá»›i multi-thread.</p><p>Quay trá»Ÿ láº¡i vá»›i Puma, á»Ÿ cluster mode, master process chá»‰ Ä‘áº£m nháº­n viá»‡c tiáº¿p nháº­n request, sau Ä‘Ã³ sáº½ báº¯n sang cÃ¡c worker Ä‘á»ƒ chÃºng tá»± xá»­ vá»›i cÃ¡c thread mÃ  chÃºng spawn. CÃ¡c worker cá»§a Puma Ä‘á»u cÃ³ 1 báº£n copy source code app riÃªng, nÃªn khi cháº¡y nhiá»u worker, hÃ£y cháº¯c cháº¯n lÃ  server cá»§a báº¡n cÃ³ Ä‘á»§ RAM :v</p><p>á» Ruby, cÃ³ thá»ƒ kiá»ƒm tra xem app cá»§a ta Ä‘ang cháº¡y á»Ÿ process nÃ o báº±ng cÃ¡ch sá»­ dá»¥ng</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Process.pid  # Current child process</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Process.ppid # Parent process</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>HÃ£y thá»­ á»Ÿ app Rails cá»§a ta xem</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">app/controllers/homes_controller.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class HomesController &lt; ApplicationController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def show</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Rails.logger.info(&quot;Current: #{Process.pid}. Parent: #{Process.ppid}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    head :ok</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">config/puma.rb</div><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">workers 2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">log/development.log</div><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Processing by HomesController#show as */*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Current: 128. Parent: 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Processing by HomesController#show as */*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Current: 129. Parent: 1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ps</span><span class="token plain"> aux</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># root         1  0.5  7.1 236000 145864 pts/0   Ssl+ 03:28   0:04 puma 5.3.1 (tcp://0.0.0.0:3000) [app]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># root         7  0.0  0.1   3544  3192 pts/1    Ss   03:29   0:00 zsh</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># root       128  0.0  6.9 288680 142008 pts/0   Sl+  03:29   0:00 puma: cluster worker 0: 1 [app]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># root       129  0.0  6.9 288720 142116 pts/0   Sl+  03:29   0:00 puma: cluster worker 1: 1 [app]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># root       219  0.0  0.0   1640   856 pts/1    R+   03:40   0:00 ps aux</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-káº¿t-luáº­n"></a>3. Káº¿t luáº­n<a class="hash-link" href="#3-káº¿t-luáº­n" title="Direct link to heading">#</a></h2><p>Cáº£ multi-threading vÃ  multi-processing Ä‘á»u quan trá»ng, chÃºng gÃ³p pháº§n giÃºp app ta xá»­ lÃ½ Ä‘c concurrent request. Hy vá»ng bÃ i viáº¿t cÃ³ thá»ƒ giÃºp Ã­ch cho cÃ¡c báº¡n Ã­t nhiá»u.</p><p>NgoÃ i ra, vá» váº¥n Ä‘á» set sá»‘ worker vÃ  thread á»Ÿ pháº§n Ä‘áº§u Ä‘Ã£ nÃ³i, tá»‘t nháº¥t cháº¯c váº«n lÃ :</p><ul><li><code>WEB_CONCURRENCY</code> = vcore, ngoÃ i ra cÃ²n phá»¥ thuá»™c vÃ o RAM ná»¯a</li><li><code>RAILS_MAX_THREADS</code> khÃ´ng cÃ³ con sá»‘ cá»¥ thá»ƒ, phá»¥ thuá»™c vÃ o RAM vÃ  CPU, nhiá»u RAM, CPU khoáº» thÃ¬ set Ä‘Æ°á»£c cÃ ng nhiá»u, nhÆ°ng cÅ©ng khÃ¡ lÃ  hÃªn xui, pháº£i tiáº¿n hÃ nh test rá»“i má»›i cÄƒn chá»‰nh con sá»‘ phÃ¹ há»£p Ä‘Æ°á»£c =))</li></ul><p>Náº¿u cÃ³ sai sÃ³t gÃ¬ cÃ¡c báº¡n cá»© gáº¡ch Ä‘Ã¡ thoáº£i mÃ¡i Ã  :v chi tiáº¿t cÃ³ thá»ƒ tham kháº£o á»Ÿ <a href="https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server#workers" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-tham-kháº£o"></a>4. Tham kháº£o<a class="hash-link" href="#4-tham-kháº£o" title="Direct link to heading">#</a></h2><ul><li><a href="https://www.speedshop.co/2015/07/29/scaling-ruby-apps-to-1000-rpm.html" target="_blank" rel="noopener noreferrer">https://www.speedshop.co/2015/07/29/scaling-ruby-apps-to-1000-rpm.html</a></li><li><a href="https://devcenter.heroku.com/articles/concurrency-and-database-connections" target="_blank" rel="noopener noreferrer">https://devcenter.heroku.com/articles/concurrency-and-database-connections</a></li><li><a href="https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="noopener noreferrer">https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server</a></li><li><a href="http://www.geekride.com/fork-forking-vs-threading-thread-linux-kernel/" target="_blank" rel="noopener noreferrer">http://www.geekride.com/fork-forking-vs-threading-thread-linux-kernel/</a></li><li><a href="https://www.studytonight.com/operating-system/multithreading" target="_blank" rel="noopener noreferrer">https://www.studytonight.com/operating-system/multithreading</a></li><li><a href="https://www.tutorialspoint.com/how-to-create-a-process-in-linux#:~:text=A%20new%20process%20can%20be,newly%20is%20called%20child%20process" target="_blank" rel="noopener noreferrer">https://www.tutorialspoint.com/how-to-create-a-process-in-linux#:~:text=A%20new%20process%20can%20be,newly%20is%20called%20child%20process</a>.</li></ul></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/puma">puma</a><a class="margin-horiz--sm" href="/blog/tags/ruby-on-rails">ruby-on-rails</a><a class="margin-horiz--sm" href="/blog/tags/multi-threading">multi-threading</a><a class="margin-horiz--sm" href="/blog/tags/multi-processing">multi-processing</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cuoi-react-native-xem-appium-phan-1-cung-tim-hieu-cach-hoat-dong-cua-appium">CÆ°á»¡i React Native xem Appium (Pháº§n 1 - CÃ¹ng tÃ¬m hiá»ƒu cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Appium)</a></h2><div class="margin-vert--md"><time datetime="2021-01-04T00:00:00.000Z" class="blogPostDate_fNvV">January 4, 2021 Â· 14 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>Do dÃ²ng Ä‘á»i Ä‘Æ°a Ä‘áº©y vÃ  khÃ¡ch thÃ¬ tiá»n Ã­t nhÆ°ng láº¡i thÃ­ch hÃ­t hÃ ng thÆ¡m (toÃ n Ä‘Ã²i 80~100 coverage -_-) nÃªn mÃ¬nh cÅ©ng Ä‘Ã£ kinh qua <a href="https://github.com/callstack/react-native-testing-library" target="_blank" rel="noopener noreferrer">react-native-testing-library</a> má»™t thá»i gian kha khÃ¡, vÃ  cÅ©ng nghá»‹ch thá»­ <a href="https://github.com/wix/Detox" target="_blank" rel="noopener noreferrer">Detox</a>, nhÆ°ng chÆ°a tháº±ng nÃ o lÃ m mÃ¬nh hÃ i lÃ²ng:</p><ul><li>Testing-library: Khi test e2e thÃ¬ pháº£i mock quÃ¡ nhiá»u, khÃ¡ khÃ³ Ä‘á»ƒ mock component sao cho hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° component tháº­t. CÃ³ nhá»¯ng lÃºc mÃ¬nh chá»‰ viáº¿t Ä‘á»ƒ cho % coverage lÃªn chá»© cÃ¡c fn cá»§a test Ä‘Ã³ bá»‹ mock háº¿t, thÃ nh ra cháº£ cÃ³ Ã½ nghÄ©a gÃ¬ nhiá»u. CÃ¡c thÃ nh pháº§n UI bá»‹ mock háº¿t, nÃªn test pass mÃ  váº«n cháº¿t lÃ  Ä‘iá»u bÃ¬nh thÆ°á»ng nhÆ° cÃ¢n Ä‘Æ°á»ng há»™p sá»¯a.</li><li>Detox: chÆ¡i vá»›i má»—i simulator, device tháº­t ko rÃµ tá»›i giá» Ä‘Ã£ Ä‘Æ°á»£c Ä‘Ã¡nh Ä‘iá»‡n tá»­ chÆ°a.</li></ul><p>VÃ  gáº§n Ä‘Ã¢y thÃ¬ mÃ¬nh Ä‘á»c láº¡i <a href="https://reactnative.dev/docs/testing-overview#end-to-end-tests" target="_blank" rel="noopener noreferrer">docs cá»§a React Native</a> cÃ³ recommend thÃªm 1 tháº±ng - Appium. Appium sá»­ dá»¥ng driver nhÆ° XCUITest, UIAutomator, Espresso, ... ÄÆ°á»£c cÃ¡c teito (tay to :v) native á»Ÿ cÃ´ng ty báº£o máº¥y tháº±ng driver trÃªn toÃ n lÃ  hÃ ng há»‹n bÃªn native dÃ¹ng Ä‘á»ƒ cháº¡y test, nÃªn thá»­ nghá»‹ch luÃ´n. Sau má»™t thá»i gian mÃ y mÃ² thÃ¬ khÃ¡ hÃ i lÃ²ng.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="táº¡i-sao-láº¡i-dÃ¹ng-appium-mÃ -ko-cháº¡y-cÆ¡m-cho-khá»e"></a>Táº¡i sao láº¡i dÃ¹ng Appium mÃ  ko cháº¡y cÆ¡m cho khá»e?<a class="hash-link" href="#táº¡i-sao-láº¡i-dÃ¹ng-appium-mÃ -ko-cháº¡y-cÆ¡m-cho-khá»e" title="Direct link to heading">#</a></h4><p>NÃ³i tháº¿ chá»© thá»±c ra thÃ¬ cháº¡y cÆ¡m khÃ´ng há» khá»e tÃ­ nÃ o Ä‘Ã¢u cÃ¡c báº¡n.</p><p>Khi ta phÃ¡t triá»ƒn 1 feature má»›i cho app, ta pháº£i test cho cáº£ nhá»¯ng tÃ­nh nÄƒng Ä‘Ã£ cÃ³, áº£nh hÆ°á»Ÿng tá»›i chÃºng lÃ  Ä‘iá»u khÃ³ trÃ¡nh khá»i.</p><p>ThÃ´ng thÆ°á»ng dev chÃºng ta sáº½ nghÄ© lÃ  &quot;CÃ³ tester rá»“i xoáº¯n gÃ¬&quot; Ä‘Ãºng khÃ´ng nÃ o? Tuy nhiÃªn pháº­n dev quÃ¨n thÃ¬ cÅ©ng váº«n pháº£i check qua nhá»¯ng case cÆ¡ báº£n, (test thÃªm case dá»‹ cÃ ng tá»‘t) trÆ°á»›c khi chuyá»ƒn qua cho tester. NhÆ°ng khÃ´ng láº½ cá»© viáº¿t má»™t feature lÃ  ngá»“i báº­t app lÃªn báº¥m tá»«ng nÃºt, chÆ°a ká»ƒ <del>xe Ä‘áº¡p má»›i ( mÃ¬nh cÃ³ má»™t ngÆ°á»i báº¡n ráº¥t hay nháº§m newbie vÃ  newbike =)) )</del> newbie khÃ´ng náº¯m rÃµ há»‡ thá»‘ng, lack case lÃ  Ä‘iá»u táº¥t nhiÃªn, hÆ¡n ná»¯a con ngÆ°á»i chÃºng ta khÃ´ng giá»i trong nhá»¯ng viá»‡c nhÃ m chÃ¡n cÃ³ tÃ­nh láº·p láº¡i cao nhÆ° test app, vÃ¬ váº­y dÃ¹ cÃ³ lÃ  bÃ´ lÃ£o thÃ¬ cÅ©ng sáº½ cÃ³ lÃºc nháº§m láº«n.</p><p>NgoÃ i ra, á»Ÿ cuá»‘n &quot;The Effective Engineer&quot; cá»§a Edmond Lau (náº¿u ko cÃ³ gÃ¬ sai sÃ³t thÃ¬ lÃ  trang 159) cÃ³ viáº¿t:</p><blockquote><p>If you have to do something manually more than twice, then write a tool for the third time</p></blockquote><p>Váº­y thÃ¬ sao chÃºng ta khÃ´ng Ä‘á»ƒ mÃ¡y lÃ m nhá»¯ng cÃ´ng viá»‡c nhÃ m chÃ¡n nhÆ° test, vÃ  focus vÃ o nhá»¯ng viá»‡c khiáº¿n ta há»©ng thÃº hÆ¡n. HÃ£y cÃ¹ng há»c viáº¿t test tá»± Ä‘á»™ng cho á»©ng dá»¥ng React Native cá»§a chÃºng ta thÃ´i nÃ o!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="má»™t-vÃ i-kiáº¿n-thá»©c-cáº§n-cÃ³"></a>Má»™t vÃ i kiáº¿n thá»©c cáº§n cÃ³<a class="hash-link" href="#má»™t-vÃ i-kiáº¿n-thá»©c-cáº§n-cÃ³" title="Direct link to heading">#</a></h3><ul><li>React Native, Babel (khÃ´ng cáº§n quÃ¡ mÃ¡t tÆ¡)</li><li>Náº¯m Ä‘Æ°á»£c cÆ¡ báº£n vá» viáº¿t unit test (vá»›i jest, hay gÃ¬ Ä‘Ã³ tÆ°Æ¡ng tá»±)</li><li>Typescript (optional): do á»Ÿ bÃ i viáº¿t sáº½ dÃ¹ng Typescript</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hardware"></a>Hardware<a class="hash-link" href="#hardware" title="Direct link to heading">#</a></h3><ul><li>MÃ¡y Mac/Hackintosh Ä‘á»ƒ build iOS hoáº·c mÃ¡y Win (chá»‰ cháº¡y Ä‘Æ°á»£c Android thÃ´i)</li><li>1 con Ä‘iá»‡n thoáº¡i iOS hoáº·c Android - nÃ³i khÃ´ng vá»›i integration test trÃªn simulator :v</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-cháº¡y-thá»­-vÃ­-dá»¥-nhá»"></a>2. Cháº¡y thá»­ vÃ­ dá»¥ nhá»<a class="hash-link" href="#2-cháº¡y-thá»­-vÃ­-dá»¥-nhá»" title="Direct link to heading">#</a></h1><p>Tá»± dÆ°ng nhá»“i má»™t Ä‘á»‘ng lÃ½ thuyáº¿t suÃ´ng, trong khi khÃ´ng biáº¿t mÃ¬nh sáº½ lÃ m gÃ¬ cÃ³ pháº£i ráº¥t chÃ¡n khÃ´ng nÃ o? VÃ¬ váº­y trÆ°á»›c tiÃªn ta hÃ£y cháº¡y thá»­ má»™t vÃ­ dá»¥ nhá» sau trÆ°á»›c Ä‘Ã£: ÄÄƒng kÃ­ account</p><p>VÃ­ dá»¥ sau dÃ¹ng Typescript + WebdriverIO, vÃ  cÃ³ cáº¥u trÃºc tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i vÃ­ dá»¥ trÃªn trang chá»§ cá»§a Appium <a href="https://github.com/appium/appium/tree/master/sample-code/javascript-webdriverio" target="_blank" rel="noopener noreferrer">link</a> (CÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ vÃ o link trÃªn báº±ng truy cáº­p <a href="http://appium.io/" target="_blank" rel="noopener noreferrer">trang chá»§ Appium</a> rá»“i báº¥m vÃ o nÃºt Examples), táº¥t nhiÃªn Ä‘á»ƒ go pro thÃ¬ ta sáº½ ko code nhÆ° váº­y, mÃ¬nh sáº½ thá»±c hiá»‡n refactor vÃ  chuyá»ƒn Ä‘á»•i mÃ´i trÆ°á»ng cháº¡y test á»Ÿ cÃ¡c bÃ i sau ( náº¿u cÃ³ =)) ).</p><p>Sau khi setup Babel cÃ¹ng vá»›i Jest (do Jest luÃ´n Ä‘i kÃ¨m vá»›i React Native nÃªn mÃ¬nh dÃ¹ng luÃ´n Ä‘á»ƒ demo cho thÃ¢n thiá»‡n), hÃ£y viáº¿t 1 Ä‘oáº¡n test Ä‘Æ¡n giáº£n cho quÃ¡ trÃ¬nh sign up cá»§a ta.
Hiá»‡n táº¡i mÃ¬nh chá»‰ fill nhá»¯ng field text input, vÃ¬ field select, date picker viáº¿t khÃ¡ dÃ i, nÃªn mÃ¬nh sáº½ Ä‘á» cáº­p sau.</p><blockquote><p>NÃ³i nhiá»u quÃ¡, code Ä‘Ã¢u?</p></blockquote><p>VÃ¢ng, code Ä‘Ã¢y (á»Ÿ dÆ°á»›i cÃ³ giáº£i thÃ­ch code)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">BrowserObject</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> remote</span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">RemoteOptions</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;webdriverio&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> iOS</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">RemoteOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/wd/hub&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  host</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  port</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4723</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  capabilities</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    platformName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;iOS&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    automationName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;XCUITest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;iPhone (2)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    platformVersion</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;14.1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    app</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;org.reactjs.native.example.LearnRnE2eTest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    udid</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">IOS_DEVICE_UUID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodeOrgId</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;xxx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    xcodeSigningId</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Apple Development&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> android</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">RemoteOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/wd/hub&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  host</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  port</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4723</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  capabilities</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    automationName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;UiAutomator2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    platformName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;android&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    platformVersion</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;8.0.0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceName</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;BH9057609A&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    appPackage</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;com.learnrne2etest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    appActivity</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.MainActivity&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> client</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">BrowserObject</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">beforeEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  client </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">remote</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">iOS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">afterEach</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">deleteSession</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">scrollTo</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">a11yId</span><span class="token parameter operator" style="color:rgb(137, 221, 255)">:</span><span class="token parameter"> string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">options</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">capabilities</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">platformName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;android&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">execute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mobile: scroll&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      strategy</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accessibility id&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      selector</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> a11yId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">it</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sign up the user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> toRegistrationScreenButton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~login/toRegistrationScreenButton&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> toRegistrationScreenButton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">click</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> registerButton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/registerButton&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">scrollTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registration/toLoginScreenButton&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> registerButton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">click</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">scrollTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registration/usernameInput-error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> usernameError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/usernameInput-error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> usernameError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Please enter username&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> passwordError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/passwordInput-error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Please enter password&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> passwordConfirmationError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/passwordConfirmationInput-error&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordConfirmationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Please confirm your password&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> fullNameError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/fullNameInput-error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> fullNameError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Please enter your full name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> usernameInput </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/usernameInput&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> usernameInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user..01&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  usernameError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/usernameInput-error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> usernameError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Username must be alphabet and numbers&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> usernameInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> passwordInput </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/passwordInput&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> passwordConfirmationInput </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/passwordConfirmationInput&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordConfirmationInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  passwordConfirmationError </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/passwordConfirmationInput-error&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">expect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordConfirmationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toMatch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Password confirmation must match your password&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> passwordConfirmationInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> fullNameInput </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registration/fullNameInput&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> fullNameInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Test&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">hideKeyboard</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">scrollTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;registration/toLoginScreenButton&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> registerButton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">click</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">await</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">waitUntil</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      client</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;~registrationCompleted/toLoginScreenButton&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">isDisplayed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> timeout</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Chi tiáº¿t source code cÃ³ thá»ƒ xem táº¡i <a href="https://github.com/moonlight8978/learn-rn-e2e-test/tree/jest/e2e" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a></p><p>Source code cá»§a cÃ¡c mÃ n hÃ¬nh cÃ³ thá»ƒ xem táº¡i Ä‘Ã¢y:</p><ul><li>Login screen <a href="https://github.com/moonlight8978/learn-rn-e2e-test/blob/jest/rn-app/src/screens/login/login.tsx" target="_blank" rel="noopener noreferrer">link</a></li><li>Registration screen <a href="https://github.com/moonlight8978/learn-rn-e2e-test/blob/jest/rn-app/src/screens/registration/registration.tsx" target="_blank" rel="noopener noreferrer">link</a></li></ul><p>VÃ  Ä‘Ã¢y lÃ  thÃ nh pháº©m:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ yarn test</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PASS</span><span class="token plain">  __tests__</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">sign</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">up</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">ts</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">18.817</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  âœ“ sign up the </span><span class="token function" style="color:rgb(130, 170, 255)">user</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">17179</span><span class="token plain"> ms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Test</span><span class="token plain"> </span><span class="token maybe-class-name">Suites</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> passed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> total</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Tests</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain">       </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> passed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> total</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Snapshots</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> total</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Time</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain">        </span><span class="token number" style="color:rgb(247, 140, 108)">18.869</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> estimated </span><span class="token number" style="color:rgb(247, 140, 108)">29</span><span class="token plain"> s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token maybe-class-name">Ran</span><span class="token plain"> all test suites</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token property-access">âœ¨</span><span class="token plain">  </span><span class="token maybe-class-name">Done</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">21.80</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><table><thead><tr><th align="center">iOS</th><th align="center">Android</th></tr></thead><tbody><tr><td align="center"><img src="https://images.viblo.asia/30a3e57a-44ab-4c56-b4cf-0047bb221353.gif"></td><td align="center"><img src="https://images.viblo.asia/907005db-f46a-40ea-9b3c-f269fe06646d.gif"></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="vÃ­-dá»¥-trÃªn-lÃ m-gÃ¬"></a>VÃ­ dá»¥ trÃªn lÃ m gÃ¬?<a class="hash-link" href="#vÃ­-dá»¥-trÃªn-lÃ m-gÃ¬" title="Direct link to heading">#</a></h3><ol><li><p>Tá»« mÃ n <strong>Login</strong>, báº¥m vÃ o button ã€ŒCreate an accountã€ <code>login/toRegistrationScreenButton</code> Ä‘á»ƒ vÃ o mÃ n <strong>Registration</strong></p></li><li><p>Táº¡i mÃ n <strong>Registration</strong></p><p>1.1.Báº¥m vÃ o nÃºt ã€ŒRegisterã€<code>registration/registerButton</code>, do mÃ¡y Android cá»§a mÃ¬nh mÃ n hÆ¡i ngáº¯n, nÃªn trÆ°á»›c khi click pháº£i scroll tá»›i element Ä‘Ã³ trÆ°á»›c.</p><p>1.2. Do chÆ°a fill gÃ¬ nÃªn expect error message hiá»ƒn thá»‹ tÆ°Æ¡ng á»©ng</p><p>1.3. Fill ã€Œuser..01ã€vÃ o input username, do field nÃ y chá»‰ nháº­n alphabet vÃ  sá»‘, nÃªn giÃ¡ trá»‹ Ä‘Ã³ ko há»£p lá»‡, expect hiá»ƒn thá»‹ error message</p><p>1.4. Fill username 1 giÃ¡ trá»‹ há»£p lá»‡ ã€Œuserã€</p><p>1.5. Fill password ã€Œpasswordã€</p><p>1.6. Fill password confirmationã€Œpassword123ã€, do ko match password Ä‘Ã£ nháº­p nÃªn sáº½ hiá»ƒn thá»‹ error</p><p>1.7. Fill password confirmation há»£p lá»‡ ã€Œpasswordã€</p><p>1.8. Fill full name</p><p>1.9. Báº¥m vÃ o nÃºt ã€ŒRegisterã€</p></li><li><p>User Ä‘Æ°á»£c chuyá»ƒn qua mÃ n RegistrationCompleted, nÃªn ta expect button á»Ÿ mÃ n nÃ y Ä‘Æ°á»£c hiá»ƒn thá»‹.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="phÃ¢n-tÃ­ch-má»™t-vÃ i-note-vá»-cÃº-phÃ¡p"></a>PhÃ¢n tÃ­ch má»™t vÃ i note vá» cÃº phÃ¡p<a class="hash-link" href="#phÃ¢n-tÃ­ch-má»™t-vÃ i-note-vá»-cÃº-phÃ¡p" title="Direct link to heading">#</a></h3><p>CÃº phÃ¡p cá»§a WebdriverIO nhÃ¬n khÃ¡ trong sÃ¡ng vÃ  dá»… hiá»ƒu, nÃªn mÃ¬nh sáº½ khÃ´ng giáº£i thÃ­ch nhiá»u, tuy nhiÃªn cÃ³ má»™t vÃ i chÃº Ã½ dÆ°á»›i Ä‘Ã¢y cho cÃ¡c báº¡n.</p><ul><li><p>Khi tÃ¬m element, mÃ¬nh Ä‘Ã£ dÃ¹ng <code>~</code>, Ä‘Ã¢y lÃ  shorthand Ä‘á»ƒ tÃ¬m element theo <code>accessibility id</code> cá»§a WebdriverIO, tuá»³ theo OS mÃ  ta sáº½ pháº£i gÃ¡n prop khÃ¡c nhau Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng Ä‘Æ°á»£c strategy tÃ¬m theo <code>accessibility id</code> nÃ y <a href="https://github.com/webdriverio/native-demo-app/blob/master/js/config/TestProperties.js" target="_blank" rel="noopener noreferrer">link</a>, chá»‰ vÃ¬ cÃ¡i nÃ y mÃ  mÃ¬nh máº¥t vÃ i tiáº¿ng, ko hiá»ƒu táº¡i sao ko tÃ¬m tháº¥y element =))</p><ul><li>á» bÃªn iOS ta pháº£i dÃ¹ng <code>testID</code>, vÃ  trÃ¡nh gÃ¡n <code>accessibilityLabel</code> vÃ  <code>accessibilityHint</code> cho component.</li><li>á» bÃªn Android, hÃ£y dÃ¹ng <code>accessibilityLabel</code></li></ul><ul><li>CÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o cÃ¡c strategy khÃ¡c á»Ÿ docs cá»§a webdriverio <a href="https://webdriver.io/docs/selectors.html" target="_blank" rel="noopener noreferrer">link</a></li></ul></li><li><p>Táº¡i sao láº¡i dÃ¹ng <code>accessibility id</code> mÃ  khÃ´ng dÃ¹ng content cá»§a nÃ³?</p><ul><li>ÄÃºng ra lÃ  khi báº¥m button hay thao tÃ¡c trÃªn mÃ n hÃ¬nh, chÃºng ta nÃªn dÃ¹ng text cá»§a nÃ³, Ä‘á»ƒ khi text (requirement) thay Ä‘á»•i thÃ¬ test cÅ©ng oáº³ng. NhÆ°ng mÃ  cÆ¡ báº£n lÃ  do <del>hÆ¡i báº­n</del> lÆ°á»i =)) vÃ  trÆ°á»ng há»£p accessibility id Ä‘Ãºng nhÆ°ng text sai thÃ¬ pháº£i cháº¥p nháº­n thÃ´i Ã  =))</li></ul></li></ul><ul><li><p>Do API cá»§a WebdriverIO toÃ n tráº£ vá» Promise, nÃªn háº§u nhÆ° cÃ¢u lá»‡nh nÃ o cÅ©ng cáº§n pháº£i dÃ¹ng <code>async/await</code>, cÃ¡c báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng kÃ¨m package <a href="https://www.npmjs.com/package/@wdio/sync" target="_blank" rel="noopener noreferrer"><code>@wdio/sync</code></a> Ä‘á»ƒ API cá»§a WebdriverIO trá»Ÿ nÃªn Ä‘á»“ng bá»™.</p></li><li><p>CÃ¡c báº¡n cÃ³ Ä‘á»ƒ Ã½ Ä‘oáº¡n code á»Ÿ <code>beforeEach</code> vÃ  <code>afterEach</code> khÃ´ng? Má»—i test, chÃºng ta Ä‘ang táº¡o ra má»™t session má»›i, vÃ  xoÃ¡ session Ä‘Ã³ sau má»—i test. Náº¿u dÃ¹ng CLI cá»§a wdio thÃ¬ sáº½ thuáº­n tiá»‡n hÆ¡n.</p></li><li><p>Options <code>xcodeOrgId</code> vÃ  <code>xcodeSigningId</code> bÃªn trong <code>capabilities</code> cá»§a <code>RemoteOptions</code> iOS</p><ul><li><p>Äá»ƒ cháº¡y test trÃªn thiáº¿t bá»‹ iOS, Appium sáº½ cÃ i má»™t pháº§n má»m tÃªn lÃ  <code>WebDriverAgent</code> lÃªn thiáº¿t bá»‹, vÃ  Ä‘á»ƒ cÃ i Ä‘áº·t Ä‘Æ°á»£c, ta pháº£i cung cáº¥p developer team vÃ  signing certificate.</p><p>CÃ¡c báº¡n cÃ³ thá»ƒ xem thÃªm táº¡i Ä‘Ã¢y <a href="http://appium.io/docs/en/drivers/ios-xcuitest-real-devices/" target="_blank" rel="noopener noreferrer">link</a></p><p><img src="https://images.viblo.asia/8915c299-098f-4f94-a9a4-cbdf450e371b.jpg"></p></li></ul></li><li><p>Äá»‘i vá»›i thiáº¿t bá»‹ tháº­t thÃ¬ ta cáº§n thÃªm UUID, cÃ³ thá»ƒ xem cÃ¡ch tÃ¬m UUID táº¡i <a href="https://www.idownloadblog.com/2018/11/20/how-to-find-udid-iphone-xs-max-xr/" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a></p></li><li><p><code>capabilities</code> cá»§a Android</p><ul><li><p>Äá»ƒ láº¥y <code>deviceName</code>, hÃ£y cháº¡y <code>adb devices</code></p></li><li><p><code>com.learnrne2etest</code> vÃ  <code>.MainActivity</code> cÃ³ thá»ƒ láº¥y tá»« <code>android/app/src/main/AndroidManifest.xml</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly xml"><div tabindex="0" class="prism-code language-xml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">manifest</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">package</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">com.learnrne2etest</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">&lt;!-- ... --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">activity</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name namespace" style="color:rgb(178, 204, 214)">android:</span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">.MainActivity</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">&lt;!-- ... --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">activity</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">manifest</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Hoáº·c tham kháº£o bÃ i sau <a href="http://www.automationtestinghub.com/apppackage-and-appactivity-name/" target="_blank" rel="noopener noreferrer">link</a></p></li></ul></li></ul><p>CÆ°á»¡i ngá»±a xem hoa nhÆ° váº­y Ä‘á»§ rá»“i, chÃºng ta hÃ£y cÃ¹ng tÃ¬m hiá»ƒu thÃªm vá» cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Appium</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-kiáº¿n-trÃºc-flow-cá»§a-appium"></a>3. Kiáº¿n trÃºc, flow cá»§a Appium<a class="hash-link" href="#3-kiáº¿n-trÃºc-flow-cá»§a-appium" title="Direct link to heading">#</a></h1><p><img src="https://images.viblo.asia/d5fa4bea-70c4-4bfa-9d89-03aac8d9a92c.jpg"></p><p>Appium dá»±a trÃªn kiáº¿n trÃºc client-server, báº£n thÃ¢n Appium lÃ  1 server, cÃ³ thá»ƒ dá»… dÃ ng nháº­n tháº¥y Ä‘iá»u nÃ y á»Ÿ Ä‘oáº¡n config.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><div tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> iOS</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token maybe-class-name">RemoteOptions</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  path</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/wd/hub&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  host</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  port</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4723</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ...</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="31-test-library--webdriver-client"></a>3.1. Test library + WebDriver client<a class="hash-link" href="#31-test-library--webdriver-client" title="Direct link to heading">#</a></h4><p>Khi viáº¿t test, ta sáº½ dÃ nh pháº§n lá»›n thá»i gian Ä‘á»ƒ lÃ m viá»‡c vá»›i chÃºng, nhÆ° vÃ­ dá»¥ á»Ÿ pháº§n 2, ta Ä‘Ã£ sá»­ dá»¥ng Jest (vá»›i cÃ¡c cÃ¢u lá»‡nh <code>it</code>, <code>describe</code>, <code>afterEach</code>, <code>afterAll</code>) lÃ  cÃ´ng cá»¥ Ä‘á»ƒ cháº¡y test, vÃ  WebdriverIO (vá»›i <code>$</code>, <code>click()</code>, <code>setValue(value)</code>) Ä‘á»ƒ giao tiáº¿p vá»›i Appium server.</p><p>NgoÃ i bá»™ Ä‘Ã´i nÃ y, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng báº¥t cá»© ngÃ´n ngá»¯ nÃ o mÃ  ta thÃ­ch (miá»…n lÃ  Appium nÃ³ support :v), tá»« Ruby, Python cho Ä‘áº¿n PHP, C#, cÃ³ thá»ƒ xem list táº¡i <a href="http://appium.io/docs/en/about-appium/appium-clients/index.html" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a></p><p>NhÆ°ng mÃ  mÃ¬nh recommend combo sau:</p><ul><li><p>NgÃ´n ngá»¯: JS/TS thÃ¢n thiá»‡n vá»›i React Native dev</p></li><li><p>WebDriver client: <a href="https://webdriver.io/" target="_blank" rel="noopener noreferrer">WebdriverIO</a> vÃ¬ trong Ä‘Ã¡m client, tháº±ng nÃ y nhiá»u star trÃªn github nháº¥t =))</p></li></ul><ul><li>Test library: <a href="https://jasmine.github.io/index.html" target="_blank" rel="noopener noreferrer">jasmine</a><ul><li>VÃ¬ nÃ³ cÃ³ cÃº phÃ¡p giá»‘ng Jest, mÃ  anh em code React Native thÃ¬ quÃ¡ quen thuá»™c vá»›i Jest rá»“i</li><li>LÃ  1 trong 3 test framework Ä‘Æ°á»£c WebdriverIO support sáºµn Ä‘á»ƒ go pro =)) (ngoÃ i ra cÃ²n cÃ³ mocha vÃ  cucumber), dÃ¹ng Jest náº¿u lá»—i thÃ¬ pháº£i tá»± mÃ y mÃ² thÃ´i :v</li></ul></li></ul><p>NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn, Appium Ã¡p dá»¥ng kiáº¿n trÃºc client-server. Khi ta viáº¿t nhá»¯ng cÃ¢u lá»‡nh sau</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ts"><div tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ./__tests__/sign-up.spec.ts</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> passwordConfirmationInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>náº¿u Ä‘á»ƒ Ã½ log ta cÃ³ thá»ƒ tháº¥y nhá»¯ng dÃ²ng log dÆ°á»›i Ä‘Ã¢y, webdriverio chá»‰ Ä‘Æ¡n thuáº§n gá»­i 1 HTTP request tá»›i server, server lÃ m gÃ¬ thÃ¬ chÃºng ta sáº½ tÃ¬m hiá»ƒu sau :v</p><ul><li>iOS</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">HTTP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">wd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">hub</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">b891507e</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">d84</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4e62</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">a5b2</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">e9110c529c9e</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">HTTP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;text&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">W3C</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b891507e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Calling</span><span class="token plain"> </span><span class="token maybe-class-name">AppiumDriver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> args</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;6F000000-0000-0000-E00E-000000000000&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;b891507e-4d84-4e62-a5b2-e9110c529c9e&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token maybe-class-name">XCUITest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Executing</span><span class="token plain"> command </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;setValue&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">WD</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Matched</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;/element/6F000000-0000-0000-E00E-000000000000/value&#x27;</span><span class="token plain"> to command name </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;setValue&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token maybe-class-name">Protocol</span><span class="token plain"> </span><span class="token maybe-class-name">Converter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Added</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;text&#x27;</span><span class="token plain"> property </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token plain"> to </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;setValue&#x27;</span><span class="token plain"> request body</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">WD</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Proxying</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> to </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> http</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token number" style="color:rgb(247, 140, 108)">.1</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">8100</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">01</span><span class="token maybe-class-name">BFCDD1</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">27</span><span class="token maybe-class-name">D7</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4904</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">A95A</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">C75086994546</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> body</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;p&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;s&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;s&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;w&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;o&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;r&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;d&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;text&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;password123&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">WD</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Got</span><span class="token plain"> response </span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> status </span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sessionId&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;01BFCDD1-27D7-4904-A95A-C75086994546&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">W3C</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b891507e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Responding</span><span class="token plain"> to client </span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> driver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> result</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">HTTP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">wd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">hub</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">b891507e</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">d84</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4e62</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">a5b2</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">e9110c529c9e</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value </span><span class="token number" style="color:rgb(247, 140, 108)">200</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">821</span><span class="token plain"> ms </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">14</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>Android</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">info</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.288</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">COMMAND</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">findElement</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accessibility id&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;login/toRegistrationScreenButton&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    at node_modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">@wdio</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">logger</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">build</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">js</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">76</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">info</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.289</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> http</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">localhost</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">4723</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">wd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">hub</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain">fc4b801</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">deae</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">49</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">947</span><span class="token plain">d</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">292</span><span class="token plain">d67ba5467</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    at node_modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">@wdio</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">logger</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">build</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">js</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">76</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">info</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.289</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">DATA</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    using</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;accessibility id&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    value</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;login/toRegistrationScreenButton&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    at node_modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">@wdio</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">logger</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">build</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">js</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">76</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">info</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.414</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">RESULT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;element-6066-11e4-a52e-4f735466cecf&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bb82f194-16d1-4ba0-a520-33f47e117211&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">ELEMENT</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bb82f194-16d1-4ba0-a520-33f47e117211&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    at node_modules</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">@wdio</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">logger</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">build</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">node</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">js</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">76</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">9</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="32-appium-server-automation-tool-devices"></a>3.2. Appium server, Automation tool, Devices<a class="hash-link" href="#32-appium-server-automation-tool-devices" title="Direct link to heading">#</a></h4><p>ÄÃ¢y lÃ  pháº§n xÆ°Æ¡ng sá»‘ng trong kiáº¿n trÃºc cá»§a Appium, nÃ³ Ä‘áº£m nháº­n viá»‡c handle request tá»« client, giao tiáº¿p vá»›i native automation tool Ä‘á»ƒ thá»±c thi nhá»¯ng command mÃ  ta cáº§n.</p><p>Appium server expose ra API theo chuáº©n JSON Wire Protocol (WebDriver Protocol). Tuá»³ vÃ o target lÃ  iOS hay Android, nÃ³ sáº½ cÃ³ cÃ¡ch hoáº¡t Ä‘á»™ng riÃªng Ä‘á»ƒ phÃ¹ há»£p vá»›i ná»n táº£ng Ä‘Ã³.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="321-appium-meets-ios"></a>3.2.1. Appium meets iOS<a class="hash-link" href="#321-appium-meets-ios" title="Direct link to heading">#</a></h5><p>Quay trá»Ÿ láº¡i Ä‘oáº¡n log á»Ÿ pháº§n 3.1, nÃ³ Ä‘Ã£ Ã­t nhiá»u gá»£i Ã½ cho ta cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Appium</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">HTTP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">--</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">wd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">hub</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">b891507e</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">d84</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4e62</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">a5b2</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">e9110c529c9e</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">WD</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token maybe-class-name">Proxying</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> to </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token plain"> http</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token number" style="color:rgb(247, 140, 108)">.0</span><span class="token number" style="color:rgb(247, 140, 108)">.1</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">8100</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">01</span><span class="token maybe-class-name">BFCDD1</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">27</span><span class="token maybe-class-name">D7</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">4904</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">A95A</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">C75086994546</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token maybe-class-name">F000000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">0000</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token constant" style="color:rgb(130, 170, 255)">E00E</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">000000000000</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ³ thá»ƒ dá»… tháº¥y Appium server Ä‘Æ¡n giáº£n chá»‰ proxy request cá»§a ta tá»›i 1 server khÃ¡c cháº¡y á»Ÿ port 8100 <code>http://127.0.0.1:8100</code>.</p><blockquote><p>OÃ¡t dá» phÆ°á»›c? Tháº±ng nÃ o Ä‘ang cháº¡y á»Ÿ port 8100 váº­y?</p></blockquote><p>ÄÃ³ lÃ  <a href="https://github.com/facebookarchive/WebDriverAgent" target="_blank" rel="noopener noreferrer">WebDriverAgent server</a>, ban Ä‘áº§u Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Ã´ng lá»›n <strong>Facebook</strong>, appium Ä‘Ã£ fork vá» thÃªm máº¯m thÃªm muá»‘i gÃ¬ Ä‘Ã³ vÃ o.</p><p>WDA giÃºp giao tiáº¿p vá»›i XCUITest Ä‘á»ƒ cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn device/simulator iOS tá»« xa. Báº£n thÃ¢n nÃ³ cÅ©ng Ä‘Ã£ support sáºµn Webdriver Protocol, váº­y nÃªn cháº¯c háº³n dev Appium Ä‘Ã£ nghÄ© nhÆ° sau</p><blockquote><p>Tá»™i gÃ¬ mÃ  pháº£i code láº¡i, cÃ³ sáºµn hÃ ng ngon rá»“i thÃ¬ dÃ¹ng luÃ´n thÃ´i =))</p></blockquote><p>WDA lÃ m gÃ¬ vá»›i device thÃ¬ mÃ¬nh xin skip, vÃ¬ cÅ©ng ko biáº¿t =)) CÃ¡c báº¡n cÃ³ thá»ƒ tá»± mÃ¬nh tÃ¬m hiá»ƒu sÃ¢u hÆ¡n náº¿u cÃ³ há»©ng thÃº vá»›i nÃ³.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="322-appium-meets-android"></a>3.2.2. Appium meets Android<a class="hash-link" href="#322-appium-meets-android" title="Direct link to heading">#</a></h5><p>Vá»›i Android, ta cÃ³ Ã­t gá»£i Ã½ hÆ¡n</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.289</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token constant" style="color:rgb(130, 170, 255)">POST</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> http</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">localhost</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">4723</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">wd</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">hub</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">session</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain">fc4b801</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">deae</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">49</span><span class="token plain">dc</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">947</span><span class="token plain">d</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">292</span><span class="token plain">d67ba5467</span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain">element</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2020</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">31</span><span class="token maybe-class-name">T02</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">23.414</span><span class="token plain">Z </span><span class="token constant" style="color:rgb(130, 170, 255)">INFO</span><span class="token plain"> webdriver</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">RESULT</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;element-6066-11e4-a52e-4f735466cecf&#x27;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bb82f194-16d1-4ba0-a520-33f47e117211&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token constant" style="color:rgb(130, 170, 255)">ELEMENT</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bb82f194-16d1-4ba0-a520-33f47e117211&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>KhÃ´ng tháº¥y proxy gÃ¬ Ä‘Ã³ pháº£i khÃ´ng nÃ o? ÄÃºng váº­y, vÃ¬ nÃ³ cÃ³ proxy Ä‘Ã¢u :v</p><p>á» version má»›i nháº¥t, Appium sá»­ dá»¥ng <a href="https://github.com/appium/appium-android-driver" target="_blank" rel="noopener noreferrer">appium-android-driver</a> Ä‘á»ƒ giao tiáº¿p vá»›i UIAutomator2. Váº­y giao tiáº¿p tháº¿ nÃ o?</p><p>Má»—i khi báº¯t Ä‘áº§u cháº¡y test, Appium sáº½ cÃ i app <strong>Appium Settings</strong> trÃªn device cá»§a ta, tháº±ng nÃ y sáº½ má»Ÿ port <a href="https://github.com/appium/appium-android-driver/blob/19b949383e9e1300edd25982e33bb76689a001d2/lib/driver.js#L17" target="_blank" rel="noopener noreferrer">4724</a> trÃªn device cá»§a ta vÃ  expose ra má»™t vÃ i API há»‡ thá»‘ng. Appium server <em>abc</em> vá»›i app Ä‘Ã£ cÃ i trÃªn (qua HTTP), vÃ  nÃ³ sáº½ <em>xyz</em> vá»›i UIAutomator2 Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c command.</p><p><img src="https://images.viblo.asia/0b1ef505-609d-4412-b9d6-65508df7358d.jpg"></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-káº¿t-luáº­n"></a>4. Káº¿t luáº­n<a class="hash-link" href="#4-káº¿t-luáº­n" title="Direct link to heading">#</a></h1><p>LÃ  má»™t dev, chÃºng ta khÃ´ng Ä‘Æ°á»£c chá»§ quan, lá»‡ thuá»™c vÃ o bÃªn tester, mÃ  hÃ£y tá»± mÃ¬nh kiá»ƒm thá»­ trÆ°á»›c khi chuyá»ƒn qua cho há». Test cháº¡y cÆ¡m lÃ  má»™t cÃ´ng viá»‡c nhÃ m chÃ¡n, váº­y thÃ¬ táº¡i sao chÃºng ta khÃ´ng lÃ m cho nÃ³ thÃº vá»‹ hÆ¡n báº±ng cÃ¡ch automate nÃ³. Tuy sáº½ cÃ³ lÃºc cáº§n má»™t sá»‘ thá»§ thuáº­t, hay lÃ  pháº£i dÃ¹ng nhiá»u command khÃ¡ láº±ng nháº±ng ( nhÆ° cÃ¡i datepicker cháº³ng háº¡n =)) ), nhÆ°ng má»™t khi cháº¡y Ä‘Æ°á»£c nháº¥t Ä‘á»‹nh nÃ³ sáº½ Ä‘em láº¡i cho cÃ¡c báº¡n má»™t cáº£m giÃ¡c phÃª nhÆ° con tÃª tÃª =))</p><p>Code e2e cá»§a bÃ i viáº¿t chá»‰ lÃ  nhá»¯ng Ä‘oáº¡n code táº¡m bá»£, cÃ¡c báº¡n muá»‘n go pro cÃ³ thá»ƒ tham kháº£o <a href="https://github.com/webdriverio/appium-boilerplate" target="_blank" rel="noopener noreferrer">appium-boilerplate</a> cá»§a webdriverio vá» cÃ¡ch chia module, cÅ©ng nhÆ° setup project. Náº¿u cÃ³ thá»i gian mÃ¬nh sáº½ viáº¿t thÃªm vá» viá»‡c refactor Ä‘á»‘ng code táº¡m bá»£ trÃªn Ä‘á»ƒ go pro =)) Giá» thÃ¬ xin táº¡m biá»‡t cÃ¡c báº¡n.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/react-native">react-native</a><a class="margin-horiz--sm" href="/blog/tags/e-2-e-testing">e2e-testing</a><a class="margin-horiz--sm" href="/blog/tags/appium">appium</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/gioi-thieu-ve-kubernetes">Giá»›i thiá»‡u vá» Kubernetes</a></h2><div class="margin-vert--md"><time datetime="2019-11-21T00:00:00.000Z" class="blogPostDate_fNvV">November 21, 2019 Â· 11 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>NgÃ y nay, container Ä‘Ã£ lÃ  1 thá»© gÃ¬ Ä‘Ã³ quÃ¡ phá»• biáº¿n, nhá»¯ng ná»n táº£ng cloud cá»§a Amazon, Google, hay Microsoft, v.v... Ä‘á»u Ä‘Ã£ há»— trá»£ deploy container. VÃ  á»Ÿ local, hay nhá»¯ng server test, má»i ngÆ°á»i cÅ©ng Ä‘ang dáº§n chuáº©n sang container vÃ¬ sá»± tiá»‡n lá»£i cá»§a chÃºng.</p><p>Tuy nhiÃªn khi sá»‘ lÆ°á»£ng container lá»›n dáº§n, chÃºng ngÃ y cÃ ng trá»Ÿ nÃªn ráº¯c rá»‘i, viá»‡c control resource, network, volume cá»§a má»™t sá»‘ lÆ°á»£ng lá»›n container ngÃ y cÃ ng khÃ³. ChÃ­nh vÃ¬ lÃ½ do Ä‘Ã³, má»™t sá»‘ ná»n táº£ng quáº£n lÃ½ container Ä‘Ã£ ra Ä‘á»i nhÆ° Docker Swarm, Kubernetes, ...</p><p>Vá»›i má»™t há»‡ thá»‘ng nhá», ta cÃ³ thá»ƒ sá»­ dá»¥ng Docker Swarm, sá»­ dá»¥ng nÃ³ ráº¥t dá»… vÃ  Ä‘Æ¡n giáº£n. Kubernetes cho phÃ©p ta customize nhiá»u thá»© trong há»‡ thá»‘ng hÆ¡n, tuy nhiÃªn cÃ¡i giÃ¡ cá»§a nÃ³ lÃ  khÃ³ sá»­ dá»¥ng hÆ¡n nhiá»u Docker Swarm.</p><p>Note: Ta khÃ´ng bao giá» so sÃ¡nh Kubernetes vá»›i Docker, vÃ¬ k8s thá»© lÃ  management tool, cÃ²n docker lÃ  container runtime.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-kiáº¿n-trÃºc-háº¡-táº§ng-cá»§a-kubernetes"></a>2. Kiáº¿n trÃºc háº¡ táº§ng cá»§a Kubernetes<a class="hash-link" href="#2-kiáº¿n-trÃºc-háº¡-táº§ng-cá»§a-kubernetes" title="Direct link to heading">#</a></h1><p><img src="https://images.viblo.asia/8fd57971-e1c9-41dd-b205-0ce88a356e50.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="21-master-components"></a>2.1 Master components<a class="hash-link" href="#21-master-components" title="Direct link to heading">#</a></h3><p>Nhá»¯ng components trÃªn master node sáº½ Ä‘Ã³ng vai trÃ² lÃ  control plane cá»§a cluster. VD nhÆ°: scheduling cÃ¡c pod, ...</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="211-etcd"></a>2.1.1 etcd<a class="hash-link" href="#211-etcd" title="Direct link to heading">#</a></h5><p>ÄÃ¢y lÃ  database phÃ¢n tÃ¡n, sá»­ dá»¥ng Raft lÃ m cÆ¡ cháº¿ Ä‘á»“ng thuáº­n.</p><p>State cá»§a cluster (config, node info, IP addresses, ...) Ä‘á»u Ä‘Æ°á»£c lÆ°u trá»¯ táº¡i Ä‘Ã¢y.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="212-kube-scheduler"></a>2.1.2 kube-scheduler<a class="hash-link" href="#212-kube-scheduler" title="Direct link to heading">#</a></h5><p>CÃ³ nhiá»‡m vá»¥ schedule pod tá»›i nhá»¯ng node cÃ³ Ä‘á»§ resource, vÃ  Ä‘áº£m báº£o pod Ä‘áº¡t Ä‘Æ°á»£c expected status.</p><p>CÃ³ thá»ƒ hiá»ƒu Ä‘Æ¡n giáº£n Ä‘Ã¢y lÃ  má»™t vÃ²ng láº·p vÃ´ táº­n, Ä‘Æ°a nhá»¯ng pod má»›i Ä‘Æ°á»£c táº¡o vÃ o 1 queue, tá»«ng item trong Ä‘Ã³ sáº½ Ä‘Æ°á»£c schedule tá»›i node thá»a mÃ£n.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="213-kube-apiserver"></a>2.1.3 kube-apiserver<a class="hash-link" href="#213-kube-apiserver" title="Direct link to heading">#</a></h5><p>API Server Ä‘Æ¡n thuáº§n lÃ  1 REST API cá»§a Kubernetes cluster.</p><p>Khi muá»‘n táº¡o, cáº­p nháº­t, hay xÃ³a nhá»¯ng resource cá»§a há»‡ thá»‘ng nhÆ° pod, ingress, ... thÃ¬ Ä‘á»u cáº§n thÃ´ng qua API Server, chá»© khÃ´ng call tháº³ng tá»›i kube-scheduler, etcd, ...</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="214-kube-controller-manager"></a>2.1.4 kube-controller-manager<a class="hash-link" href="#214-kube-controller-manager" title="Direct link to heading">#</a></h5><p>Cháº¡y nhiá»u controller process. Má»—i controller cÃ³ nhiá»‡m vá»¥ khÃ¡c nhau nhÆ°:</p><ul><li>Node Controller</li><li>Replication Controller</li><li>...</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="22-node-components"></a>2.2 Node components<a class="hash-link" href="#22-node-components" title="Direct link to heading">#</a></h3><p>LÃ  nhá»¯ng component Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn táº¥t cáº£ cÃ¡c node, giÃºp quáº£n lÃ½ container trÃªn node, logging, quáº£n lÃ½ network, ...</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="221-kubelet"></a>2.2.1 kubelet<a class="hash-link" href="#221-kubelet" title="Direct link to heading">#</a></h5><p>CÃ³ nhiá»‡m vá»¥ quáº£n lÃ½ container, Ä‘áº£m báº£o container cháº¡y chÃ­nh xÃ¡c, kubelet chá»‰ quáº£n lÃ½ container do k8s táº¡o.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="222-kube-proxy"></a>2.2.2 kube-proxy<a class="hash-link" href="#222-kube-proxy" title="Direct link to heading">#</a></h5><p>LÃ  má»™t network proxy, dÃ¹ng Ä‘á»ƒ forward request tá»›i háº¡ táº§ng cá»§a k8s.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="223-container-runtime"></a>2.2.3 Container runtime<a class="hash-link" href="#223-container-runtime" title="Direct link to heading">#</a></h5><p>Cháº¯n cháº¯n ta khÃ´ng thá»ƒ thiáº¿u runtime cho container, nÃ³ cÃ³ thá»ƒ lÃ  rkt, Docker, ... hay báº¥t cá»© thá»© gÃ¬ khÃ¡c.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="23-hoáº¡t-Ä‘á»™ng"></a>2.3 Hoáº¡t Ä‘á»™ng<a class="hash-link" href="#23-hoáº¡t-Ä‘á»™ng" title="Direct link to heading">#</a></h3><p>ChÃºng ta sáº½ cÃ¹ng xem nhá»¯ng component trÃªn sáº½ káº¿t há»£p vá»›i nhau hoáº¡t Ä‘á»™ng ra sao, thÃ´ng qua viá»‡c táº¡o 1 Pod qua <code>kubectl</code> CLI.</p><p><strong>Pod</strong> á»Ÿ Ä‘Ã¢y cÃ³ thá»ƒ coi lÃ  1 mÃ¡y áº£o, hay 1 container nhÆ° Docker cho dá»… hÃ¬nh dung.</p><p><img src="https://images.viblo.asia/f19795c9-fbc9-48e1-9391-53fc439c1391.jpg"></p><ul><li>TrÆ°á»›c tiÃªn ta sá»­ dá»¥ng <code>kubectl</code> Ä‘á»ƒ yÃªu cáº§u táº¡o 1 Pod. Báº£n cháº¥t cá»§a command nÃ y lÃ  sáº½ thá»±c hiá»‡n 1 HTTP request tá»›i <strong>apiserver</strong> cá»§a cluster.</li><li><strong>apiserver</strong> sáº½ thá»±c hiá»‡n ghi láº¡i current state, vÃ  desired state cá»§a cluster láº¡i vÃ o <strong>etcd</strong> (asynchronous)</li><li><strong>etcd</strong> sáº½ notify láº¡i <strong>apiserver</strong> khi entry Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng</li><li>Tiáº¿p theo <strong>kube-scheduler</strong> sáº½ thá»±c hiá»‡n viá»‡c schedule Pod. Khi tÃ¬m tháº¥y node thÃ­ch há»£p, nÃ³ sáº½ bÃ¡o cho <strong>apiserver</strong> lÃ  Pod Ä‘Ã³ Ä‘Ã£ Ä‘Æ°á»£c bind vÃ o node nÃ o. <strong>apiserver</strong> sáº½ láº¡i update vÃ o <strong>etcd</strong></li><li><strong>kubelet</strong> táº¡i node Ä‘Ã³ sáº½ thá»±c hiá»‡n viá»‡c theo dÃµi container táº¡o bá»Ÿi <strong>container runtime</strong> (Docker), xem chÃºng cÃ³ cháº¡y Ä‘Ãºng vá»›i PodSpec khÃ´ng. <strong>kubelet</strong> sáº½ gá»i tá»›i <strong>apiserver</strong> Ä‘á»ƒ update state cá»§a Pod Ä‘Ã³ thÆ°á»ng xuyÃªn.</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-kiáº¿n-trÃºc-cá»§a-á»©ng-dá»¥ng-trÃªn-kubernetes"></a>3. Kiáº¿n trÃºc cá»§a á»©ng dá»¥ng trÃªn Kubernetes<a class="hash-link" href="#3-kiáº¿n-trÃºc-cá»§a-á»©ng-dá»¥ng-trÃªn-kubernetes" title="Direct link to heading">#</a></h1><p>Ta sáº½ chá»‰ táº­p trung vÃ o 3 yáº¿u tá»‘ chÃ­nh Ä‘á»ƒ má»™t há»‡ thá»‘ng cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c:</p><ul><li>á»¨ng dá»¥ng</li><li>Network</li><li>Storage</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="31-pod"></a>3.1 Pod<a class="hash-link" href="#31-pod" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pod-lÃ -gÃ¬"></a>Pod lÃ  gÃ¬<a class="hash-link" href="#pod-lÃ -gÃ¬" title="Direct link to heading">#</a></h5><p><strong>Pod</strong> lÃ  Ä‘Æ¡n vá»‹ nhá» nháº¥t trong cluster. Má»—i Pod cÃ³ IP riÃªng, vÃ  cÃ³ thá»ƒ chá»©a nhiá»u container, nhá»¯ng container trong cÃ¹ng 1 Pod cÃ³ thá»ƒ giao tiáº¿p vá»›i nhau qua localhost. VÃ¬ váº­y, cÃ³ thá»ƒ coi Pod lÃ  má»™t mÃ¡y áº£o cho dá»… hÃ¬nh dung.</p><p>Tuy nhiÃªn Ä‘á»ƒ Ä‘Æ¡n giáº£n, ngÆ°á»i ta thÆ°á»ng chá»‰ cháº¡y 1 container trÃªn má»—i Pod, khi Ä‘Ã³ ta sáº½ lÃ m viá»‡c vá»›i Pod thay vÃ¬ vá»›i tá»«ng container riÃªng láº».</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="init-container"></a>Init container<a class="hash-link" href="#init-container" title="Direct link to heading">#</a></h5><p>Pod cÃ³ há»— trá»£ init container (1 hoáº·c nhiá»u Ä‘á»u Ä‘Æ°á»£c). TrÆ°á»›c khi app container (container chÃ­nh - vÃ­ dá»¥ container vá»›i command <code>rails s</code>) cháº¡y, táº¥t cáº£ init container sáº½ Ä‘Æ°á»£c cháº¡y láº§n lÆ°á»£t, cÃ¡i trÆ°á»›c thÃ nh cÃ´ng rá»“i Ä‘áº¿n cÃ¡i sau cháº¡y.</p><p>VÃ­ dá»¥ nhÆ° 1 á»©ng dá»¥ng Rails, ta cÃ³ thá»ƒ settings <code>rails s</code> lÃ m app container, cÃ²n <code>rails db:create db:migrate</code> sáº½ lÃ m init container.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="controller"></a>Controller<a class="hash-link" href="#controller" title="Direct link to heading">#</a></h5><p>Controller lÃ  1 concept trong Kubernetes, nÃ³ dÃ¹ng Ä‘á»ƒ theo dÃµi 1 loáº¡i Resource nÃ o Ä‘Ã³. <strong>kube-controller-manager</strong> cÃ³ nhiá»‡m vá»¥ quáº£n lÃ½ nhá»¯ng controller nÃ y.</p><p>Vá» máº·t ká»¹ thuáº­t thÃ¬ Ä‘Ã¢y Ä‘Æ¡n thuáº§n lÃ  1 vÃ²ng láº·p vÃ´ háº¡n (<em>control loop</em>) Ä‘á»ƒ cÃ³ thá»ƒ Ä‘iá»u chá»‰nh state cá»§a cluster sao cho nÃ³ Ä‘áº¡t tá»›i Ä‘Æ°á»£c desired state.</p><p>Tuy nhiÃªn Ä‘ang trong má»¥c Pod nÃªn ta sáº½ chá»‰ Ä‘á» cáº­p tá»›i controller theo dÃµi Pod trong pháº§n nÃ y.</p><ul><li><p><code>Deployment</code>:</p><p>Ta sáº½ sá»­ dá»¥ng <code>Deployment</code> khi cáº§n deploy 1 hoáº·c nhiá»u replica (thÆ°á»ng lÃ  stateless).</p><p>Thá»© tá»± khá»Ÿi Ä‘á»™ng, identify cá»§a nhá»¯ng replica (Pod) lÃ  hoÃ n toÃ n ngáº«u nhiÃªn.</p></li><li><p><code>StatefulSet</code>:</p><p>Náº¿u app cá»§a chÃºng ta lÃ  stateful (vÃ­ dá»¥ nhÆ° 1 set MySQL vá»›i 1 master vÃ  2 slave), khi Ä‘Ã³ viá»‡c cÃ³ 1 stable identity lÃ  ráº¥t quan trá»ng. NgoÃ i ra vá»›i má»—i replica trong <code>StatefulSet</code>, Kubernetes sáº½ cung cáº¥p cho nÃ³ má»™t storage riÃªng.</p><p><code>StatefulSet</code> thÃªm prefix <code>0</code>, <code>1</code>, <code>2</code>, ... lÃ  thá»© tá»± khá»Ÿi Ä‘á»™ng cá»§a pod vÃ o tÃªn pod.</p><p>Khi Ä‘Ã³ network identity, cÅ©ng nhÆ° storage cá»§a Pod sáº½ trá»Ÿ nÃªn stable. Náº¿u mysql-0 cá»§a ta lÃ  master, nÃ³ sáº½ luÃ´n lÃ  master, vÃ  nÃ³ cÅ©ng luÃ´n request tá»›i storage cá»§a master.</p></li><li><p><code>DaemonSet</code>:</p><p>Ta dÃ¹ng <code>DaemonSet</code> trong trÆ°á»ng há»£p muá»‘n táº¥t cáº£ cÃ¡c node Ä‘á»u pháº£i cháº¡y 1 Pod nÃ o Ä‘Ã³.</p><p>VÃ­ dá»¥ nhÆ° storage cluster nhÆ° <strong>glusterd</strong>, hay log agent nhÆ° <strong>fluentd</strong>, ...</p></li><li><p><code>Job</code>:</p><p>Khi ta cáº§n cháº¡y one-off Pod. VÃ­ dá»¥ nhÆ° viá»‡c import master data.</p></li><li><p><code>CronJob</code>:</p><p>NhÆ° tÃªn gá»i cá»§a nÃ³, cá»© Ä‘á»‹nh kÃ¬ nÃ³ sáº½ táº¡o Pod Ä‘á»ƒ thá»±c hiá»‡n job.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="32-networking"></a>3.2 Networking<a class="hash-link" href="#32-networking" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="321-service"></a>3.2.1 Service<a class="hash-link" href="#321-service" title="Direct link to heading">#</a></h4><p>TrÃªn mÃ´i trÆ°á»ng production, ráº¥t hiáº¿m khi ta tháº¥y 1 service chá»‰ cháº¡y trÃªn 1 server. Thay vÃ¬ tháº¿, thÆ°á»ng sáº½ cÃ³ 2 hoáº·c nhiá»u hÆ¡n server cÃ¹ng cháº¡y, khi server nÃ y cháº¿t, ta cÃ³ thá»ƒ forward request tá»›i nhá»¯ng server heo-thÃ¬ (healthy) cÃ²n láº¡i (trong trÆ°á»ng há»£p cÃ³ set load balancer vÃ  healthcheck), khÃ´ng lÃ m cho service cá»§a ta ngá»m luÃ´n.</p><p>Tuy nhiÃªn IP cá»§a Pod trong cluster luÃ´n thay Ä‘á»•i, váº­y thÃ¬ ta biáº¿t pháº£i setup cho load balancer nhÆ° tháº¿ nÃ o? VÃ  Ä‘Ã¢y chÃ­nh lÃ  Ä‘áº¥t diá»…n cá»§a <code>Service</code>.</p><p><code>Service</code> lÃ  má»™t táº­p há»£p cÃ¡c Pod, thÆ°á»ng sáº½ dÃ¹ng <code>label</code> Ä‘á»ƒ group cÃ¡c Pod.</p><p>ThÃ´ng thÆ°á»ng, má»—i <code>Service</code> sáº½ Ä‘Æ°á»£c gÃ¡n cho 1 cluster IP, Kubernetes sáº½ cung cáº¥p DNS name, vÃ  Ä‘á»“ng thá»i cÅ©ng load-balance cho cÃ¡c Pod cá»§a <code>Service</code>.</p><p><img src="https://images.viblo.asia/2a7f4968-7280-47eb-a225-60ab2f06ab6e.png"></p><p>Ta cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng <code>Service</code> cho external endpoint.</p><p>VÃ­ dá»¥ khi há»‡ thá»‘ng cáº§n call Ä‘áº¿n <em><a href="https://google.com.vn" target="_blank" rel="noopener noreferrer">https://google.com.vn</a></em>. Tuy nhiÃªn ta láº¡i khÃ´ng muá»‘n call trá»±c tiáº¿p, hay hardcode trong code, mÃ  muá»‘n endpoint nÃ y cÅ©ng trá»Ÿ thÃ nh 1 pháº§n cá»§a cluster, Ä‘á»ƒ dá»… quáº£n lÃ½. Khi Ä‘Ã³ ta cÃ³ thá»ƒ thay Ä‘á»•i endpoint nÃ y mÃ  khÃ´ng pháº£i Ä‘á»¥ng Ä‘áº¿n code, hay biáº¿n ENV gÃ¬ Ä‘Ã³. Khi Ä‘Ã³, ta sáº½ define 1 <code>Service</code>, vÃ  set <code>Endpoint</code> thá»§ cÃ´ng cho service nÃ y, thay vÃ¬ sá»­ dá»¥ng <code>label</code>.</p><p>NgoÃ i ra cÃ²n cÃ³ <code>Headless Service</code>, loáº¡i service nÃ y sáº½ khÃ´ng Ä‘Æ°á»£c gÃ¡n cluster IP. Ta sáº½ sá»­ dá»¥ng khi ta muá»‘n sá»­ dá»¥ng cÃ¡ch load balance riÃªng, khÃ´ng phá»¥ thuá»™c Kubernetes.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="322-load-balancer"></a>3.2.2 Load balancer<a class="hash-link" href="#322-load-balancer" title="Direct link to heading">#</a></h4><p>Khi táº¡o Service, náº¿u Ä‘Ã¢y lÃ  service cho phÃ©p traffic tá»« bÃªn ngoÃ i Internet, ta hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng Load Balancer cá»§a cÃ¡c nhÃ  cung cáº¥p dá»‹ch vá»¥ cloud (thÆ°á»ng lÃ  L3 Load Balancer).</p><p>Khi call tá»›i Load Balancer nÃ³i trÃªn, nÃ³ sáº½ trá»±c tiáº¿p forward traffic tá»›i service trong cluster, thuáº­t toÃ¡n load-balance sáº½ do Load Balancer nÃ y quyáº¿t Ä‘á»‹nh.</p><p><img src="https://images.viblo.asia/fdf97441-6cc1-4b42-ac48-342541d0421e.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="323-ingress"></a>3.2.3 Ingress<a class="hash-link" href="#323-ingress" title="Direct link to heading">#</a></h4><p><code>Ingress</code> hoáº¡t Ä‘á»™ng giá»‘ng 1 Reverse Proxy hay Layer 7 Load Balancer. NÃ³ cÅ©ng cÃ³ nÃ©t tÆ°Æ¡ng Ä‘á»“ng vá»›i API Gateway.</p><p><code>Ingress</code> cÃ³ thá»ƒ Ä‘iá»u hÆ°á»›ng cáº£ internal traffic láº«n external traffic dá»±a vÃ o URL, Ä‘á»“ng thá»i cung cáº¥p thÃªm cáº£ load balancing giá»¯a nhá»¯ng pod cá»§a service. Má»™t Ä‘iá»ƒm Ä‘Ã¡ng lÆ°u Ã½ lÃ  <code>Ingress</code> sáº½ load balance trá»±c tiáº¿p cÃ¡c backend Pod mÃ  khÃ´ng thÃ´ng qua service, do Ä‘Ã³, ta cÃ³ thá»ƒ tÃ¹y chá»‰nh Ä‘Æ°á»£c thuáº­t toÃ¡n, ... liÃªn quan tá»›i LB cho toÃ n bá»™ <code>Ingress</code> cá»§a cluster.</p><p>NgoÃ i ra, ngÆ°á»i ta cÅ©ng dÃ¹ng <code>Ingress</code> Ä‘á»ƒ terminate TLS session.</p><p><img src="https://images.viblo.asia/5809feda-e282-4d5f-9cfb-11077d952add.jpg"></p><p>Kubernetes sau khi init máº·c Ä‘á»‹nh sáº½ khÃ´ng cÃ³ ingress controller. Náº¿u ta chá»‰ táº¡o <code>Ingress</code> thÃ¬ sáº½ khÃ´ng cÃ³ Ã½ nghÄ©a gÃ¬. Äá»ƒ sá»­ dá»¥ng <code>Ingress</code> ta sáº½ pháº£i setup thá»§ cÃ´ng Ingress Controller. Tuy nhiÃªn viá»‡c nÃ y khÃ¡ Ä‘Æ¡n giáº£n, do nhiá»u hÃ£ng Ä‘Ã£ build sáºµn má»i thá»©, ta chá»‰ cáº§n láº¥y file manifest cá»§a há» vá» rá»“i cháº¡y lÃ  Ä‘Æ°á»£c.</p><ul><li>nginx: <a href="https://kubernetes.github.io/ingress-nginx/" target="_blank" rel="noopener noreferrer">NGINX Ingress Controller</a></li><li>traefik: <a href="https://docs.traefik.io/providers/kubernetes-ingress/" target="_blank" rel="noopener noreferrer">Kubernetes Ingress</a></li><li>...</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="324-practice"></a>3.2.4 Practice<a class="hash-link" href="#324-practice" title="Direct link to heading">#</a></h4><p><img src="https://images.viblo.asia/5001a20e-979c-473f-b2da-92c8668f621e.png"></p><ul><li>Traffic tá»« phÃ­a client sáº½ Ä‘Æ°á»£c táº­p trung táº¡i Layer 4 Load Balancer.</li><li>L4 LB sáº½ phÃ¢n bá»‘ traffic tá»›i cÃ¡c Node trong cluster (thÆ°á»ng qua <code>NodePort</code>).</li><li><code>Ingress</code> Ä‘Æ°á»£c map vá»›i <code>NodePort</code> Ä‘Ã³ sáº½ terminate SSL, routing, vÃ  load balance traffic tá»›i nhá»¯ng Pod thÃ­ch há»£p.<ul><li>Traffic tá»›i <code>/web</code> sáº½ Ä‘Æ°á»£c Ä‘iá»u hÆ°á»›ng tá»›i Frontend Pods</li><li>Traffic tá»›i <code>/api</code> sáº½ Ä‘Æ°á»£c Ä‘iá»u hÆ°á»›ng tá»›i Backend Pods</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="33-storage---volume"></a>3.3 Storage - Volume<a class="hash-link" href="#33-storage---volume" title="Direct link to heading">#</a></h3><p>Má»™t há»‡ thá»‘ng khÃ³ cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng chá»‰ vá»›i stateless service.</p><p>Vá»›i má»™t sá»‘ service nhÆ° database, hay nhÆ° tÃ­nh nÄƒng upload file, ... Náº¿u chÃºng ta khÃ´ng sá»­ dá»¥ng external service, thÃ¬ service cá»§a ta sáº½ trá»Ÿ thÃ nh stateful service. NÃ³ Ä‘Ã²i há»i dá»¯ liá»‡u trong quÃ¡ trÃ¬nh xá»­ lÃ½ pháº£i Ä‘Æ°á»£c lÆ°u láº¡i ngay cáº£ khi bá»‹ crash. NgoÃ i ra cÃ³ nhá»¯ng lÃºc ta sáº½ cáº§n share dá»¯ liá»‡u giá»¯a nhá»¯ng container trong cÃ¹ng 1 Pod. Nhá»¯ng lÃºc nhÆ° váº­y, ta sáº½ cáº§n Ä‘áº¿n <strong>Volume</strong>.</p><p>Khi define Pod, ta sáº½ chá»‰ rÃµ Pod nÃ y cáº§n nhá»¯ng volume nÃ o, sau Ä‘Ã³ map nhá»¯ng volume Ä‘Ã³ cho container.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="persistentvolume"></a>PersistentVolume<a class="hash-link" href="#persistentvolume" title="Direct link to heading">#</a></h5><p>Kubernetes sá»­ dá»¥ng <code>PersistentVolume</code> Ä‘á»ƒ táº¡o nÃªn 1 lá»›p abstract vá»›i nhá»¯ng há»‡ thá»‘ng storage tháº­t phÃ­a sau. <code>PV</code> cÅ©ng cÃ³ life-cycle giá»‘ng nhÆ° Pod.</p><p>Khi ta sá»­ dá»¥ng volume, ta sáº½ khÃ´ng cáº§n quan tÃ¢m há»‡ thá»‘ng Ä‘áº±ng sau ngang dá»c ra sao, thá»© duy nháº¥t ta cáº§n quan tÃ¢m lÃ  API cá»§a <code>PersistentVolume</code>.</p><p>Trong Kubernetes, <code>PV</code> cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o báº±ng 2 cÃ¡ch:</p><ul><li>Dynamic Provisioning</li><li>Static Provisioning</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="static-provisioning"></a>Static Provisioning<a class="hash-link" href="#static-provisioning" title="Direct link to heading">#</a></h5><p>Admin cluster sáº½ táº¡o ra 1 sá»‘ <code>PV</code> trÆ°á»›c, sau Ä‘Ã³ cung cáº¥p cho bÃªn Dev/Ops. Nhá»¯ng <code>PV</code> nÃ y Ä‘Ã£ Ä‘Æ°á»£c trá» tá»›i há»‡ thá»‘ng storage tháº­t Ä‘ang hoáº¡t Ä‘á»™ng Ä‘áº±ng sau.</p><p>CÃ³ thá»ƒ xem danh sÃ¡ch driver mÃ  Kubernetes há»— trá»£ táº¡i <a href="https://kubernetes.io/docs/concepts/storage/volumes/#types-of-volumes" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a>.</p><p>VÃ­ dá»¥: Ta cÃ³ 1 cluster Glusterfs vá»›i 3 node, tá»•ng dung lÆ°á»£ng lÃ  3TB. Khi cáº§n 10GB cho viá»‡c lÆ°u trá»¯ share resource, ta sáº½ táº¡o <code>PersistentVolume</code> vá»›i dung lÆ°á»£ng 10GB, trá» tá»›i cluster nÃ³i trÃªn. Sau Ä‘Ã³ ta sáº½ sá»­ dá»¥ng volume trÃªn tÆ°Æ¡ng tá»± nhÆ° cÃ¡c volume khÃ¡c trong há»‡ thá»‘ng.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dynamic-provisioning"></a>Dynamic Provisioning<a class="hash-link" href="#dynamic-provisioning" title="Direct link to heading">#</a></h5><p><code>PV</code> sáº½ Ä‘Æ°á»£c táº¡o 1 cÃ¡ch Ä‘á»™ng. Tá»©c lÃ  khi nÃ o Pod cá»§a ta cáº§n volume, thÃ¬ <code>PV</code> sáº½ Ä‘Æ°á»£c táº¡o 1 cÃ¡ch tá»± Ä‘á»™ng, nhá» vÃ o <code>StorageClass</code> (sáº½ Ä‘á» cáº­p sau).</p><p>CÃ¡ch lÃ m nÃ y Ä‘Ã²i há»i há»‡ thá»‘ng storage cá»§a ta cÅ©ng pháº£i support dynamic provisioning.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="persistentvolumeclaim"></a>PersistentVolumeClaim<a class="hash-link" href="#persistentvolumeclaim" title="Direct link to heading">#</a></h5><p>Äá»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c <code>PV</code>, ta cáº§n táº¡o thÃªm <code>PersistentVolumeClaim</code> (PVC).</p><p>Ta cÃ³ thá»ƒ sá»­ dá»¥ng Claim trÃªn cho config, hay volume, ... cá»§a Pod.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-high-availability-setup"></a>4. High Availability Setup<a class="hash-link" href="#4-high-availability-setup" title="Direct link to heading">#</a></h1><p><img src="https://images.viblo.asia/48635fac-b09b-4174-b279-4f8d0fa29fb6.png"></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-reference"></a>5. Reference<a class="hash-link" href="#5-reference" title="Direct link to heading">#</a></h1><p>kubernetes.io - <a href="https://documentationo/docs/home/" target="_blank" rel="noopener noreferrer">Kubernetes Official Documentation</a></p><p>youtube.com - <a href="https://www.youtube.com/watch?v=GXq3FS8M_kw" target="_blank" rel="noopener noreferrer">June 2018 Online Meetup: Kubernetes Networking Master Class</a></p><p>x-team.com - <a href="https://x-team.com/blog/introduction-kubernetes-architecture/" target="_blank" rel="noopener noreferrer">INTRODUCTION TO KUBERNETES ARCHITECTURE</a></p><p>ovh.com - <a href="https://www.ovh.com/blog/getting-external-traffic-into-kubernetes-clusterip-nodeport-loadbalancer-and-ingress/" target="_blank" rel="noopener noreferrer">Getting external traffic into Kubernetes â€“ ClusterIp, NodePort, LoadBalancer, and Ingress</a></p><p>medium.com - <a href="https://medium.com/jorgeacetozi/kubernetes-master-components-etcd-api-server-controller-manager-and-scheduler-3a0179fc8186" target="_blank" rel="noopener noreferrer">Kubernetes Master Components: Etcd, API Server, Controller Manager, and Scheduler</a></p><p>medium.com - <a href="https://medium.com/google-cloud/kubernetes-nodeport-vs-loadbalancer-vs-ingress-when-should-i-use-what-922f010849e0" target="_blank" rel="noopener noreferrer">Kubernetes NodePort vs LoadBalancer vs Ingress? When should I use what?</a></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/devops">devops</a><a class="margin-horiz--sm" href="/blog/tags/kubernetes">kubernetes</a><a class="margin-horiz--sm" href="/blog/tags/introduction">introduction</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/toi-uu-menh-de-where-mysql">Tá»‘i Æ°u má»‡nh Ä‘á» WHERE (MySQL)</a></h2><div class="margin-vert--md"><time datetime="2019-11-14T00:00:00.000Z" class="blogPostDate_fNvV">November 14, 2019 Â· 9 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>CÃ³ 2 hÆ°á»›ng tá»‘i Æ°u Database chÃ­nh:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-tá»‘i-Æ°u-táº§ng-db"></a>1. Tá»‘i Æ°u táº§ng DB<a class="hash-link" href="#1-tá»‘i-Æ°u-táº§ng-db" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cáº¥u-trÃºc-db"></a>Cáº¥u trÃºc DB:<a class="hash-link" href="#cáº¥u-trÃºc-db" title="Direct link to heading">#</a></h5><ul><li>Äá»c nhiá»u =&gt; Ã­t table, nhiá»u column</li><li>Ghi nhiá»u =&gt; nhiá»u table, Ã­t column</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="index-Ä‘Ã£-á»•n-chÆ°a"></a>Index Ä‘Ã£ á»•n chÆ°a?<a class="hash-link" href="#index-Ä‘Ã£-á»•n-chÆ°a" title="Direct link to heading">#</a></h5><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="engine-cho-table"></a>Engine cho table<a class="hash-link" href="#engine-cho-table" title="Direct link to heading">#</a></h5><ul><li>MyISAM: Table-locking, phÃ¹ há»£p vá»›i table Ä‘á»c nhiá»u, ghi Ã­t</li><li>InnoDB: Row-locking, Ä‘Ã¡p á»©ng Ä‘Æ°á»£c viá»‡c ghi nhiá»u.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="caching"></a>Caching<a class="hash-link" href="#caching" title="Direct link to heading">#</a></h5><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-tá»‘i-Æ°u-pháº§n-cá»©ng"></a>2. Tá»‘i Æ°u pháº§n cá»©ng<a class="hash-link" href="#2-tá»‘i-Æ°u-pháº§n-cá»©ng" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="disk-seek"></a>Disk seek:<a class="hash-link" href="#disk-seek" title="Direct link to heading">#</a></h5><ul><li>Thá»i gian HDD quay khi tÃ¬m dá»¯ liá»‡u, SDD khÃ´ng cáº§n quay Ä‘á»ƒ tÃ¬m dá»¯ liá»‡u.</li><li>PhÃ¢n tÃ¡n dá»¯ liá»‡u Ä‘á»ƒ tÃ¬m trÃªn nhiá»u á»• Ä‘Ä©a cÃ¹ng lÃºc.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="disk-rw"></a>Disk R/W:<a class="hash-link" href="#disk-rw" title="Direct link to heading">#</a></h5><ul><li>Khi tÃ¬m Ä‘Æ°á»£c dá»¯ liá»‡u thÃ¬ sáº½ cáº§n Ä‘á»c dá»¯ liá»‡u vÃ o RAM.</li><li>PhÃ¢n tÃ¡n Ä‘á»ƒ Ä‘á»c/ghi nhiá»u trÃªn nhiá»u á»• Ä‘Ä©a cÃ¹ng lÃºc.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cpu-cycle"></a>CPU cycle<a class="hash-link" href="#cpu-cycle" title="Direct link to heading">#</a></h5><ul><li>Khi Ä‘Ã£ load Ä‘Æ°á»£c vÃ o RAM rá»“i, thÃ¬ sáº½ tá»›i CPU xá»­ lÃ½ nhá»¯ng dá»¯ liá»‡u Ä‘Ã³.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="memory-bandwidth"></a>Memory bandwidth:<a class="hash-link" href="#memory-bandwidth" title="Direct link to heading">#</a></h5><ul><li>Khi CPU cáº§n nhiá»u dá»¯ liá»‡u, nhÆ°ng cache láº¡i khÃ´ng Ä‘á»§, sáº½ cáº§n Ä‘áº¿n memory bandwith.</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-tá»‘i-Æ°u-cÃ¢u-lá»‡nh-where"></a>2. Tá»‘i Æ°u cÃ¢u lá»‡nh WHERE<a class="hash-link" href="#2-tá»‘i-Æ°u-cÃ¢u-lá»‡nh-where" title="Direct link to heading">#</a></h1><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ngoÃ i-select-thÃ¬-cÃ²n-Ã¡p-dá»¥ng-Ä‘Æ°á»£c-cho-cáº£-update-delete-vv"></a>NgoÃ i SELECT thÃ¬ cÃ²n Ã¡p dá»¥ng Ä‘Æ°á»£c cho cáº£ UPDATE, DELETE, v.v.<a class="hash-link" href="#ngoÃ i-select-thÃ¬-cÃ²n-Ã¡p-dá»¥ng-Ä‘Æ°á»£c-cho-cáº£-update-delete-vv" title="Direct link to heading">#</a></h5><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mysql-sáº½-tá»±-Ä‘á»™ng-tá»‘i-Æ°u-nhá»¯ng-trÆ°á»ng-há»£p-sau"></a>MySQL sáº½ tá»± Ä‘á»™ng tá»‘i Æ°u nhá»¯ng trÆ°á»ng há»£p sau:<a class="hash-link" href="#mysql-sáº½-tá»±-Ä‘á»™ng-tá»‘i-Æ°u-nhá»¯ng-trÆ°á»ng-há»£p-sau" title="Direct link to heading">#</a></h5><ul><li><p>Loáº¡i bá» nhá»¯ng dáº¥u ngoáº·c thá»«a</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> c </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Thay tháº¿ biáº¿n bá»Ÿi háº±ng sá»‘</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">a</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">b </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">c </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Loáº¡i bá» nhá»¯ng Ä‘iá»u kiá»‡n háº±ng</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">6</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Biá»ƒu thá»©c háº±ng (constant expression) sáº½ chá»‰ Ä‘Æ°á»£c tÃ­nh toÃ¡n 1 láº§n duy nháº¥t.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">WHERE</span><span class="token plain"> id </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> POW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">WHERE</span><span class="token plain"> id </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> FLOOR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> RAND</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">49</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p><code>HAVING</code> sáº½ Ä‘Æ°á»£c gá»™p vá»›i <code>WHERE</code> khi khÃ´ng sá»­ dá»¥ng <code>GROUP BY</code> hay nhá»¯ng function nhÆ° <code>COUNT()</code>, <code>MIN()</code>, <code>MAX()</code>, ...</p></li><li><p>Äá»‘i vá»›i <strong>MyISAM</strong> hay <strong>MEMORY</strong> table, káº¿t quáº£ cá»§a <code>COUNT(*)</code> (khÃ´ng cÃ³ Ä‘iá»u kiá»‡n <code>WHERE</code> sáº½ Ä‘Æ°á»£c láº¥y trá»±c tiáº¿p tá»« <strong>information_schema</strong>.</p></li></ul><p>=&gt; Ta cÃ³ thá»ƒ ngá»«ng viá»‡c tá»‘i Æ°u láº¡i, vÃ  viáº¿t nhá»¯ng cÃ¢u lá»‡nh SQL dá»… hiá»ƒu, dá»… báº£o trÃ¬.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-range-optimization"></a>3. Range optimization<a class="hash-link" href="#3-range-optimization" title="Direct link to heading">#</a></h1><ul><li><code>range</code> lÃ  má»™t <strong>access method</strong></li><li><code>range</code> sá»­ dá»¥ng index Ä‘á»ƒ láº¥y ra nhá»¯ng subset cá»§a káº¿t quáº£ cuá»‘i cÃ¹ng.</li><li><code>range</code> support cáº£ single-part láº«n multiple-part index.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nhá»¯ng-trÆ°á»ng-há»£p-sau-mysql-sáº½-coi-nhÆ°-lÃ -range-condition"></a>Nhá»¯ng trÆ°á»ng há»£p sau, MySQL sáº½ coi nhÆ° lÃ  <code>range condition</code>:<a class="hash-link" href="#nhá»¯ng-trÆ°á»ng-há»£p-sau-mysql-sáº½-coi-nhÆ°-lÃ -range-condition" title="Direct link to heading">#</a></h4><ul><li><p>Má»‡nh Ä‘á» <code>WHERE</code> Ä‘á»‘i vá»›i nhá»¯ng trÆ°á»ng Ä‘Æ°á»£c Ä‘Ã¡nh index (sá»­ dá»¥ng BTree hoáº·c Hash), mÃ  sá»­ dá»¥ng nhá»¯ng toÃ¡n tá»­ sau: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, hay <code>IS NOT NULL</code></p><p>Äá»‘i vá»›i, BTree, ngoÃ i nhá»¯ng phÃ©p toÃ¡n trÃªn, cÃ²n support thÃªm <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>BETWEEN</code>, <code>!=</code>, hay <code>&lt;&gt;</code> vá»›i <strong>constant value</strong>, hoáº·c <code>LIKE</code> cÅ©ng lÃ  range condition. ChÃº Ã½ khi sá»­ dá»¥ng <code>LIKE</code>, váº¿ pháº£i pháº£i lÃ  1 string háº±ng, vÃ  khÃ´ng báº¯t Ä‘áº§u bá»Ÿi wildcard nhÆ° <code>%</code> hay <code>_</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">WHERE</span><span class="token plain"> key_col </span><span class="token operator" style="color:rgb(137, 221, 255)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;ab%&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Káº¿t há»£p nhiá»u range condition sá»­ dá»¥ng <code>AND</code> hoáº·c <code>OR</code>, ta váº«n thu Ä‘Æ°á»£c range condition.</p></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="constant-value"></a>Constant value<a class="hash-link" href="#constant-value" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lÃ -giÃ¡-trá»‹-Ä‘Æ°á»£c-tÃ­nh-toÃ¡n-trÆ°á»›c-thá»i-Ä‘iá»ƒm-runtime-khi-runtime-giÃ¡-trá»‹-cá»§a-nÃ³-sáº½-khÃ´ng-thay-Ä‘á»•i"></a>LÃ  giÃ¡ trá»‹ Ä‘Æ°á»£c tÃ­nh toÃ¡n trÆ°á»›c thá»i Ä‘iá»ƒm runtime, khi runtime, giÃ¡ trá»‹ cá»§a nÃ³ sáº½ khÃ´ng thay Ä‘á»•i<a class="hash-link" href="#lÃ -giÃ¡-trá»‹-Ä‘Æ°á»£c-tÃ­nh-toÃ¡n-trÆ°á»›c-thá»i-Ä‘iá»ƒm-runtime-khi-runtime-giÃ¡-trá»‹-cá»§a-nÃ³-sáº½-khÃ´ng-thay-Ä‘á»•i" title="Direct link to heading">#</a></h5><ul><li>Háº±ng sá»‘ truyá»n tháº³ng vÃ o tham sá»‘ cá»§a cÃ¢u truy váº¥n</li><li>Má»™t cá»™t cá»§a <code>const</code> hay <code>system</code> table<ul><li><code>const</code> table lÃ  báº£ng chá»‰ cÃ³ tá»‘i Ä‘a 1 row (hay 0 hoáº·c 1 row).</li><li><code>const</code> table cÃ³ thá»ƒ lÃ  káº¿t quáº£ cá»§a 1 cÃ¢u truy váº¥n chá»©a má»‡nh Ä‘á» <code>WHERE</code> Ä‘á»‘i vá»›i 1 field unique, not null, cÃ³ dáº¡ng <code>column = constant</code>. Truy váº¥n nÃ y luÃ´n tráº£ vá» 1 káº¿t quáº£ duy nháº¥t.</li><li>table cÃ³ 1 row thÃ¬ gá»i lÃ  <code>system</code> table</li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="btree-hash-index"></a>BTree, Hash index<a class="hash-link" href="#btree-hash-index" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="btree"></a>BTree:<a class="hash-link" href="#btree" title="Direct link to heading">#</a></h5><ul><li><p>Self-balancing tree, cáº¥u trÃºc dáº¡ng cÃ¢y, cÃ³ thá»ƒ tá»± cÃ¢n báº±ng nháº±m giá»¯ chiá»u cao cá»§a cÃ¢y tháº¥p nháº¥t cÃ³ thá»ƒ.</p></li><li><p>TrÃ¡nh nháº§m vá»›i Binary Tree (cÃ¢y nhá»‹ phÃ¢n)</p></li><li><p>Thá»i gian tÃ¬m kiáº¿m O(logn)</p></li><li><p>PhÃ¹ há»£p vá»›i Ä‘a dáº¡ng cÃ¡c phÃ©p toÃ¡n: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, <code>IS NOT NULL</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>BETWEEN</code>, <code>!=</code>, <code>&lt;&gt;</code>, hay tháº­m chÃ­ cáº£ <code>LIKE</code></p></li></ul><p><img src="https://camo.githubusercontent.com/cb15fccfa6fafa1cea762a58c1dd51ad8f32fe2c/68747470733a2f2f63646e2d696d616765732d312e6d656469756d2e636f6d2f6d61782f313630302f312a70453453457a374370727a4664375a77772d617866512e6a706567"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hash"></a>Hash:<a class="hash-link" href="#hash" title="Direct link to heading">#</a></h5><ul><li><p>Báº£ng bÄƒm, lÃ  cáº¥u trÃºc dá»¯ liá»‡u lÆ°u theo key-value</p></li><li><p>TÃ¬m kiáº¿m theo key ráº¥t nhanh - O(1)</p></li><li><p>PhÃ¹ há»£p vá»›i nhá»¯ng phÃ©p toÃ¡n: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, hay <code>IS NOT NULL</code>.</p></li></ul><p><img src="https://camo.githubusercontent.com/b1df2be12b1c8779b7cf941d88d1cc8e2178753f/68747470733a2f2f696d616765732e7669626c6f2e617369612f30356236313638372d386230342d346536352d613834642d3361353363343035386437642e6a7067"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="31-single-part-index"></a>3.1. Single-part index<a class="hash-link" href="#31-single-part-index" title="Direct link to heading">#</a></h2><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="single-part-index-lÃ -nhá»¯ng-index-Ä‘Æ°á»£c-Ä‘Ã¡nh-riÃªng-láº»-cho-1-field"></a>Single-part index lÃ  nhá»¯ng index Ä‘Æ°á»£c Ä‘Ã¡nh riÃªng láº» cho 1 field.<a class="hash-link" href="#single-part-index-lÃ -nhá»¯ng-index-Ä‘Æ°á»£c-Ä‘Ã¡nh-riÃªng-láº»-cho-1-field" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INDEX</span><span class="token plain"> index_name </span><span class="token keyword" style="font-style:italic">ON</span><span class="token plain"> t1 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_col</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Khi thá»±c hiá»‡n truy váº¥n vá»›i nhá»¯ng index loáº¡i nÃ y, vá»›i má»—i possible key (cÃ³ thá»ƒ sá»­ dá»¥ng <code>EXPLAIN</code> Ä‘á»ƒ check), MySQL sáº½ tiáº¿n hÃ nh extract range condition. Nhá»¯ng Ä‘iá»u kiá»‡n khÃ´ng thá»ƒ cáº¥u thÃ nh range condition sáº½ bá»‹ loáº¡i bá», nhá»¯ng Ä‘iá»u kiá»‡n cÃ³ thá»ƒ bá»‹ overlap sáº½ Ä‘Æ°á»£c gá»™p vá»›i nhau.</p><p>Sau khi extract, MySQL sáº½ Ã¡p dá»¥ng nhá»¯ng Ä‘iá»u kiá»‡n Ä‘Ã³ Ä‘á»ƒ táº­n dá»¥ng Ä‘Æ°á»£c tá»‘i Ä‘a index cá»§a table, sau Ä‘Ã³ káº¿t há»£p thÃªm vá»›i nhá»¯ng Ä‘iá»u kiá»‡n cÃ²n láº¡i Ä‘á»ƒ lá»c tiáº¿p.</p><p>MySQL chá»‰ bá» qua index, náº¿u nhÆ° nÃ³ tin ráº±ng viá»‡c duyá»‡t full table tá»‘i Æ°u hÆ¡n, hoáº·c dÃ¹ng <code>FORCE INDEX</code>.</p><p>VD:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abcde%&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;%b&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> nonkey </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;uux&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;z&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">LIKE</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abcde%&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;uux&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;z&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">TRUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token boolean" style="color:rgb(255, 88, 116)">FALSE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> key1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;bar&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="32-multiple-part-index"></a>3.2. Multiple-part index<a class="hash-link" href="#32-multiple-part-index" title="Direct link to heading">#</a></h2><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="multiple-part-index-lÃ -nhá»¯ng-index-Ä‘Æ°á»£c-Ä‘Ã¡nh-cho-nhiá»u-trÆ°á»ng-cÃ¹ng-lÃºc"></a>Multiple-Part Index lÃ  nhá»¯ng index Ä‘Æ°á»£c Ä‘Ã¡nh cho nhiá»u trÆ°á»ng cÃ¹ng lÃºc<a class="hash-link" href="#multiple-part-index-lÃ -nhá»¯ng-index-Ä‘Æ°á»£c-Ä‘Ã¡nh-cho-nhiá»u-trÆ°á»ng-cÃ¹ng-lÃºc" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INDEX</span><span class="token plain"> index_name </span><span class="token keyword" style="font-style:italic">ON</span><span class="token plain"> t1 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> key_part2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Range condition sáº½ sá»­ dá»¥ng <strong>key tuple intervals</strong> Ä‘á»ƒ tÃ¬m kiáº¿m. Key tuple intervals Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi nhá»¯ng key tuples, cÃ³ thá»© tá»±.</p><p><strong>Tuple</strong> lÃ  1 cáº·p giÃ¡ trá»‹. VD: (1, 2, 3), (1, &#x27;a&#x27;, 3), ...</p><p>Láº¥y vÃ­ dá»¥ vá» 1 multiple-part index <code>key1(key_part1, key_part2, key_part3)</code>, vÃ  nhá»¯ng tuples á»©ng vá»›i key tuple (key_part1, key_part2, key_part3) sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">key_part1  key_part2  key_part3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  NULL       1          &#x27;abc&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  NULL       1          &#x27;xyz&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  NULL       2          &#x27;foo&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   1         1          &#x27;abc&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   1         1          &#x27;xyz&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   1         2          &#x27;abc&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   2         1          &#x27;aaa&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>key_part1 = 1</code> define interval sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly plaintext"><div tabindex="0" class="prism-code language-plaintext codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(1,-inf,-inf) &lt;= (key_part1,key_part2,key_part3) &lt; (1,+inf,+inf)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Interval trÃªn sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi <code>range</code> access method.</p><p>BÃªn cáº¡nh Ä‘Ã³, <code>key_part3 = &#x27;abc&#x27;</code> khÃ´ng táº¡o ra interval nÃ o (giÃ¡ trá»‹ liá»n máº¡ch nhau), vÃ¬ tháº¿ sáº½ khÃ´ng thá»ƒ sá»­ dá»¥ng bá»Ÿi <code>range</code></p><p>ChÃº Ã½ khi sá»­ dá»¥ng:</p><ul><li><p>Vá»›i Hash index, náº¿u index cÃ³ <code>N</code> part, thÃ¬ condition cá»§a ta pháº£i cÃ³ format sau</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">    key_part1 cmp const1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key_part2 cmp const2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key_partN cmp constN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>cmp</code> lÃ  má»™t trong nhá»¯ng toÃ¡n tá»­ <code>=</code>, <code>&lt;=&gt;</code>, hoáº·c <code>IS NULL</code></p></li><li><p>Vá»›i BTree index, 1 interval cÃ³ thá»ƒ sá»­ dá»¥ng cho nhá»¯ng Ä‘iá»u kiá»‡n káº¿t há»£p bá»Ÿi <code>AND</code>, trong Ä‘Ã³ má»—i Ä‘iá»u kiá»‡n so sÃ¡nh 1 key part vá»›i 1 háº±ng sá»‘, sá»­ dá»¥ng <code>=</code>, <code>&lt;=&gt;</code>, <code>IS NULL</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>&lt;&gt;</code>.</p><p>Optimizer trong khi tÃ­nh toÃ¡n interval, sáº½ sá»­ dá»¥ng thÃªm key part náº¿u toÃ¡n tá»­ lÃ  <code>=</code>, <code>&lt;=&gt;</code> hay <code>IS NULL</code>. CÃ²n náº¿u lÃ  <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>&lt;&gt;</code>, <code>BETWEEN</code> hay <code>LIKE</code> thÃ¬ sáº½ khÃ´ng láº¥y thÃªm key part ná»¯a.</p><p>VD1:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">key_part1 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;foo&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key_part2 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key_part3 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>sáº½ sá»­ dá»¥ng interval:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;foo&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">key_part3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;foo&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain">inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>VD2:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">AND</span><span class="token plain"> key_part2 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>sáº½ sá»­ dá»¥ng 2 interval:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Trong vÃ­ dá»¥ nÃ y, interval thá»© nháº¥t sá»­ dá»¥ng 1 key part á»Ÿ váº¿ trÃ¡i, váº¿ pháº£i sá»­ dá»¥ng 2 key part.</p><p>Interval thá»© 2 chá»‰ sá»­ dá»¥ng 1 key part.</p><p>GiÃ¡ trá»‹ <code>key_len</code> khi thá»±c hiá»‡n <code>EXPLAIN</code> sáº½ tráº£ vá» Ä‘á»™ dÃ i tá»‘i Ä‘a cá»§a key prefix Ä‘Æ°á»£c sá»­ dá»¥ng.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="index-dive"></a>Index Dive<a class="hash-link" href="#index-dive" title="Direct link to heading">#</a></h3><p>Index dive Ä‘Æ°á»£c thá»±c hiá»‡n trong khi optimizing Ä‘á»ƒ tÃ­nh toÃ¡n estimate (sá»‘ row thá»a mÃ£n 1 condition), Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem cÃ³ nÃªn dÃ¹ng index hay khÃ´ng. CÃ³ thá»ƒ skip báº±ng cÃ¡ch dÃ¹ng <code>FORCE INDEX</code></p><p>Náº¿u Ä‘iá»u kiá»‡n phá»©c táº¡p thÃ¬ index dive sáº½ máº¥t nhiá»u thá»i gian.</p><p>NgoÃ i index dive, MySQL cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng index statistics Ä‘á»ƒ estimate, tuy nhiÃªn Ä‘á»™ chÃ­nh xÃ¡c tháº¥p hÆ¡n, cÃ³ thá»ƒ dÃ¹ng <code>ANALYZE TABLE</code> Ä‘á»ƒ update láº¡i index statistics, tÄƒng cÆ°á»ng Ä‘á»™ chÃ­nh xÃ¡c.</p><p>Index dive bá»‹ skip trong trÆ°á»ng há»£p thá»a mÃ£n táº¥t cáº£ Ä‘iá»u kiá»‡n sau (chá»‰ Ã¡p dá»¥ng cho single table query):</p><ul><li><code>FORCE INDEX</code></li><li>Nonunique index, vÃ  khÃ´ng pháº£i <code>FULLTEXT</code> index.</li><li>KhÃ´ng cÃ³ subquery</li><li>KhÃ´ng cÃ³ <code>DISTINCT</code>, <code>GROUP BY</code>, hoáº·c <code>ORDER BY</code>.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="equality-range-optimization-of-many-valued-comparisons"></a>Equality Range Optimization of Many-Valued Comparisons<a class="hash-link" href="#equality-range-optimization-of-many-valued-comparisons" title="Direct link to heading">#</a></h5><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">col_name </span><span class="token operator" style="color:rgb(137, 221, 255)">IN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">val1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> valN</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">col_name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> val1 </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">OR</span><span class="token plain"> col_name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> valN</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Nhá»¯ng biá»ƒu thá»©c nhÆ° trÃªn, vá»›i <code>col_name</code> Ä‘Æ°á»£c Ä‘Ã¡nh index, vÃ  so sÃ¡nh vá»›i nhiá»u giÃ¡ trá»‹, Ä‘Æ°á»£c gá»i lÃ  range comparisions (má»—i range lÃ  1 giÃ¡ trá»‹). Optimizer sáº½ estimate cost cá»§a má»—i range nhÆ° sau:</p><ul><li>Náº¿u index lÃ  unique, cost = 1</li><li>Náº¿u khÃ´ng unique, sáº½ cáº§n sá»­ dá»¥ng index dive hoáº·c index statistics Ä‘á»ƒ estimate.</li></ul><p>á»¨ng vá»›i má»—i range lÃ  2 láº§n dive (1 cho Ä‘iá»ƒm báº¯t Ä‘áº§u, 1 cho Ä‘iá»ƒm káº¿t thÃºc) cá»§a range (interval).</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/mysql">mysql</a><a class="margin-horiz--sm" href="/blog/tags/database">database</a><a class="margin-horiz--sm" href="/blog/tags/optimization">optimization</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cung-tim-hieu-ve-actiontext-trong-rails-6">CÃ¹ng tÃ¬m hiá»ƒu vá» ActionText trong Rails 6</a></h2><div class="margin-vert--md"><time datetime="2019-07-20T00:00:00.000Z" class="blogPostDate_fNvV">July 20, 2019 Â· 11 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>Rails 6 Ä‘Ã£ bÆ°á»›c vÃ o giai Ä‘oáº¡n beta vá»›i phiÃªn báº£n <a href="https://github.com/rails/rails/releases/tag/v6.0.0.rc1" target="_blank" rel="noopener noreferrer">v6.0.0.rc1</a>. RC lÃ  viáº¿t táº¯t cá»§a <strong>R</strong>elease <strong>C</strong>andidate, Ä‘Ã¢y lÃ  phiÃªn báº£n mÃ  cÃ³ xÃ¡c suáº¥t trá»Ÿ thÃ nh final release ráº¥t cao. Ta cÃ³ thá»ƒ Ã¡p dá»¥ng nÃ³ vÃ o dá»± Ã¡n ngay ká»ƒ tá»« bÃ¢y giá» mÃ  khÃ´ng cáº§n lo sá»£ cÃ³ nhá»¯ng breaking change.</p><p>Náº¿u báº¡n sá»­ dá»¥ng Docker, mÃ¬nh khuyÃªn nÃªn sá»­ dá»¥ng ruby 2.6.3, vÃ¬ trÆ°á»›c Ä‘Ã¢y mÃ¬nh Ä‘Ã£ dÃ¹ng thá»­ ruby:2.7.0-preview1-alpine3.10 thÃ¬ khÃ¡ nhiá»u lá»—i khi up server, mÃ  cháº£ biáº¿t pháº£i fix sao :sad:</p><p>á» Rails 6, cÃ³ khÃ¡ nhiá»u tÃ­nh nÄƒng má»›i hay ho:</p><ul><li>Action Text</li><li>Parallel Testing</li><li>Action Model custom error message format.</li><li>vÃ¢n vÃ¢n mÃ¢y mÃ¢y...</li></ul><p>á» bÃ i nÃ y, mÃ¬nh sáº½ chá»‰ táº­p trung Ä‘á» cáº­p tá»›i Action Text. ÄÃ¢y lÃ  má»™t package giÃºp ta xÃ¢y dá»±ng WYSIWYG editor má»™t cÃ¡ch nhanh chÃ³ng, hÆ¡n ná»¯a, viá»‡c upload cÅ©ng Ä‘Æ°á»£c integrate vá»›i Active Storage.</p><p><strong>ChÃº Ã½:</strong> BÃ i khÃ¡ dÃ i vÃ  embed nhiá»u code :v</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cÃ¡ch-dÃ¹ng"></a>CÃ¡ch dÃ¹ng<a class="hash-link" href="#cÃ¡ch-dÃ¹ng" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cÃ i-Ä‘áº·t-vÃ -sá»­-dá»¥ng"></a>CÃ i Ä‘áº·t vÃ  sá»­ dá»¥ng<a class="hash-link" href="#cÃ i-Ä‘áº·t-vÃ -sá»­-dá»¥ng" title="Direct link to heading">#</a></h2><p>VÃ¬ lÃ  Rails nÃªn cÃ¡ch sá»­ dá»¥ng ráº¥t Ä‘Æ¡n giáº£n, nhÆ°ng ta sáº½ cháº£ biáº¿t nÃ³ cháº¡y cÃ¡i gÃ¬ Ä‘áº±ng sau cáº£ =))</p><p>CÃ i Ä‘áº·t Action Text báº±ng CLI command sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rails action_text:install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Nhá»› hÃ£y cháº¡y thÃªm cáº£ command install Active Storage ná»¯a.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rails active_storage:install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Äá»ƒ Ã¡p dá»¥ng cho field <code>content</code> cá»§a model <code>Post</code>, ta sáº½ dÃ¹ng tá»›i macro <code>has_rich_text</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class CreatePosts &lt; ActiveRecord::Migration[6.0]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def change</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    create_table :posts do |t|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.string :content</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.string :category</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.timestamps</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>content</code> á»Ÿ Ä‘Ã¢y mÃ¬nh dÃ¹ng string, nhÆ°ng khuyáº¿n khÃ­ch dÃ¹ng text hÆ¡n.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Post &lt; ApplicationRecord</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    has_rich_text :content</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>TrÃªn form, ta chá»‰ viá»‡c dÃ¹ng <code>rich_text_area</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly erb"><div tabindex="0" class="prism-code language-erb codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;%= form_with(model: @post) do |form| %&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;div class=&quot;field&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;%= form.label :content %&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;%= form.rich_text_area :content %&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;/div&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;% end %&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Khi permit params, ta cÅ©ng lÃ m nhÆ° bao field khÃ¡c</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class PostsController &lt; ApplicationController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def post_params</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    params.require(:post).permit(:category, :content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Cuá»‘i cÃ¹ng ta hiá»ƒn thá»‹ dá»¯ liá»‡u nhÆ° sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly erb"><div tabindex="0" class="prism-code language-erb codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;%= @post.content %&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ¢u lá»‡nh trÃªn thá»±c cháº¥t Ä‘ang ngáº§m gá»i tá»›i <code>@post.content.to_s</code></p><p>ÄÃ¢y lÃ  sáº£n pháº©m cá»§a ta:</p><p>Form táº¡o post vá»›i WYSIWYG editor - Sá»­ dá»¥ng Trix editor, do Basecamp phÃ¡t triá»ƒn, cÃ¢y nhÃ  lÃ¡ vÆ°á»n luÃ´n.</p><p>CÃ³ thá»ƒ kÃ©o tháº£ file vÃ o, file Ä‘Ã³ sáº½ Ä‘Æ°á»£c upload báº±ng Active Storage.</p><p><img src="https://images.viblo.asia/77b9bd23-5ba3-426b-b6fc-cac02edb0b42.png"></p><p>Hiá»ƒn thá»‹ dá»¯ liá»‡u á»Ÿ mÃ n hÃ¬nh detail</p><p><img src="https://images.viblo.asia/6b1b8da0-ca7f-468b-9705-444a8cb2d736.png"></p><p>CÃ¡c báº¡n tháº¥y sao? CÃ¡ nhÃ¢n mÃ¬nh tháº¥y xáº¥u nhÆ° cá» hÃ³ váº­y =)) Tuy nhiÃªn ta cÃ³ thá»ƒ styling cho nÃ³.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="styling"></a>Styling<a class="hash-link" href="#styling" title="Direct link to heading">#</a></h2><p>Rails Ä‘ang cÃ³ sáºµn má»™t vÃ i style cÆ¡ báº£n cho nÃ³ trong file <code>app/assets/stylesheets/actiontext.scss</code>, ta cÃ³ thá»ƒ sá»­a nÃ³ Ä‘á»ƒ cho Ä‘áº¹p hÆ¡n.</p><p>Vá»›i Ä‘á»‘ng tool cá»§a editor thÃ¬ cÃ³ thá»ƒ dÃ¹ng selector <code>.trix-button-row</code></p><p>Vá»›i template attachment (nhÆ° cÃ¡i <code>monaco.ttf</code> á»Ÿ trÃªn), ta cÅ©ng cÃ³ thá»ƒ custom láº¡i, Rails cung cáº¥p sáºµn template máº·c Ä‘á»‹nh á»Ÿ file <code>app/views/active_storage/blobs/_blob.html.erb</code></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tÃ¬m-hiá»ƒu-sá»±-ma-giÃ¡o"></a>TÃ¬m hiá»ƒu sá»± ma giÃ¡o<a class="hash-link" href="#tÃ¬m-hiá»ƒu-sá»±-ma-giÃ¡o" title="Direct link to heading">#</a></h1><p>Rá»“i ta Ä‘Ã£ lÆ°á»›t qua cÃ¡ch sá»­ dá»¥ng nÃ³, nhÆ°ng mÃ  cÃ³ quÃ¡ nhiá»u magic.</p><p>Liá»‡u báº¡n cÃ³ tá»± Ä‘áº·t ra nhá»¯ng cÃ¢u há»i tháº¿ nÃ y hay khÃ´ng?</p><ul><li><p>KhÃ´ng biáº¿t cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u cá»§a nÃ³ nhÆ° tháº¿ nÃ o?</p></li><li><p>LÃ m sao mÃ  cÃ¡i file trong kia integrate Ä‘Æ°á»£c vá»›i Active Storage?</p></li><li><p>VÃ¬ sao láº¡i cÃ³ thá»ƒ custom láº¡i nhá»¯ng attachment báº±ng template?</p></li><li><p>vÃ¢n vÃ¢n mÃ¢y mÃ¢y...</p></li></ul><p>Ta sáº½ báº¯t tay vÃ o tÃ¬m hiá»ƒu nÃ³.</p><p>HÃ£y báº¯t Ä‘áº§u vá»›i <code>has_rich_text</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="macro-has_rich_text"></a>Macro <code>has_rich_text</code><a class="hash-link" href="#macro-has_rich_text" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/6a5c8b91998c56e50b5cc934d968947cd319f735/actiontext/lib/action_text/attribute.rb#L26</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def has_rich_text(name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class_eval &lt;&lt;-CODE, __FILE__, __LINE__ + 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def #{name}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      rich_text_#{name} || build_rich_text_#{name}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def #{name}=(body)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      self.#{name}.body = body</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  CODE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  has_one :&quot;rich_text_#{name}&quot;, -&gt; { where(name: name) },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    class_name: &quot;ActionText::RichText&quot;, as: :record, inverse_of: :record, autosave: true, dependent: :destroy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  # ... codes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Dá»… dÃ ng tháº¥y ráº±ng Ä‘Ã¢y lÃ  1 macro giÃºp Ä‘á»‹nh nghÄ©a getter, setter, vÃ  cáº£ association <code>has_one :rich_text_...</code> vá»›i <code>ActionText::RichText</code>.</p><p>Váº­y thÃ¬ khi ta gá»i <code>@post.content</code>, thá»±c cháº¥t lÃ  ta Ä‘ang gá»i tá»›i <code>@post.rich_text_content</code>.</p><p>VÃ  nÃ³ cÅ©ng chá»‰ ra 1 Ä‘iá»u ná»¯a lÃ  Rails dÃ¹ng 1 báº£ng riÃªng Ä‘á»ƒ lÆ°u láº¡i Ä‘á»‘ng rich text cá»§a ta.</p><p>HÃ£y dÃ nh chÃºt thá»i gian nhÃ¬n vÃ o thÆ° má»¥c <code>db/migrate</code>, ta sáº½ tháº¥y file sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># db/migrate/20190718085159_create_action_text_tables.action_text.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># This migration comes from action_text (originally 20180528164100)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class CreateActionTextTables &lt; ActiveRecord::Migration[6.0]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def change</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    create_table :action_text_rich_texts do |t|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.string     :name, null: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.text       :body, size: :long</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.references :record, null: false, polymorphic: true, index: false</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.timestamps</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      t.index [ :record_type, :record_id, :name ], name: &quot;index_action_text_rich_texts_uniqueness&quot;, unique: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Quáº£ tháº­t lÃ  váº­y, <code>body</code> chÃ­nh lÃ  nÆ¡i lÆ°u trá»¯ Ä‘á»‘ng text cá»§a ta, cÃ²n <code>name</code>, <code>record_id</code>, vÃ  <code>record_type</code> lÃ  nhá»¯ng attribute cho polymorphic association, khÃ¡ quen thuá»™c náº¿u báº¡n Ä‘Ã£ dÃ¹ng Active storage</p><p>Ta sáº½ Ä‘i Ä‘áº¿n bÆ°á»›c tiáº¿p theo <code>rich_text_area</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rails-xá»­-lÃ½-lÆ°u-trá»¯-rich-text-nhÆ°-tháº¿-nÃ o"></a>Rails xá»­ lÃ½, lÆ°u trá»¯ rich text nhÆ° tháº¿ nÃ o?<a class="hash-link" href="#rails-xá»­-lÃ½-lÆ°u-trá»¯-rich-text-nhÆ°-tháº¿-nÃ o" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/cc1a5d5620c4cd952b27f6c1bbd16d8780a34d0e/actiontext/app/helpers/action_text/tag_helper.rb#L20</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def rich_text_area_tag(name, value = nil, options = {})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options = options.symbolize_keys</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options[:input] ||= &quot;trix_input_#{ActionText::TagHelper.id += 1}&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options[:class] ||= &quot;trix-content&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options[:data] ||= {}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options[:data][:direct_upload_url] = main_app.rails_direct_uploads_url</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  options[:data][:blob_url_template] = main_app.rails_service_blob_url(&quot;:signed_id&quot;, &quot;:filename&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  editor_tag = content_tag(&quot;trix-editor&quot;, &quot;&quot;, options)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  input_tag = hidden_field_tag(name, value, id: options[:input])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  input_tag + editor_tag</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ³ thá»ƒ tháº¥y Ä‘Æ¡n giáº£n nÃ³ chá»‰ init cÃ¡i trix editor cho ta thÃ´i.</p><p>Viá»‡c kÃ©o tháº£ file, upload hoÃ n toÃ n Ä‘Æ°á»£c handle bá»Ÿi trix editor, ta khÃ´ng custom Ä‘Æ°á»£c template sau khi file upload thÃ nh cÃ´ng.</p><p>Tuy nhiÃªn Action Text cÃ³ thÃªm 1 callback sau khi file Ä‘Æ°á»£c upload thÃ nh cÃ´ng:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// https://github.com/rails/rails/blob/cc1a5d5620c4cd952b27f6c1bbd16d8780a34d0e/actiontext/app/javascript/actiontext/attachment_upload.js#L26</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">attachment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setAttributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sgid</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">attachable_sgid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createBlobUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">signed_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Ä‘Ã¢y lÃ  1 step ráº¥t quan trá»ng, nhÆ°ng ta sáº½ chÆ°a cáº§n chÃº Ã½ tá»›i nÃ³ vá»™i. Attachment cá»§a ta sau khi upload thÃ nh cÃ´ng sáº½ trÃ´ng nhÆ° sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><div tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">contenteditable</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">false</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">data-trix-attachment</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">{</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">contentType</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">:</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">application/zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">,</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">filename</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">:</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">,</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">filesize</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">:88996,</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">sgid</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">:</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">BAh7CEkiCGdpZAY6BkVUSSIvZ2lkOi8vYXBwL0FjdGl2ZVN0b3JhZ2U6OkJsb2IvOD9leHBpcmVzX2luBjsAVEkiDHB1cnBvc2UGOwBUSSIPYXR0YWNoYWJsZQY7AFRJIg9leHBpcmVzX2F0BjsAVDA=--79d2aa5a0af367233a5420a4f0ae02657d3910ab</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">,</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">url</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">:</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBEUT09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--e79bebbfa0f10319d319411c129291d12e752d22/monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">data-trix-content-type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">application/zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">data-trix-id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">1108</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment attachment--file attachment--zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__caption</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__name</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">monaco.ttf-master.zip</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__size</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">86.91 KB</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Tiáº¿p Ä‘áº¿n lÃ  submit dá»¯ liá»‡u, váº­y Rails sáº½ gá»­i gÃ¬ lÃªn?</p><p>ÄÆ¡n giáº£n lÃ  Rails sáº½ gá»­i táº¥t cáº£ nhá»¯ng gÃ¬ bÃªn trong <code>&lt;trix-editor&gt;&lt;/trix-editor&gt;</code></p><p>Inspect thá»­ params, ta sáº½ tháº¥y:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">post_params[:content]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># =&gt; &quot;&lt;div&gt;&lt;a href=\&quot;http://localhost:60100/posts/new\&quot;&gt;http://localhost:60100/posts/new&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;strong&gt;Hello world&lt;br&gt;&lt;/strong&gt;&lt;figure data-trix-attachment=\&quot;{&amp;quot;content&amp;quot;:&amp;quot;&lt;figure class=\\&amp;quot;attachment attachment--file attachment--zip\\&amp;quot;&gt;\\n\\n  &lt;figcaption class=\\&amp;quot;attachment__caption\\&amp;quot;&gt;\\n      &lt;span class=\\&amp;quot;attachment__name\\&amp;quot;&gt;monaco.ttf-master.zip&lt;/span&gt;\\n      &lt;span class=\\&amp;quot;attachment__size\\&amp;quot;&gt;86.9 KB&lt;/span&gt;\\n  &lt;/figcaption&gt;\\n&lt;/figure&gt;\\n&amp;quot;,&amp;quot;contentType&amp;quot;:&amp;quot;application/zip&amp;quot;,&amp;quot;filename&amp;quot;:&amp;quot;monaco.ttf-master.zip&amp;quot;,&amp;quot;filesize&amp;quot;:88996,&amp;quot;sgid&amp;quot;:&amp;quot;BAh7CEkiCGdpZAY6BkVUSSIvZ2lkOi8vYXBwL0FjdGl2ZVN0b3JhZ2U6OkJsb2IvNz9leHBpcmVzX2luBjsAVEkiDHB1cnBvc2UGOwBUSSIPYXR0YWNoYWJsZQY7AFRJIg9leHBpcmVzX2F0BjsAVDA=--97b885c24fd3d87464525f34a7b6ea117e4c72e6&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;http://localhost:60100/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBEQT09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--940badfc5aee704ef3f98085f87f909baf870660/monaco.ttf-master.zip&amp;quot;}\&quot; data-trix-content-type=\&quot;application/zip\&quot; class=\&quot;attachment attachment--content attachment--zip\&quot;&gt;&lt;figure class=\&quot;attachment attachment--file attachment--zip\&quot;&gt;\r\n\r\n  &lt;figcaption class=\&quot;attachment__caption\&quot;&gt;\r\n      &lt;span class=\&quot;attachment__name\&quot;&gt;monaco.ttf-master.zip&lt;/span&gt;\r\n      &lt;span class=\&quot;attachment__size\&quot;&gt;86.9 KB&lt;/span&gt;\r\n  &lt;/figcaption&gt;\r\n&lt;/figure&gt;\r\n&lt;figcaption class=\&quot;attachment__caption\&quot;&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/div&gt;&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>LÃ m Ä‘áº¹p nÃ³ chÃºt</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><div tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/posts/new</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">http://localhost:60100/posts/new</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Hello world</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">br</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">data-trix-attachment</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">...</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">data-trix-content-type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">application/zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment attachment--content attachment--zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment attachment--file attachment--zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__caption</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__name</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">monaco.ttf-master.zip</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__size</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">86.9 KB</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__caption</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ³ thá»ƒ tháº¥y nÃ³ khÃ¡ giá»‘ng vá»›i content cá»§a <code>&lt;trix-editor&gt;&lt;/trix-editor&gt;</code> Ä‘Ãºng khÃ´ng nÃ o?</p><p>Ta sáº½ save Ä‘á»‘ng params nÃ y láº¡i, vÃ  xem DB ta chá»©a gÃ¬?</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><div tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">app_development</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># SELECT body FROM action_text_rich_texts WHERE id = 3;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><div tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/posts/new</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">http://localhost:60100/posts/new</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Hello world</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">br</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">action-text-attachment</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">sgid</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">BAh7CEkiCGdpZAY6BkVUSSIvZ2lkOi8vYXBwL0FjdGl2ZVN0b3JhZ2U6OkJsb2IvNz9leHBpcmVzX2luBjsAVEkiDHB1cnBvc2UGOwBUSSIPYXR0YWNoYWJsZQY7AFRJIg9leHBpcmVzX2F0BjsAVDA=--97b885c24fd3d87464525f34a7b6ea117e4c72e6</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">content-type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">application/zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">url</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBEQT09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--940badfc5aee704ef3f98085f87f909baf870660/monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">filename</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">filesize</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">88996</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">action-text-attachment</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ¡c tháº» khÃ¡c thÃ¬ váº«n váº­y, tuy nhiÃªn attachments cá»§a ta láº¡i cÃ³ má»™t chÃºt khÃ¡c biá»‡t. á» Ä‘Ã¢y Ä‘á»‘ng <code>figure</code> Ä‘Ã£ Ä‘Æ°á»£c minify láº¡i thÃ nh <code>action-text-attachment </code> Ä‘á»ƒ cho gá»n hÆ¡n.</p><p>HÃ£y cÃ¹ng Ä‘iá»u tra xem táº¡i sao láº¡i nhÆ° váº­y? TrÆ°á»›c tiÃªn ta vÃ o xem <code>ActionText::RichText</code> cá»§a ta chá»©a gÃ¬ ma giÃ¡o</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/027085a5972a798cfea60f829a9edabbd67a2818/actiontext/app/models/action_text/rich_text.rb#L11</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ActionText::RichText &lt; ActiveRecord::Base</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  serialize :body, ActionText::Content</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Váº­y lÃ  <code>body</code> cá»§a ta Ä‘ang Ä‘Æ°á»£c serialize bá»Ÿi <code>ActionText::Content</code>, mÃ² Ä‘áº¿n Ä‘Ã³ tiáº¿p thÃ´i.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/df8ee09ce71338cdf9816225df1bdebc707f3560/actiontext/lib/action_text/content.rb#L15</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ActionText::Content</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class &lt;&lt; self</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fragment_by_canonicalizing_content(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment = ActionText::Attachment.fragment_by_canonicalizing_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment = ActionText::AttachmentGallery.fragment_by_canonicalizing_attachment_galleries(fragment)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def initialize(content = nil, options = {})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    options.with_defaults! canonicalize: true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if options[:canonicalize]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      @fragment = self.class.fragment_by_canonicalizing_content(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      @fragment = ActionText::Fragment.wrap(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Ta sáº½ quan tÃ¢m tá»›i hÃ m <code>initialize</code> trÆ°á»›c, khi serialize, máº·c Ä‘á»‹nh lÃ  ta Ä‘ang khÃ´ng dÃ¹ng tham sá»‘, váº­y lÃ  options sá»­ dá»¥ng sáº½ lÃ  <code>canonicalize: true</code>, xem tiáº¿p <code>fragment_by_canonicalizing_content</code> nÃ o. CÃ³ váº» láº¡i pháº£i mÃ² <code>fragment_by_canonicalizing_attachments</code> tiáº¿p @@</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/df8ee09ce7/actiontext/lib/action_text/attachment.rb#L11</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ActionText::Attachment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  TAG_NAME = &quot;action-text-attachment&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  SELECTOR = TAG_NAME</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class &lt;&lt; self</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fragment_by_canonicalizing_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      fragment_by_minifying_attachments(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fragment_by_converting_trix_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>fragment_by_minifying_attachments</code>, báº¡n cÃ³ tháº¥y tá»« minify khÃ´ng? CÃ³ váº» ta Ä‘ang Ä‘i Ä‘Ãºng hÆ°á»›ng. HÃ£y tiáº¿p tá»¥c, nhÆ°ng hÃ£y báº¯t Ä‘áº§u báº±ng <code>fragment_by_converting_trix_attachments</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/df8ee09ce71338cdf9816225df1bdebc707f3560/actiontext/lib/action_text/attachments/trix_conversion.rb#L9</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module ActionText::Attachments::TrixConversion</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class_methods do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fragment_by_converting_trix_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Fragment.wrap(content).replace(TrixAttachment::SELECTOR) do |node|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        from_trix_attachment(TrixAttachment.new(node))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>NÃ´m na lÃ  Ä‘oáº¡n nÃ y sáº½ replace toÃ n bá»™ <code>ActionText::TrixAttachment::SELECTOR = &quot;[data-trix-attachment]</code> báº±ng tháº» <code>ActionText::Attachment::SELECTOR = &quot;action-text-attachment&quot;</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module ActionText::Attachments::Minification</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  class_methods do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    def fragment_by_minifying_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Fragment.wrap(content).replace(ActionText::Attachment::SELECTOR) do |node|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node.tap { |n| n.inner_html = &quot;&quot; }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>HÃ m <code>fragment_by_minifying_attachments</code> cá»§a chÃºng ta sáº½ remove toÃ n bá»™ inner content cá»§a tháº» <code>action-text-attachment</code>.</p><p>Sau má»™t há»“i lÃ²ng vÃ²ng, cuá»‘i cÃ¹ng ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c táº¡i sao Ä‘á»‘ng <code>figure</code> rá»‘i ráº¯m kia trá»Ÿ thÃ nh <code>action-text-attachment</code> gá»n gÃ ng hÆ¡n ráº¥t nhiá»u.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="hiá»ƒn-thá»‹-dá»¯-liá»‡u"></a>Hiá»ƒn thá»‹ dá»¯ liá»‡u<a class="hash-link" href="#hiá»ƒn-thá»‹-dá»¯-liá»‡u" title="Direct link to heading">#</a></h2><p>HÃ£y vÃ o mÃ n hÃ¬nh detail, vÃ  thá»­ inspect element, ta sáº½ tháº¥y attachment cá»§a ta láº¡i trá»Ÿ vá» dáº¡ng Ä‘áº§y Ä‘á»§:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;%= @post.content =&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ÄÃ¢y lÃ  nhá»¯ng gÃ¬ ta thu Ä‘Æ°á»£c.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><div tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">trix-content</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/posts/new</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">http://localhost:60100/posts/new</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">a</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Hello world</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">br</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">strong</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">action-text-attachment</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">sgid</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">BAh7CEkiCGdpZAY6BkVUSSIvZ2lkOi8vYXBwL0FjdGl2ZVN0b3JhZ2U6OkJsb2IvNz9leHBpcmVzX2luBjsAVEkiDHB1cnBvc2UGOwBUSSIPYXR0YWNoYWJsZQY7AFRJIg9leHBpcmVzX2F0BjsAVDA=--97b885c24fd3d87464525f34a7b6ea117e4c72e6</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">content-type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">application/zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">url</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">http://localhost:60100/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBEQT09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--940badfc5aee704ef3f98085f87f909baf870660/monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">filename</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">monaco.ttf-master.zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">      </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">filesize</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">88996</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token tag" style="color:rgb(255, 85, 114)">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment attachment--file attachment--zip</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__caption</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__name</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">monaco.ttf-master.zip</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">attachment__size</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">86.9 KB</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figcaption</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">figure</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">action-text-attachment</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Báº¡n cÃ²n nhá»› mÃ¬nh ghi á»Ÿ trÃªn, khi ta viáº¿t <code>@post.content</code>, thá»±c cháº¥t ta Ä‘ang gá»i <code>@post.content.to_s</code> chá»©?</p><p>Thá»­ Ä‘Ã o sÃ¢u vÃ o chÃºt:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/df8ee09ce7/actiontext/lib/action_text/content.rb#L90</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def to_rendered_html_with_layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  renderer.render(partial: &quot;action_text/content/layout&quot;, locals: { content: self })</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def to_s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  to_rendered_html_with_layout</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly erb"><div tabindex="0" class="prism-code language-erb codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;%# https://github.com/rails/rails/blob/df8ee09ce7/actiontext/app/views/action_text/content/_layout.html.erb %&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;div class=&quot;trix-content&quot;&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &lt;%= render_action_text_content(content) %&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;/div&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/0ec2a907545e47f816993b9fd8cabb552454b1a2/actiontext/app/helpers/action_text/content_helper.rb#L12</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def render_action_text_content(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sanitize_action_text_content(render_action_text_attachments(content))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def sanitize_action_text_content(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sanitizer.sanitize(content.to_html, tags: allowed_tags, attributes: allowed_attributes, scrubber: scrubber).html_safe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def render_action_text_attachments(content)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  content.render_attachments do |attachment|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    unless attachment.in?(content.gallery_attachments)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      attachment.node.tap do |node|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        node.inner_html = render(attachment, in_gallery: false).chomp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end.render_attachment_galleries do |attachment_gallery|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    render(layout: attachment_gallery, object: attachment_gallery) do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      attachment_gallery.attachments.map do |attachment|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        attachment.node.inner_html = render(attachment, in_gallery: true).chomp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        attachment.to_html</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end.join(&quot;&quot;).html_safe</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end.chomp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Äáº¡i khÃ¡i lÃ  Rails sáº½ sanitize Ä‘á»‘ng rich text cá»§a ta Ä‘á»ƒ trÃ¡nh XSS attack, vÃ  render template Ä‘á»‘i vá»›i nhá»¯ng attachment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="integrate-vá»›i-active-storage"></a>Integrate vá»›i Active Storage<a class="hash-link" href="#integrate-vá»›i-active-storage" title="Direct link to heading">#</a></h2><p>HÃ£y quay trá»Ÿ láº¡i vá»›i model <code>ActionText::RichText</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/df8ee09ce7/actiontext/app/models/action_text/rich_text.rb#L14</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">class ActionText::RichText &lt; ActiveRecord::Base</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  has_many_attached :embeds</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  before_save do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    self.embeds = body.attachments.map(&amp;:attachable) if body.present?</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Ta dá»… dÃ ng hiá»ƒu 1 cÃ¡ch tá»•ng quan lÃ  Rails sáº½ tiáº¿n hÃ nh extract toÃ n bá»™ attachment trong body, gÃ¡n vÃ o embeds. Sau Ä‘Ã³ sáº½ save Ä‘á»‘ng association nÃ y láº¡i.</p><p>Thá»­ xem Rails sáº½ extract attachments ra lÃ m sao.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/027085a5972a798cfea60f829a9edabbd67a2818/actiontext/lib/action_text/content.rb#L53</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def attachables</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @attachables ||= attachment_nodes.map do |node|</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ActionText::Attachable.from_node(node)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/027085a5972a798cfea60f829a9edabbd67a2818/actiontext/lib/action_text/content.rb#L113</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def attachment_nodes</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @attachment_nodes ||= fragment.find_all(ActionText::Attachment::SELECTOR)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Rails sáº½ tÃ¬m kiáº¿m táº¥t cáº£ tháº» <code>action-text-attachment</code>, extract nhá»¯ng thÃ´ng tin cáº§n thiáº¿t Ä‘á»ƒ init Ä‘Æ°á»£c <code>ActiveStorage::Blob</code> object.</p><p>Ta cáº§n nghÃ­a qua hÃ m <code>Attachable.from_node</code> ná»¯a</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/027085a5972a798cfea60f829a9edabbd67a2818/actiontext/lib/action_text/attachable.rb#L10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def from_node(node)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  if attachable = attachable_from_sgid(node[&quot;sgid&quot;])</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attachable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  elsif attachable = ActionText::Attachables::ContentAttachment.from_node(node)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attachable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  elsif attachable = ActionText::Attachables::RemoteImage.from_node(node)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    attachable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ActionText::Attachables::MissingAttachable</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Trong trÆ°á»ng há»£p nÃ y, Rails sáº½ luÃ´n extract theo strategy lÃ  <code>sgid</code>, cÃ¡c báº¡n khÃ´ng cáº§n quan tÃ¢m tá»›i 3 nhÃ¡nh dÆ°á»›i lÃ m gÃ¬ cho máº¥t cÃ´ng.</p><p>CÃ²n nhá»› pháº§n trÃªn mÃ¬nh Ä‘Ã£ Ä‘á» cáº­p tá»›i <code>sgid</code> chá»©?</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//github.com/rails/rails/blob/cc1a5d5620c4cd952b27f6c1bbd16d8780a34d0e/actiontext/app/javascript/actiontext/attachment_upload.js#L26</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">https</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">attachment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setAttributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  sgid</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">attachable_sgid</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  url</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createBlobUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">signed_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> attributes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filename</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Callback nÃ y Ä‘Æ°á»£c gá»i sau khi file Ä‘Æ°á»£c upload thÃ nh cÃ´ng. Váº­y <code>sgid</code> lÃ  cÃ¡i gÃ¬?</p><p><code>sigd</code> Ä‘Æ°á»£c encrypt tá»« <code>id</code> cá»§a attachment sau khi upload. Khi gá»­i lÃªn, server sáº½ decrypt nÃ³ Ä‘á»ƒ láº¥y láº¡i <code>id</code>, gÃ¡n attachment vÃ o record.</p><p>Táº¡i sao láº¡i cáº§n encrypt? CÃ¡c báº¡n cá»© tÆ°á»Ÿng tÆ°á»£ng, náº¿u dÃ¹ng tháº³ng id, do ta upload áº£nh trÆ°á»›c khi táº¡o record, nÃªn khi gá»­i params tá»« client lÃªn, cháº¯c cháº¯n sáº½ pháº£i Ä‘Æ°a attachment id vÃ o Ä‘á»ƒ server lÆ°u Ä‘Ãºng association. Client nÃ³ gá»­i Ä‘Ãºng thÃ¬ khÃ´ng sao, nhÆ°ng náº¿u nÃ³ gá»­i id attachment cá»§a ngÆ°á»i khÃ¡c thÃ¬ sao? Attachment Ä‘Ã³ sáº½ chuyá»ƒn chá»§ ngay láº­p tá»©c :v CÃ²n náº¿u encrypt thÃ¬ user Ä‘á»‘ mÃ  mÃ² Ä‘Æ°á»£c mÃ£ hash cá»§a attachment ngÆ°á»i khÃ¡c.</p><p><code>attachable_from_sgid(node[&quot;sgid&quot;])</code> sáº½ tráº£ vá» <code>ActiveStorage::Blob</code> object</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># https://github.com/rails/rails/blob/f1b8bb4e1f16e4029ddf05515db0c01942521116/actiontext/lib/action_text/attachable.rb#L22</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def from_attachable_sgid(sgid, options = {})</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  method = sgid.is_a?(Array) ? :locate_many_signed : :locate_signed</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  record = GlobalID::Locator.public_send(method, sgid, options.merge(for: LOCATOR_NAME))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  record || raise(ActiveRecord::RecordNotFound)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Náº¿u khÃ´ng tin, báº¡n hÃ£y thá»­ <code>rails c</code> vÃ  gá»i hÃ m:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">GlobalID::Locator.locate_signed(sgid, { for: &quot;attachable&quot; })</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="káº¿t-luáº­n"></a>Káº¿t luáº­n<a class="hash-link" href="#káº¿t-luáº­n" title="Direct link to heading">#</a></h1><p><code>Action Text</code> Ä‘Æ°á»£c thiáº¿t káº¿ khÃ¡ hay, code gá»n, táº¥t cáº£ method Ä‘á»u ráº¥t ngáº¯n, dá»… hiá»ƒu.</p><p>Do lÃ  built-in nÃªn ta cÅ©ng cháº£ cáº§n cÃ i cáº¯m gÃ¬ thÃªm má»‡t ngÆ°á»i. Náº¿u Ä‘Ã£ upgrade lÃªn Rails 6, báº¡n hÃ£y thá»­ tráº£i nghiá»‡m nÃ³ xem.</p><p>CÃ²n Ä‘á»‘i vá»›i phiÃªn báº£n tháº¥p hÆ¡n, ta cÅ©ng cÃ³ thá»ƒ Ã¡p dá»¥ng flow cá»§a Action Text Ä‘á»ƒ build má»™t package há»— trá»£ richtext.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/action-text">action-text</a><a class="margin-horiz--sm" href="/blog/tags/ruby-on-rails">ruby-on-rails</a><a class="margin-horiz--sm" href="/blog/tags/web">web</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cung-tim-hieu-ve-railway-oriented-programming">CÃ¹ng tÃ¬m hiá»ƒu vá» Railway Oriented Programming</a></h2><div class="margin-vert--md"><time datetime="2019-03-16T00:00:00.000Z" class="blogPostDate_fNvV">March 16, 2019 Â· 8 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>Khi má»›i báº¯t Ä‘áº§u code, cÃ³ thá»ƒ chÃºng ta ráº¥t ngáº¡i handle nhá»¯ng exception mÃ  ngay cáº£ 1 hÃ m Ä‘Æ¡n giáº£n nháº¥t cÅ©ng cÃ³ thá»ƒ tung ra. Tuy nhiÃªn, thá»±c táº¿ khi xÃ¢y dá»±ng há»‡ thá»‘ng, ta pháº£i Ä‘áº·c biá»‡t chÃº Ã½ Ä‘áº¿n nhá»¯ng exception, khÃ´ng thÃ¬ á»©ng dá»¥ng cá»§a ta cÃ³ thá»ƒ thÄƒng báº¥t cá»© lÃºc nÃ o :v</p><p>Váº­y thÃ¬ lÃ m sao Ä‘á»ƒ handle chÃºng 1 cÃ¡ch tháº­t <em>clean</em>. CÃ³ khÃ¡ nhiá»u hÆ°á»›ng tiáº¿p cáº­n, tuy nhiÃªn ta hÃ£y cÃ¹ng thá»­ tráº£i nghiá»‡m theo hÆ°á»›ng <em>Railway Oriented</em> xem nÃ³ cÃ³ gÃ¬ hay.</p><p>BÃ i giá»›i thiá»‡u gá»‘c Ä‘Æ°á»£c viáº¿t sá»­ dá»¥ng ngÃ´n ngá»¯ F#, nhÆ°ng ta hoÃ n toÃ n cÃ³ thá»ƒ Ã¡p dá»¥ng vÃ o cÃ¡c ngÃ´n ngá»¯ khÃ¡c nhÆ° Javascript, Ruby, ...</p><p><em>Railway Oriented Programming</em> phÃ¹ há»£p vá»›i style láº­p trÃ¬nh hÃ m (Functional Programming - FP)</p><p>TÃªn gá»i lÃ  <em>Railway</em> cÅ©ng bá»Ÿi trÃ´ng nÃ³ khÃ¡ giá»‘ng vá»›i Ä‘Æ°á»ng ray tÃ u há»a.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="váº¥n-Ä‘á»"></a>Váº¥n Ä‘á»<a class="hash-link" href="#váº¥n-Ä‘á»" title="Direct link to heading">#</a></h1><p>HÃ£y báº¯t Ä‘áº§u vá»›i 1 usecase ráº¥t cÆ¡ báº£n</p><blockquote><p>NgÆ°á»i dÃ¹ng muá»‘n cáº­p nháº­t profile cá»§a há».</p></blockquote><p>Sau khi ngÆ°á»i dÃ¹ng submit thÃ´ng tin á»Ÿ web, ta hay cÃ¹ng phÃ¢n tÃ­ch nhá»¯ng xá»­ lÃ½ á»Ÿ phÃ­a server</p><p><img src="https://images.viblo.asia/e37fd6b1-91fc-4340-8938-154196463a70.jpg"></p><p>TÃ¬nh huá»‘ng Ä‘áº¹p nháº¥t xáº£y ra lÃ  tá»« bÆ°á»›c 1-5, á»©ng dá»¥ng ta sáº½ cháº¡y trÆ¡n tru, khÃ´ng cÃ³ báº¥t cá»© 1 lá»—i nÃ o.</p><p>NhÆ°ng mÃ  ...</p><blockquote><p>Äá»i khÃ´ng nhÆ° mÆ¡, tÃ¬nh khÃ´ng nhÆ° thÆ¡.</p></blockquote><p>Tá»« bÆ°á»›c 1-4 Ä‘á»u cÃ³ thá»ƒ cÃ³ lá»—i xáº£y ra, vÃ  táº¥t nhiÃªn ngÆ°á»i dÃ¹ng sáº½ khÃ´ng há» muá»‘n nhÃ¬n tháº¥y cáº£nh nÃ y</p><p><img src="https://images.viblo.asia/e05c2f5c-ee9e-4f78-958d-bd54ff7b291c.jpg"></p><p>Váº­y thÃ¬ nhá»¯ng gÃ¬ ta cáº§n lÃ m lÃ  xá»­ lÃ½ nhá»¯ng lá»—i nÃ y, khÃ´ng thÃ¬ ngÆ°á»i dÃ¹ng má»™t Ä‘i khÃ´ng trá»Ÿ láº¡i luÃ´n.</p><p><img src="https://images.viblo.asia/d7ea1ee4-2326-408a-be91-e361803f7f0b.jpeg"></p><p>VÃ  ta sáº½ viáº¿t code cho nÃ³:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">updateUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> request </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">receiveRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token function" style="color:rgb(130, 170, 255)">isValidRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Request is forbidden&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token function" style="color:rgb(130, 170, 255)">isValidUser</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;User information is invalid&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">saveToDatabase</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;DB error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">sendEmail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Mailer error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;OK&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Code trÃªn Ä‘Æ°á»£c viáº¿t theo style Imperative, vÃ¬ tháº¿ nÃªn ta cÃ³ thá»ƒ return báº¥t cá»© lÃºc nÃ o ta muá»‘n. Äiá»u Ä‘Ã³ lÃ m hÃ m cá»§a ta cÃ³ thá»ƒ return theo ráº¥t nhiá»u cÃ¡ch (nhiá»u kiá»ƒu response khÃ¡c nhau).</p><p><img src="https://images.viblo.asia/13ab6aca-df34-41a5-89fe-85e6b8de4523.png"></p><p>Ta sáº½ design láº¡i flow theo style FP.</p><p><img src="https://images.viblo.asia/e20339fb-142c-46a8-8d29-965f6ebcf63f.png"></p><p>HÃ m cá»§a ta giá» Ä‘Ã¢y:</p><ul><li><p>Chá»‰ cÃ³ 2 kiá»ƒu tráº£ vá»: <code>Success</code> hoáº·c <code>Failure</code>.</p><ul><li><p>Success:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// @flow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type </span><span class="token maybe-class-name">Success</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> object </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Failure:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// @flow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type </span><span class="token maybe-class-name">Failure</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> string </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul></li><li><p>Use case Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« 1 series cÃ¡c hÃ m con tÆ°Æ¡ng á»©ng vá»›i má»—i step.</p></li></ul><p>Ta sáº½ Ã¡p dá»¥ng <em>Railway Oriented Programming</em> Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="railway-oriented-programming"></a>Railway Oriented Programming<a class="hash-link" href="#railway-oriented-programming" title="Direct link to heading">#</a></h1><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="monad"></a>Monad<a class="hash-link" href="#monad" title="Direct link to heading">#</a></h4><p>Trong láº­p trÃ¬nh hÃ m, cÃ³ má»™t cÃ¡ch Ä‘á»ƒ handle lá»—i lÃ  dÃ¹ng <em>monad</em>.</p><p>Monad thÆ°á»ng Ä‘i kÃ¨m vá»›i Applicative vÃ  Functor ná»¯a, bá»n nÃ y khÃ¡ lÃ  xoáº¯n nÃ£o nÃªn mÃ¬nh sáº½ khÃ´ng Ä‘á» cáº­p á»Ÿ Ä‘Ã¢y.</p><p>Ta sáº½ chá»‰ quan tÃ¢m tá»›i: <em>Either</em> monad.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// @flow</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type </span><span class="token maybe-class-name">Either</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token constant" style="color:rgb(130, 170, 255)">A</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">B</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">A</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">B</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">type </span><span class="token maybe-class-name">FunctionReturnMonad</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token constant" style="color:rgb(130, 170, 255)">A</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">B</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">Either</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token constant" style="color:rgb(130, 170, 255)">A</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">B</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Hiá»ƒu má»™t cÃ¡ch nÃ´m na sáº½ lÃ : hÃ m cá»§a ta sáº½ luÃ´n tráº£ vá» A hoáº·c B, nhÆ°ng khÃ´ng bao giá» tráº£ vá» cáº£ 2.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="switch"></a>Switch<a class="hash-link" href="#switch" title="Direct link to heading">#</a></h4><p>HÃ£y báº¯t Ä‘áº§u vá»›i 1 function cÃ³ thá»ƒ gÃ¢y ra lá»—i:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">validateNameNotBlank</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Name is blank&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> user </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><img src="https://images.viblo.asia/4214182b-82ca-4ff1-9f86-7161b063632d.jpg"></p><p>ÄÃ¢y chÃ­nh lÃ  1 switch, nÃ³ ráº½ nhÃ¡nh luá»“ng xá»­ lÃ½ cá»§a ta thÃ nh <code>Success</code> vÃ  <code>Failure</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="káº¿t-ná»‘i-nhiá»u-switch"></a>Káº¿t ná»‘i nhiá»u switch<a class="hash-link" href="#káº¿t-ná»‘i-nhiá»u-switch" title="Direct link to heading">#</a></h4><p><img src="https://images.viblo.asia/b6cf8618-c07c-4502-86a3-90b1b6ab3530.png"></p><p>ÄÃ¢y lÃ  <em>Ä‘Æ°á»ng ray</em> hoÃ n chá»‰nh mÃ  ta cáº§n xÃ¢y dá»±ng tá»« nhá»¯ng switch riÃªng láº» trÃªn.</p><p>CÃ³ thá»ƒ nháº­n tháº¥y má»™t vÃ i Ä‘iá»ƒm quan trá»ng á»Ÿ railway nÃ y:</p><ul><li><p>Khi má»™t step bá»‹ lá»—i, nÃ³ sáº½ khÃ´ng return function ngay láº­p tá»©c, mÃ  sáº½ tiáº¿p tá»¥c cháº¡y vÃ o cÃ¡c function tiáº¿p theo cho tá»›i khi káº¿t thÃºc flow.</p><p>Tuy nhiÃªn káº¿t quáº£ cuá»‘i cÃ¹ng nháº­n Ä‘Æ°á»£c chá»‰ lÃ  lá»—i Ä‘áº§u tiÃªn phÃ¡t sinh.</p></li><li><p>Nhá»¯ng hÃ m cá»§a tá»«ng step Ä‘á»u pháº£i xá»­ lÃ½ cáº£ trÆ°á»ng há»£p cÃ³ dá»¯ liá»‡u vÃ  trÆ°á»ng há»£p hÃ m trÆ°á»›c tráº£ vá» lá»—i</p></li></ul><p>BÃ¢y giá» váº¥n Ä‘á» lÃ  lÃ m tháº¿ nÃ o Ä‘á»ƒ ná»‘i nhá»¯ng switch láº¡i vá»›i nhau?</p><p>CÃ¢u tráº£ lá»i lÃ  <code>compose</code>. Tuy nhiÃªn ta khÃ´ng thá»ƒ compose theo cÃ¡ch thÃ´ng thÆ°á»ng Ä‘Æ°á»£c.</p><p>VÃ­ dá»¥ nhÆ°:</p><p>Náº¿u Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra cá»§a ta cÃ¹ng interface</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">mul2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">num</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> num </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">add1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">num</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> num </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mul2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">add1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 4</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Trá»Ÿ láº¡i hÃ m <code>validateBlank</code> á»Ÿ trÃªn, náº¿u ta cÃ³ nhiá»u hÃ m <code>validate</code> khÃ¡c tÆ°Æ¡ng tá»±</p><p><img src="https://images.viblo.asia/02d95ea0-c572-481b-bb2b-d2801667e9a0.png"></p><p>Ta cÃ³ thá»ƒ tháº¥y Ä‘áº§u vÃ o chá»‰ cÃ³ 1, mÃ  láº¡i cÃ³ nhá»¯ng 2 Ä‘áº§u ra.</p><p>Äá»ƒ cÃ³ thá»ƒ compose, ta sáº½ pháº£i biáº¿n chÃºng thÃ nh nhá»¯ng function cÃ³ thá»ƒ handle cáº£ trÆ°á»ng há»£p <code>Success</code> láº«n <code>Failure</code>.</p><p>CÃ³ thá»ƒ sá»­ dá»¥ng HOC</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">transformToTwoTrackInput</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> twoTrackValidateNameNotBlank </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">transformToTwoTrackInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validateNameNotBlank</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> twoTrackValidateName50 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transformToTwoTrackInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validateName50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> twoTrackValidateEmailNotBlank </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">transformToTwoTrackInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  validateEmailNotBlank</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> user </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> email</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">twoTrackValidateEmailNotBlank</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">twoTrackValidateName50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">twoTrackValidateNameNotBlank</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> user </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// { error: &#x27;name is blank&#x27; }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>NhÆ° váº­y lÃ  ta Ä‘Ã£ káº¿t ná»‘i Ä‘Æ°á»£c nhá»¯ng máº£nh ghÃ©p trÃªn vá»›i nhau.</p><p><img src="https://images.viblo.asia/59045ab0-2465-4163-8c25-1b7529749196.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="má»™t-vÃ i-kiá»ƒu-function-thÆ°á»ng-gáº·p"></a>Má»™t vÃ i kiá»ƒu function thÆ°á»ng gáº·p<a class="hash-link" href="#má»™t-vÃ i-kiá»ƒu-function-thÆ°á»ng-gáº·p" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="single-track-function"></a>Single track function<a class="hash-link" href="#single-track-function" title="Direct link to heading">#</a></h5><p>Náº¿u má»™t function khÃ´ng gÃ¢y ra lá»—i (chá»‰ cÃ³ 1 Ä‘áº§u vÃ o vÃ  1 Ä‘áº§u ra) thÃ¬ nÃ³ sáº½ khÃ´ng thá»ƒ nÃ o compose Ä‘Æ°á»£c vÃ o railway cá»§a chÃºng ta.</p><p>Khi Ä‘Ã³ ta pháº£i wrap nÃ³ bá»Ÿi 2-track function, giá»‘ng vá»›i HOC á»Ÿ trÃªn.</p><p><img src="https://images.viblo.asia/754c4226-95b0-4b98-81dc-e64ed7842ee9.jpg"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">trimEmail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    email</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">email</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">trim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">transformSingleTrackToTwoTrackInput</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token parameter">func</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> user </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> email</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;  sample@email.com&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">transformSingleTrackToTwoTrackInput</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">trimEmail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> user </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dead-end-function"></a>Dead-end function<a class="hash-link" href="#dead-end-function" title="Direct link to heading">#</a></h5><p>Dead-end function lÃ  nhá»¯ng hÃ m void, khÃ´ng cÃ³ giÃ¡ trá»‹ tráº£ vá»</p><p><img src="https://images.viblo.asia/55f5aa49-c5c8-498f-a175-edd967b3d5c2.jpg"></p><p>MÃ u tÃ­m chÃ­nh lÃ  nÆ¡i ta sáº½ Ä‘áº·t <em>dead-end function</em> vÃ o</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">transformDeadEndFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token function" style="color:rgb(130, 170, 255)">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="function-throw-exception"></a>Function throw Exception<a class="hash-link" href="#function-throw-exception" title="Direct link to heading">#</a></h5><p>Ta cÃ³ thá»ƒ Ä‘áº·t try-catch Ä‘á»ƒ tráº£ vá» Failure</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">transformExceptionFunction</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token function" style="color:rgb(130, 170, 255)">func</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">message</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">||</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> error </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><em>Note</em>: Convert táº¥t cáº£ Exception thÃ nh <code>Failure</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="káº¿t-quáº£"></a>Káº¿t quáº£<a class="hash-link" href="#káº¿t-quáº£" title="Direct link to heading">#</a></h4><p>Ta khÃ´ng thá»ƒ tráº£ vá» dá»¯ liá»‡u kiá»ƒu two-track cho client Ä‘Æ°á»£c, vÃ¬ váº­y ta sáº½ cÃ³ thÃªm 1 bÆ°á»›c cuá»‘i Ä‘á»ƒ tráº£ vá» thÃ´ng tin cho client.</p><p><img src="https://images.viblo.asia/08650333-ae3a-4fa8-b960-09c7b11fbd79.jpg"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">returnMessage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> data</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> data </span><span class="token operator" style="color:rgb(137, 221, 255)">?</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">JSON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">stringify</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">toString</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rop-trong-má»™t-sá»‘-ngÃ´n-ngá»¯-khÃ¡c"></a>ROP trong má»™t sá»‘ ngÃ´n ngá»¯ khÃ¡c<a class="hash-link" href="#rop-trong-má»™t-sá»‘-ngÃ´n-ngá»¯-khÃ¡c" title="Direct link to heading">#</a></h1><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ruby-framework-rails"></a>Ruby (framework Rails)<a class="hash-link" href="#ruby-framework-rails" title="Direct link to heading">#</a></h4><p>Náº¿u cÃ¡c báº¡n sá»­ dá»¥ng Rails, hÃ£y thá»­ tráº£i nghiá»‡m qua gem <code>trailblazer</code>. Logic cá»§a á»©ng dá»¥ng giá» sáº½ táº­p trung chá»§ yáº¿u trong cÃ¡c <code>Operation</code> thay vÃ¬ controller nhÆ° xÆ°a ná»¯a, mÃ  nhá»¯ng operation nÃ y Ä‘Æ°á»£c viáº¿t theo style ROP.</p><p><img src="https://images.viblo.asia/f425b9c2-0d14-460b-8540-f289e8859972.gif"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">class Song::Create &lt; Trailblazer::Operation</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  step    Model(Song, :new) # init model</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  step    :assign_current_user!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  step    Contract::Build(constant: SongForm) # create form object</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  step    Contract::Validate() # validate form object</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  failure :log_error!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  step    Contract::Persist() # save song to db</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def log_error!(options)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    logger.debug &quot;Errors occurred while creating song.&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  def assign_current_user!(options)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    options[&quot;model&quot;].created_by = options[&quot;current_user&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Flow cá»§a Operation khÃ´ng hoÃ n toÃ n giá»‘ng vá»›i ROP nhÆ° ta Ä‘Ã£ tháº¥y á»Ÿ trÃªn, má»™t khi báº¡n Ä‘Ã£ vÃ o nhÃ¡nh Failure, nÃ³ sáº½ trigger toÃ n bá»™ nhá»¯ng step handle error phÃ­a sau.</p><p>KhÃ´ng liÃªn quan láº¯m nhÆ°ng trong <code>trailblazer</code> ecosystem cÃ³ khÃ¡ nhiá»u gem thÃº vá»‹ nhÆ°: <code>reform</code> (form object pattern), vÃ  <code>cells</code> (view components).</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="javascript"></a>Javascript<a class="hash-link" href="#javascript" title="Direct link to heading">#</a></h4><p>Náº¿u ta Ä‘á»ƒ Ã½, <code>Promise</code> cá»§a Javascript cÅ©ng khÃ¡ giá»‘ng vá»›i ROP.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> user </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> username</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> email</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sample&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">validatePresenceOfUsername</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">username</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Username is blank&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">validateFormatOfEmail</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">email</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">email</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">match</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">@</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">throw</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Email is in invalid format&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">logError</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Promise</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">resolve</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validatePresenceOfUsername</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">then</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">validateFormatOfEmail</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token keyword control-flow" style="font-style:italic">catch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">logError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// =&gt; &#x27;Email is in invalid format</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tham-kháº£o"></a>Tham kháº£o<a class="hash-link" href="#tham-kháº£o" title="Direct link to heading">#</a></h1><p><a href="https://fsharpforfunandprofit.com/rop/" target="_blank" rel="noopener noreferrer">https://fsharpforfunandprofit.com/rop/</a></p><p><a href="https://fsharpforfunandprofit.com/posts/function-composition/" target="_blank" rel="noopener noreferrer">https://fsharpforfunandprofit.com/posts/function-composition/</a></p><p><a href="https://dorp.io/posts/railway-oriented-programming/" target="_blank" rel="noopener noreferrer">https://dorp.io/posts/railway-oriented-programming/</a></p><p><a href="https://github.com/trailblazer/trailblazer" target="_blank" rel="noopener noreferrer">https://github.com/trailblazer/trailblazer</a></p><p><a href="http://trailblazer.to/gems/operation/2.0/api.html" target="_blank" rel="noopener noreferrer">http://trailblazer.to/gems/operation/2.0/api.html</a></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/ruby">ruby</a><a class="margin-horiz--sm" href="/blog/tags/javascript">javascript</a><a class="margin-horiz--sm" href="/blog/tags/functional-programing">functional-programing</a><a class="margin-horiz--sm" href="/blog/tags/railway-oriented-programming">railway-oriented-programming</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/mot-vai-mindset-khi-lam-viec-voi-react">Má»™t vÃ i mindset khi lÃ m viá»‡c vá»›i React</a></h2><div class="margin-vert--md"><time datetime="2019-02-16T00:00:00.000Z" class="blogPostDate_fNvV">February 16, 2019 Â· 11 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>NgÃ y nay, cÃ´ng nghá»‡ ngÃ y cÃ ng phÃ¡t triá»ƒn, vÃ  tháº¿ giá»›i Web cÅ©ng váº­y. Äa sá»‘ web hiá»‡n Ä‘áº¡i Ä‘á»u Ä‘Ã£ nÃ³i lá»i táº¡m biá»‡t vá»›i nhá»¯ng dÃ²ng Ruby, PHP, hay Java Ä‘Æ°á»£c nhÃºng trong HTML/JS. Pháº§n giao diá»‡n ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c chÃ­nh browser phÃ­a client xá»­ lÃ½, thay vÃ¬ server Ã´m háº¿t nhÆ° xÆ°a. CÃ¡c thÆ° viá»‡n/framework nhÆ° React, Angular, Vue, ... Ä‘á»u Ä‘Ã£ trá»Ÿ nÃªn quÃ¡ quen thuá»™c.</p><p>Náº¿u báº¡n cÃ³ Ã½ Ä‘á»‹nh há»c hay Ä‘Ã£ chuyá»ƒn sang React thÃ¬ mong bÃ i viáº¿t cÃ³ thá»ƒ giÃºp cÃ¡c báº¡n cÃ³ nhá»¯ng mindset tá»‘t hÆ¡n khi lÃ m viá»‡c vá»›i nÃ³.</p><p>ÄÃ¢y Ä‘á»u lÃ  nhá»¯ng thá»© mÃ¬nh cho ráº±ng cáº§n quan tÃ¢m sau 1 thá»i gian lÃ m viá»‡c vá»›i React.</p><p>BÃ i viáº¿t nÃ y khÃ´ng nÃ³i vá» viá»‡c hÆ°á»›ng dáº«n code React.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="component"></a>Component<a class="hash-link" href="#component" title="Direct link to heading">#</a></h1><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="react-is-all-about-components"></a>React is all about components<a class="hash-link" href="#react-is-all-about-components" title="Direct link to heading">#</a></h3><p>React Ä‘Æ°á»£c design theo hÆ°á»›ng Component, má»—i pháº§n tá»­ nhá» nháº¥t nhÆ° tháº» <code>&lt;span&gt;</code>, hay <code>&lt;button&gt;</code> Ä‘á»u cÃ³ thá»ƒ wrap thÃ nh má»™t component Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng 1 cÃ¡ch tá»‘i Ä‘a.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// path/to/button.jsx</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Button</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> children</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> type</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> onClick </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">button</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">button</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token tag script language-javascript template-string string" style="color:rgb(195, 232, 141)">btn btn-</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">${</span><span class="token tag script language-javascript template-string interpolation" style="color:rgb(255, 85, 114)">type</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag script language-javascript template-string template-punctuation string" style="color:rgb(195, 232, 141)">`</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)">onClick</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">button</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>VÃ  á»Ÿ Ä‘Ã¢u cáº§n component nÃ y, ta sáº½ import nÃ³ vÃ o Ä‘á»ƒ sá»­ dá»¥ng.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> Button </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./path/to/button&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">Screen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Button</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">type</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">primary</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)"> </span><span class="token tag script language-javascript operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)"> console</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token tag script language-javascript function" style="color:rgb(130, 170, 255)">log</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token tag script language-javascript string" style="color:rgb(195, 232, 141)">&quot;Clicked&quot;</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Click me</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Button</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Vá»›i nhá»¯ng ngÃ´n ngá»¯ server side truyá»n thá»‘ng, ta sáº½ viáº¿t nhÆ° sau (slim ruby):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly slim"><div tabindex="0" class="prism-code language-slim codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/ path/to/a.slim</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">button.btn.btn-primary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  | Button A</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly slim"><div tabindex="0" class="prism-code language-slim codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/ path/to/b.slim</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">button.btn.btn-primary</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  | Button B</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>CÃ³ thá»ƒ tháº¥y lÃ  code cá»§a ta trÃ´ng sÃ¡ng sá»§a hÆ¡n ráº¥t nhiá»u.</p><p>TrÃªn thá»±c táº¿, ta cÅ©ng nÃªn viáº¿t nhá»¯ng component nhá» nháº¥t cÃ³ thá»ƒ nhÆ° váº­y, nÃ³ sáº½ giÃºp giao diá»‡n app ta Ä‘á»“ng bá»™, vÃ  debug cÅ©ng trá»Ÿ nÃªn dá»… hÆ¡n.</p><p>Hay thá»­ vá»›i má»™t component phá»©c táº¡p hÆ¡n hÆ¡n xÃ­u:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">List</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token parameter"> items</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> renderItem</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> emptyText </span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">items</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">length </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">emptyText</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">span</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">items</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">item</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">renderItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">item</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cáº¥u-trÃºc-thÆ°-má»¥c"></a>Cáº¥u trÃºc thÆ° má»¥c<a class="hash-link" href="#cáº¥u-trÃºc-thÆ°-má»¥c" title="Direct link to heading">#</a></h3><p>Äá»‘i vá»›i nhá»¯ng dá»± Ã¡n lá»›n, cÃ³ má»™t cáº¥u trÃºc thÆ° má»¥c rÃµ rÃ ng sáº½ khiáº¿n viá»‡c code trá»Ÿ nÃªn dá»… chá»‹u hÆ¡n nhiá»u.</p><p>Láº¡i quay láº¡i cÃ¡c ngÃ´n ngá»¯ server side MVC cÅ© - Rails. ÄÃ¢y lÃ  má»™t cáº¥u trÃºc khÃ³ mÃ  cÃ³ thá»ƒ thay Ä‘á»•i trong táº¥t cáº£ cÃ¡c dá»± Ã¡n:</p><p><img src="https://images.viblo.asia/70c519f5-7322-4384-a76f-caae42495028.png"></p><p>DÃ¹ vá»›i sá»± há»— trá»£ cá»§a cÃ¡c Editor/IDE hiá»‡n Ä‘áº¡i trong viá»‡c tÃ¬m kiáº¿m, má»Ÿ file, thÃ¬ cÅ©ng khÃ¡ máº¥t thá»i gian Ä‘á»ƒ cÃ³ thá»ƒ tÃ¬m Ä‘Æ°á»£c nhá»¯ng file liÃªn quan.</p><p>Vá»›i React thÃ¬ flexible hÆ¡n, báº¡n cÃ³ thá»ƒ tá»• chá»©c theo kiá»ƒu trÃªn (VD cho 1 project dÃ¹ng Redux)</p><p><img src="https://images.viblo.asia/a6cd4317-a0e0-4990-bdbe-5eea297d9ced.png"></p><p>NhÆ°ng vá»›i mÃ¬nh thÃ¬ mÃ¬nh thÃ­ch cÃ¡ch tá»• chá»©c theo component/mÃ n hÃ¬nh hÆ¡n.</p><p><img src="https://images.viblo.asia/f70e763d-8744-497a-9a0c-6abcfc380195.png"></p><p>MÃ¬nh há»c Ä‘Æ°á»£c cáº¥u trÃºc trÃªn tá»« má»™t dá»± Ã¡n trong list awesome react native - <a href="https://github.com/gitpoint/git-point" target="_blank" rel="noopener noreferrer">Gitpoint</a>, dÃ¹ nÃ³ Ä‘Æ°á»£c viáº¿t báº±ng React Native nhÆ°ng báº£n cháº¥t váº«n lÃ  React nÃªn khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬ háº¿t.</p><p>Tuy nhiÃªn cáº¥u trÃºc nÃ y gáº·p 1 nhÆ°á»£c Ä‘iá»ƒm á»Ÿ chá»— náº¿u 2 mÃ n hÃ¬nh mÃ  share nhau chung 1 state (redux) thÃ¬ sáº½ gÃ¢y bá»‘i rá»‘i, hoáº·c lÃ  láº·p code. Vá»›i mÃ¬nh, mÃ¬nh chá»n giáº£i phÃ¡p táº¡o 1 thÆ° má»¥c shared, rá»“i cÅ©ng tá»• chá»©c file giá»‘ng cáº¥u trÃºc cá»§a thÆ° má»¥c <code>screens</code>. CÃ²n khÃ´ng thÃ¬ cháº¥p nháº­n viá»‡c code bá»‹ láº·p 1 chÃºt.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="functional-programming-fp"></a>Functional Programming (FP)<a class="hash-link" href="#functional-programming-fp" title="Direct link to heading">#</a></h1><p>Náº¿u nhÆ° Ruby, Java lÃ  cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh hÆ°á»›ng Ä‘á»‘i tÆ°á»£ng (OOP) thÃ¬ Javascript láº¡i mang phong cÃ¡ch láº­p trÃ¬nh hÃ m, máº·c dÃ¹ váº«n cÃ³ class, object náº¿u báº¡n muá»‘n dÃ¹ng (Prototype)</p><p>Vá»›i OOP, ta thÆ°á»ng xuyÃªn thay Ä‘á»•i tráº¡ng thÃ¡i (cÃ¡c biáº¿n instance) cá»§a object, nhÆ°ng FP láº¡i khÃ´ng thÃ­ch Ä‘iá»u nÃ y, mÃ  thÆ°á»ng hÆ°á»›ng tá»›i tÃ­nh báº¥t biáº¿n (Immutability) vÃ  pure function. Ta hÃ£y cÅ©ng tÃ¬m hiá»ƒu thÃªm vá» chÃºng</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pure-functions"></a>Pure Functions<a class="hash-link" href="#pure-functions" title="Direct link to heading">#</a></h3><p>Láº¥y vÃ­ dá»¥ vá»›i viá»‡c cá»™ng 2 sá»‘ tá»± nhiÃªn</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> z </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">x</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 3</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 4</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>HÃ m <code>add</code> nháº­n 2 tham sá»‘ <code>x</code> vÃ  <code>y</code>, nÃ³ chá»‰ sá»­ dá»¥ng 2 tham sá»‘ Ä‘áº§u vÃ o nÃ y Ä‘á»ƒ thá»±c hiá»‡n phÃ©p tÃ­nh, mÃ  khÃ´ng sá»­ dá»¥ng/lÃ m thay Ä‘á»•i cÃ¡c biáº¿n ngoÃ i pháº¡m vi hÃ m.</p><p>HÆ¡n ná»¯a nÃ³ luÃ´n tráº£ vá» cÃ¹ng 1 giÃ¡ trá»‹ náº¿u nhÆ° tham sá»‘ Ä‘áº§u vÃ o khÃ´ng thay Ä‘á»•i.</p><p>CÃ²n xem hÃ m dÆ°á»›i Ä‘Ã¢y</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> bonus </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">x</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> x </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> bonus</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 3</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 3</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>DÃ¹ luÃ´n tráº£ vá» má»™t giÃ¡ trá»‹ vá»›i cÃ¹ng tham sá»‘, tuy nhiÃªn hÃ m láº¡i phá»¥ thuá»™c vÃ o biáº¿n <code>bonus</code> (external variable) nÃªn Ä‘Ã¢y Ä‘Æ°á»£c xem lÃ  1 impure function.</p><p>NgoÃ i ra impure function cÅ©ng gÃ¢y ra cÃ¡c side effects nhÆ° cÃ¡c hÃ m sau:</p><ul><li>Gá»i HTTP request</li><li>Ghi dá»¯ liá»‡u</li><li><code>Math.random()</code>, <code>new Date()</code></li><li>....</li></ul><p>GiÃ¡ trá»‹ tráº£ vá» cá»§a chÃºng khÃ´ng pháº£i lÃºc nÃ o cÅ©ng giá»‘ng nhau, Ä‘iá»u Ä‘Ã³ khiáº¿n káº¿t quáº£ cá»§a hÃ m khÃ³ mÃ  lÆ°á»ng trÆ°á»›c Ä‘Æ°á»£c, khi test ta thÆ°á»ng pháº£i mock 1 giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh.</p><p>Pure function sáº½ giÃºp app chÃºng ta Ã­t lá»—i hÆ¡n, ngoÃ i ra cÅ©ng dá»… dÃ ng test hÆ¡n.</p><p>Trong React, nÃ³i Ä‘áº¿n pure function ta thÆ°á»ng nghÄ© Ä‘áº¿n stateless component - Functional Component, nÃ³ sáº½ chá»‰ sá»­ dá»¥ng props Ä‘á»ƒ tÃ­nh toÃ¡n vÃ  render dá»±a trÃªn nhá»¯ng props Ä‘Ã³. Tuy nhiÃªn nhá»¯ng update gáº§n Ä‘Ã¢y Ä‘Ã£ thÃªm <a href="https://reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener noreferrer">Hook</a>, nÃ³ lÃ m cho Functional Component cÅ©ng cÃ³ thá»ƒ cÃ³ state. CÃ¡ nhÃ¢n mÃ¬nh khÃ´ng thÃ­ch cÃ¡i Hook nÃ y láº¯m.</p><p>NhÆ°ng app cá»§a ta khÃ´ng chá»‰ toÃ n pure function Ä‘Æ°á»£c, sáº½ pháº£i cÃ³ nhá»¯ng hÃ m gá»i API, thay Ä‘á»•i state, láº¥y state Ä‘á»ƒ tÃ­nh toÃ¡n, lÆ°u dá»¯ liá»‡u vÃ o localStorage, ... nhÆ°ng hÃ£y cá»‘ gáº¯ng giáº£m thiá»ƒu sá»‘ lÆ°á»£ng side effects xuá»‘ng tháº¥p nháº¥t cÃ³ thá»ƒ.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="immutability"></a>Immutability<a class="hash-link" href="#immutability" title="Direct link to heading">#</a></h3><p>Má»™t Ä‘iá»u quan trá»ng ná»¯a lÃ  tÃ­nh báº¥t biáº¿n.</p><p>Functional programming nÃ³i chung vÃ  React nÃ³i riÃªng, ta thÆ°á»ng trÃ¡nh viá»‡c sá»­a trá»±c tiáº¿p 1 biáº¿n nÃ o Ä‘Ã³, hay state. Thay vÃ o Ä‘Ã³, ta sáº½ táº¡o 1 biáº¿n má»›i.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> person </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  age</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> array </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Náº¿u trong dá»± Ã¡n cá»§a báº¡n cÃ³ nhá»¯ng dÃ²ng code nhÆ° trÃªn, thÃ¬ code báº¡n Ä‘Ã£ máº¥t tÃ­nh báº¥t biáº¿n.
Thay vÃ¬ trá»±c tiáº¿p chá»‰nh sá»­a 1 biáº¿n nhÆ° váº­y. Ta nÃªn táº¡o 1 biáº¿n má»›i vá»›i nhá»¯ng giÃ¡ trá»‹ cÅ©, sau Ä‘Ã³ thÃªm giÃ¡ trá»‹ má»›i vÃ o.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> updatedPerson </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  age</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">age</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// hay</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> updatedPerson </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token plain">person</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Dá»… dÃ ng nháº­n tháº¥y <code>updatedPerson.age</code> váº«n tham chiáº¿u Ä‘áº¿n giÃ¡ trá»‹ cÅ© cá»§a <code>person.name</code>, tuy nhiÃªn ta sá»­ dá»¥ng biáº¿n <code>updatedPerson</code> nÃ y tháº¿ nÃ o Ä‘i ná»¯a, thÃ¬ cÅ©ng sáº½ khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n giÃ¡ trá»‹ cá»§a <code>person</code></p><p>NhÆ°ng táº¡i sao láº¡i pháº£i lÃ m váº­y? Thá»­ xÃ©t 1 vÃ²ng láº·p Ä‘Æ¡n giáº£n nhÆ°:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> s </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> index</span><span class="token operator" style="color:rgb(137, 221, 255)">++</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  s </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Giáº£ sá»­ Ä‘ang trong quÃ¡ trÃ¬nh láº·p, thi <code>data[n]</code> bá»‹ thay Ä‘á»•i, cháº³ng pháº£i <code>s += data[index]</code> sáº½ sai luÃ´n hay sao.</p><p>CÃ²n trong React, ta cÃ³ <code>React.PureComponent</code> nÃ³ sáº½ shallow compare props vÃ  state Ä‘á»ƒ quyáº¿t Ä‘á»‹nh xem cÃ³ update component hay khÃ´ng.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">export</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">SampleComponent</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">React</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">PureComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  state </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    filter</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;A name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      age</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">21</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//  shouldComponentUpdate(nextProps, nextState) {</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//      return shallowCompare(this, nextProps, nextState)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//    }</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">handleClick</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;New name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">h3</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">h3</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">button</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag script language-javascript keyword" style="color:rgb(255, 85, 114);font-style:italic">this</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token tag script language-javascript" style="color:rgb(255, 85, 114)">handleClick</span><span class="token tag script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Click me</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">button</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><code>React.PureComponent</code> Ä‘Ã£ Ä‘á»‹nh nghÄ©a sáºµn cho ta phÆ°Æ¡ng thá»©c <code>shouldComponentUpdate</code> nhÆ° pháº§n mÃ¬nh comment.</p><p>HÃ m <code>shallowCompare</code> chá»‰ Ä‘Æ¡n thuáº§n láº·p táº¥t cáº£ cÃ¡c key cÃ³ trong props vÃ  state, so sÃ¡nh vá»›i state/props cÅ©.</p><p>NÃ³ sáº½ thá»±c hiá»‡n viá»‡c so sÃ¡nh <code>currentState.filter === nextState.filter</code> (so sÃ¡nh báº±ng tham chiáº¿u).</p><p>Viá»‡c nÃ y cÃ³ lá»£i hÆ¡n ráº¥t nhiá»u so vá»›i viá»‡c deep compare táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ trong filter (cáº£ vá» thá»i gian láº«n Ä‘á»™ phá»©c táº¡p).</p><p>Tuy nhiÃªn, khi chÃºng ta trá»±c tiáº¿p chá»‰nh sá»­a <code>this.state.filter.name = &#x27;New name&#x27;</code>, sáº½ khiáº¿n filter khÃ´ng há» thay Ä‘á»•i vá» tham chiáº¿u. Khi Ä‘Ã³:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">currentState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filter</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// true</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">currentState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">===</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// false</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>vÃ  <code>SampleComponent</code> cá»§a ta cÅ©ng sáº½ khÃ´ng re-render, cho dÃ¹ báº¡n cÃ³ click Ä‘áº¿n sang nÄƒm.</p><p><img src="https://images.viblo.asia/ecee315c-f2a5-4eb6-a290-af2c100a8724.png"></p><p>Thay vÃ o Ä‘Ã³ ta sáº½ lÃ m nhÆ° sau</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function-variable function" style="color:rgb(130, 170, 255)">handleClick</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">setState</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> filter</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(137, 221, 255)">...</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">filter</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;New name&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Ta copy toÃ n bá»™ tham chiáº¿u cÃ¡c attribute cá»§a <code>state.filter</code> cÅ© sang 1 object má»›i, vÃ  sau Ä‘Ã³ thay Ä‘á»•i biáº¿n <code>name</code> cá»§a object má»›i nÃ y, ta khÃ´ng há» lÃ m thay Ä‘á»•i <code>state.filter</code> cÅ©.</p><p>Khi Ä‘Ã³ <code>currentState.filter === nextState.filter</code> sáº½ tráº£ vá» <code>false</code>. <code>SampleComponent</code> cá»§a ta Ä‘Æ°á»£c re-render láº¡i. VÃ  náº¿u cÃ³ action nÃ o khÃ´ng lÃ m thay Ä‘á»•i <code>state</code>, component cá»§a ta cÅ©ng sáº½ khÃ´ng re-render. Váº­y lÃ  cáº£ React vÃ  ta Ä‘á»u happy - <em>má»™t ngÆ°á»i khá»e, 2 ngÆ°á»i vui :v</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="higher-order-functions-hof"></a>Higher-Order Functions (HOF)<a class="hash-link" href="#higher-order-functions-hof" title="Direct link to heading">#</a></h3><blockquote><p>HOF nháº­n tham sá»‘ lÃ  hÃ m, hoáº·c tráº£ vá» má»™t hÃ m khÃ¡c, hoáº·c lÃ  cáº£ 2.</p></blockquote><p>VD 1 hÃ m nháº­n tham sá»‘ hÃ m:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;React&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> phoneNumber </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0969696969&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">numberValidator</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">match</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\d+</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(130, 170, 255)">validate</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">value</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> validator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token function" style="color:rgb(130, 170, 255)">validator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">validate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> numberValidator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">validate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">phoneNumber</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> numberValidator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// false</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Hay 1 hÃ m tráº£ vá» 1 hÃ m:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">makeAdder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">constantValue</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">adder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword control-flow" style="font-style:italic">return</span><span class="token plain"> constantValue </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>ta gá»i hÃ m nÃ y nhÆ° sau: <code>makeAdder(10)(20)</code></p><p>Thoáº¡t nhÃ¬n cÃ³ váº» sá»£, nhÆ°ng náº¿u viáº¿t minh báº¡ch ra</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> add10 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">makeAdder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 30</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Má»i thá»© trá»Ÿ nÃªn rÃµ rÃ ng hÆ¡n nhiá»u, <code>makerAdder(10)</code> tráº£ vá» má»™t hÃ m, sau Ä‘Ã³ ta gá»i hÃ m nÃ y vá»›i tham sá»‘ lÃ  20</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> add10 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">makeAdder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// add10 = function adder(value) {</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//   return 10 + value</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// }</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">add10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Trong React, ta cÅ©ng thÆ°á»ng xuyÃªn Ã¡p dá»¥ng ká»¹ thuáº­t nÃ y, tuy nhiÃªn ngoÃ i HOF, thÃ¬ ta cÃ²n cÃ³ Higher-Order Component (HOC), nháº±m chá»‰ nhá»¯ng hÃ m nháº­n vÃ o tham sá»‘ lÃ  1 Component vÃ  tráº£ vá» 1 Component khÃ¡c.</p><p>VD:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">protectRoute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">Component</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> requiredRole</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">ProtectedRoute</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> currentRole </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> localStorage</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">getItem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;role&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">currentRole </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> requiredRole</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Redirect</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag attr-name" style="color:rgb(255, 203, 107)">to</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(255, 85, 114)">/sign_in</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Component</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag spread punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token tag spread punctuation" style="color:rgb(199, 146, 234)">...</span><span class="token tag spread attr-value" style="color:rgb(255, 85, 114)">props</span><span class="token tag spread punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token tag" style="color:rgb(255, 85, 114)"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">/&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="declarative-programming"></a>Declarative Programming<a class="hash-link" href="#declarative-programming" title="Direct link to heading">#</a></h3><p>Ta cÃ³ 2 thiÃªn hÆ°á»›ng láº­p trÃ¬nh Ä‘á»‘i láº­p nhau, Ä‘Ã³ lÃ :</p><ul><li>Imperative Programming: mÃ´ táº£ control flow cá»§a viá»‡c cáº§n lÃ m</li><li>Declarative Programming: chá»‰ viáº¿t ra nhá»¯ng gÃ¬ cáº§n lÃ m mÃ  khÃ´ng mÃ´ táº£ rÃµ control flow cá»§a tá»«ng bÆ°á»›c.</li></ul><p>VD tiÃªu biá»ƒu Ä‘Ã³ lÃ  1 vÃ²ng láº·p cÆ¡ báº£n:</p><p>Style Imperative:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> newArr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword control-flow" style="font-style:italic">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  newArr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">newArr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// [2, 3]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Vá»›i style nÃ y, báº¡n nÃªu láº§n lÆ°á»£t tá»«ng bÆ°á»›c code báº¡n thá»±c hiá»‡n nhÆ° tháº¿ nÃ o, ta pháº£i Ä‘i sÃ¢u vÃ o implementation hÆ¡n.</p><p>Trong khi Ä‘Ã³ vá»›i Declarative:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> arr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> newArr </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">element</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> element </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// [2, 3]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Ta sáº½ chá»‰ nÃ³i ráº±ng ta cáº§n 1 máº£ng má»›i tá»« arr, mÃ  má»—i pháº§n tá»­ cá»§a nÃ³ tÄƒng lÃªn 1. Code cá»§a ta vá»«a dá»… hiá»ƒu vÃ  vá»«a Ä‘áº¹p hÆ¡n.</p><p>Má»™t sá»‘ ngÃ´n ngá»¯ tiÃªu biá»ƒu:</p><ul><li>Imperative: C/C++, Java, ...</li><li>Declarative: SQL, HTML, ...</li><li>Táº¡p pháº¿ lÃ¹: Javascript =)), ...</li></ul><p>á» trÃªn lÃ  nhá»¯ng gÃ¬ mÃ¬nh search Ä‘Æ°á»£c trÃªn google khi báº¯t Ä‘áº§u tÃ¬m hiá»ƒu vá» Declarative Programming. Tuy nhiÃªn, váº«n khÃ¡ lÃ  khÃ³ hiá»ƒu, vÃ  khÃ³ phÃ¢n biá»‡t giá»¯a 2 tháº±ng Imperative vÃ  Declarative</p><p>Tuy nhiÃªn khi Ä‘á»c Ä‘Æ°á»£c comment <a href="https://stackoverflow.com/questions/1784664/what-is-the-difference-between-declarative-and-imperative-programming#comment29365241_1784702" target="_blank" rel="noopener noreferrer">nÃ y</a>, má»i thá»© Ä‘Ã£ trá»Ÿ nÃªn sÃ¡ng sá»§a hÆ¡n nhiá»u. MÃ¬nh coi nÃ³ lÃ  1 lá»›p abstract, mÃ  khi gá»i hÃ m Ä‘Ã³, ta chá»‰ cáº§n quan tÃ¢m Ä‘áº¿n <em>what to do</em> mÃ  khÃ´ng pháº£i nghÄ© xem <em>how to do</em>.</p><p>HÃ£y sá»­ dá»¥ng cÃ¡c hÃ m cÃ³ sáºµn cá»§a javascript nhÆ°: <code>.map</code>, <code>.reduce</code>, <code>.filter</code>, ... vÃ  báº¡n sáº½ nháº­n tháº¥y Ä‘Æ°á»£c váº» Ä‘áº¹p cá»§a Declarative Programming.</p><p>Quay trá»Ÿ láº¡i vá»›i React, váº­y thÃ¬ tÃ­nh Declarative cá»§a nÃ³ á»Ÿ Ä‘Ã¢u?</p><p>ChÃ­nh báº£n thÃ¢n cÃ¡c component React Ä‘Ã£ ráº¥t &#x27;declarative&#x27; rá»“i.</p><p>HÃ£y Ä‘á»c pháº§n description cá»§a React trÃªn <a href="https://github.com/facebook/react" target="_blank" rel="noopener noreferrer">Github</a></p><blockquote><p>A declarative, efficient, and flexible JavaScript library for building user interfaces.</p></blockquote><p>Thá»­ so sÃ¡nh 2 Ä‘oáº¡n mÃ£ sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// jQuery</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;.like&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">click</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> $btn </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">$</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token keyword control-flow" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">$btn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">hasClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;liked&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $btn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">removeClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;liked&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    $btn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">addClass</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;liked&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly jsx"><div tabindex="0" class="prism-code language-jsx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// React</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">LikeButton</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">React</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ...codes</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">this</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">liked</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">HighlightButton</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Like</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">HighlightButton</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Button</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Like</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag class-name" style="color:rgb(255, 203, 107)">Button</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Vá»›i jQuery, ta pháº£i mÃ´ táº£ chÃ­nh xÃ¡c code ta cáº§n lÃ m gÃ¬.</p><p>Trong khi Ä‘Ã³ vá»›i React: <em>Tiá»ƒu nhá»‹, like rá»“i thÃ¬ cho cÃ¡i <code>HightlightButton</code> ra Ä‘Ã¢y, khÃ´ng thÃ¬ <code>Button</code> thÆ°á»ng thÃ´i.</em></p><p>Ta sáº½ quan tÃ¢m Ä‘áº¿n viá»‡c component cáº§n hiá»ƒn thá»‹ cÃ¡i gÃ¬ tÆ°Æ¡ng á»©ng vá»›i má»—i (props/state) cá»§a nÃ³.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="link-tham-kháº£o"></a>Link tham kháº£o<a class="hash-link" href="#link-tham-kháº£o" title="Direct link to heading">#</a></h1><p><a href="https://github.com/facebook/react" target="_blank" rel="noopener noreferrer">https://github.com/facebook/react</a></p><p><a href="https://github.com/jondot/awesome-react-native" target="_blank" rel="noopener noreferrer">https://github.com/jondot/awesome-react-native</a></p><p><a href="https://github.com/gitpoint/git-point" target="_blank" rel="noopener noreferrer">https://github.com/gitpoint/git-point</a></p><p><a href="https://medium.freecodecamp.org/all-the-fundamental-react-js-concepts-jammed-into-this-single-medium-article-c83f9b53eac2?gi=7fb0830efbd4" target="_blank" rel="noopener noreferrer">https://medium.freecodecamp.org/all-the-fundamental-react-js-concepts-jammed-into-this-single-medium-article-c83f9b53eac2?gi=7fb0830efbd4</a></p><p><a href="https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-1-1f15e387e536" target="_blank" rel="noopener noreferrer">https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-1-1f15e387e536</a></p><p><a href="https://www.miles.no/blogg/tema/teknisk/why-care-about-functional-programming-part-1-immutability" target="_blank" rel="noopener noreferrer">https://www.miles.no/blogg/tema/teknisk/why-care-about-functional-programming-part-1-immutability</a></p><p><a href="https://blog.logrocket.com/immutability-in-react-ebe55253a1cc" target="_blank" rel="noopener noreferrer">https://blog.logrocket.com/immutability-in-react-ebe55253a1cc</a></p><p><a href="https://stackoverflow.com/questions/1784664/what-is-the-difference-between-declarative-and-imperative-programming#comment29365241_1784702" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/1784664/what-is-the-difference-between-declarative-and-imperative-programming#comment29365241_1784702</a></p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/reactjs">reactjs</a><a class="margin-horiz--sm" href="/blog/tags/web">web</a><a class="margin-horiz--sm" href="/blog/tags/javascript">javascript</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cung-tim-hieu-ve-nguyen-tu-cua-the-gioi-front-end-phan-2-density-independent-pixel">CÃ¹ng tÃ¬m hiá»ƒu vá» nguyÃªn tá»­ cá»§a tháº¿ giá»›i FrontEnd (Pháº§n 2 - Density-independent Pixel)</a></h2><div class="margin-vert--md"><time datetime="2018-11-25T00:00:00.000Z" class="blogPostDate_fNvV">November 25, 2018 Â· 9 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p><a href="https://viblo.asia/p/cung-tim-hieu-ve-nguyen-tu-cua-the-gioi-front-end-phan-1-pixel-4P856PoOZY3" target="_blank" rel="noopener noreferrer">á» kÃ¬ trÆ°á»›c</a>, ta Ä‘Ã£ cÃ¹ng nhau tÃ¬m hiá»ƒu vá» Pixel cá»§a CSS, Ä‘Ã³ lÃ  1 Ä‘Æ¡n vá»‹ Ä‘á»™c láº­p, khÃ´ng bá»‹ phá»¥ thuá»™c vÃ o Ä‘á»™ phÃ¢n giáº£i hay cÃ¡c thÃ´ng sá»‘ khÃ¡c cá»§a mÃ n hÃ¬nh. Äá»‘i vá»›i má»™t loáº¡i mÃ n hÃ¬nh (xÃ©t theo khoáº£ng cÃ¡ch tá»« máº¯t tá»›i mÃ n hÃ¬nh), nÃ³ luÃ´n lÃ  1 háº±ng sá»‘ khÃ´ng Ä‘á»•i. Äiá»u Ä‘Ã³ Ä‘Ã£ giÃºp cho láº­p trÃ¬nh viÃªn Web dá»… thá»Ÿ hÆ¡n ráº¥t nhiá»u.</p><p>á» Android cÅ©ng cÃ³ má»™t Ä‘Æ¡n vá»‹ giá»‘ng nhÆ° váº­y, Google Ä‘áº·t tÃªn cho nÃ³ lÃ  DP (hay DIP - Density Independent Pixel). NgoÃ i ra Ä‘Æ¡n vá»‹ nÃ y cÃ²n dÃ¹ng trong React Native <a href="https://facebook.github.io/react-native/docs/height-and-width.html#fixed-dimensions" target="_blank" rel="noopener noreferrer">[link]</a></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-má»™t-sá»‘-khÃ¡i-niá»‡m-cáº§n-nháº¯c-láº¡i"></a>2. Má»™t sá»‘ khÃ¡i niá»‡m cáº§n nháº¯c láº¡i<a class="hash-link" href="#2-má»™t-sá»‘-khÃ¡i-niá»‡m-cáº§n-nháº¯c-láº¡i" title="Direct link to heading">#</a></h1><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pixel-thiáº¿t-bá»‹"></a>Pixel thiáº¿t bá»‹:<a class="hash-link" href="#pixel-thiáº¿t-bá»‹" title="Direct link to heading">#</a></h4><p>LÃ  1 Ä‘iá»ƒm áº£nh, nÃ³ phá»¥ thuá»™c vÃ o kÃ­ch thÆ°á»›c mÃ n hÃ¬nh, vÃ  Ä‘á»™ phÃ¢n giáº£i mÃ n hÃ¬nh. ThÃ´ng thÆ°á»ng, 1px thiáº¿t bá»‹ trÃªn cÃ¡c mÃ n hÃ¬nh Ä‘á»u cÃ³ giÃ¡ trá»‹ khÃ¡c nhau.</p><p>Pixel nÃ y lÃ  pixel váº­t lÃ½ cá»§a thiáº¿t bá»‹ khÃ¡c hoÃ n toÃ n so vá»›i Ä‘Æ¡n vá»‹ px mÃ  ta hay sá»­ dá»¥ng trong CSS.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="Ä‘á»™-phÃ¢n-giáº£i-thiáº¿t-bá»‹---resolution"></a>Äá»™ phÃ¢n giáº£i thiáº¿t bá»‹ - Resolution:<a class="hash-link" href="#Ä‘á»™-phÃ¢n-giáº£i-thiáº¿t-bá»‹---resolution" title="Direct link to heading">#</a></h4><p>CÃ¡c báº¡n thÆ°á»ng tháº¥y mÃ n hÃ¬nh cÃ³ Ä‘á»™ phÃ¢n giáº£i 4k, HD, FullHD, kÃ¨m theo nÃ³ lÃ  2 con sá»‘ cÃ³ dáº¡ng P1xP2 pháº£i khÃ´ng nÃ o?</p><p>Nhá»¯ng con sá»‘ nÃ y thá»ƒ hiá»‡n sá»‘ pixel cÃ³ trÃªn mÃ n hÃ¬nh, P1 lÃ  sá»‘ pixel phÃ¢n bá»‘ theo chiá»u dÃ i, cÃ²n P2 lÃ  theo chiá»u rá»™ng.</p><p><img src="https://images.viblo.asia/d4b0da95-f9d9-44ff-92e9-71931821321a.jpg"></p><p>(<em>áº£nh chá»‰ mang tÃ­nh cháº¥t minh há»a, mÃ¬nh k pháº£i seeder Ä‘Ã¢u nhÃ¡ =))</em>)</p><p>TV trÃªn cÃ³ chiá»u dÃ i 52.4 inch, cÃ³ 3840px theo chiá»u ngang. 1px sáº½ cÃ³ giÃ¡ trá»‹</p><p><code>1px = 52.4 / 3840 = 0.01365 (inch)</code></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="dpi-ppi"></a>DPI, PPI:<a class="hash-link" href="#dpi-ppi" title="Direct link to heading">#</a></h4><p>DPI - <strong>Dots Per Inch</strong>. PPI - <strong>Points Per Inch</strong></p><p>ChÃºng Ä‘á»u lÃ  sá»‘ pixel/Ä‘iá»ƒm áº£nh cÃ³ trÃªn 1 inch Ä‘á»™ dÃ i váº­t lÃ½ cá»§a thiáº¿t bá»‹, biá»ƒu thá»‹ máº­t Ä‘á»™ pixel trÃªn mÃ n hÃ¬nh.</p><p>DPI tháº¥p, 1px cÃ³ kÃ­ch thÆ°á»›c lá»›n, hÃ¬nh áº£nh cÃ³ thá»ƒ sáº½ bá»‹ rÄƒng cÆ°a, khÃ´ng sáº¯c nÃ©t báº±ng DPI cao</p><p><img src="https://images.viblo.asia/1e74f9f2-8d4e-407c-9023-9f4d248598cf.jpg"></p><p>Láº¥y láº¡i VD mÃ n hÃ¬nh TV trÃªn:</p><p><code>DPI = 3840 / 52.4 = 73.28 (pixels/inch)</code></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-density-independent-pixels"></a>3. Density Independent Pixels<a class="hash-link" href="#3-density-independent-pixels" title="Direct link to heading">#</a></h1><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="31-Ä‘áº·t-váº¥n-Ä‘á»"></a>3.1 Äáº·t váº¥n Ä‘á»<a class="hash-link" href="#31-Ä‘áº·t-váº¥n-Ä‘á»" title="Direct link to heading">#</a></h3><p>CÃ¡c Ä‘iá»‡n thoáº¡i Android cÃ³ nhiá»u loáº¡i kÃ­ch thÆ°á»›c (phone, tablet, TV, ...), hÆ¡n ná»¯a chÃºng láº¡i cÃ²n cÃ³ Ä‘á»™ phÃ¢n giáº£i khÃ¡c nhau, dáº«n Ä‘áº¿n kÃ­ch thÆ°á»›c pixel luÃ´n thay Ä‘á»•i, gÃ¢y khÃ³ khÄƒn cho nhÃ  phÃ¡t triá»ƒn khi dá»±ng giao diá»‡n.</p><p>Láº¥y vÃ­ dá»¥ Ä‘Æ¡n giáº£n nháº¥t vá» 2 Ä‘iá»‡n thoáº¡i cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c Ä‘Æ°á»ng chÃ©o 5inch, nhÆ°ng 1 chiáº¿c FullHD 1080x1920, 1 chiáº¿c 4K 2160 x 3840.</p><p>Náº¿u báº¡n lÃ  dev, báº¡n sáº½ muá»‘n 1 button trong app cá»§a mÃ¬nh hiá»ƒn thá»‹ trÃªn 2 Ä‘iá»‡n thoáº¡i nÃ y giá»‘ng nhau pháº£i khÃ´ng nÃ o?</p><p>Tháº¿ nhÆ°ng náº¿u lÃ m viá»‡c vá»›i px thiáº¿t bá»‹, ta sáº½ gáº·p 1 chÃºt ráº¯c rá»‘i vÃ¬ vá»›i cÃ¹ng 1 kÃ­ch thÆ°á»›c, Ä‘iá»‡n thoáº¡i 4K luÃ´n cáº§n gáº¥p Ä‘Ã´i sá»‘ px so vá»›i FullHD.</p><p><img src="https://images.viblo.asia/4b56fc09-40ee-4f95-b7fc-8409b2961e99.jpg"></p><p>2 cÃ¡i Ä‘Ã£ má»‡t, trÃªn thá»±c táº¿, ta cÃ³ ty tá»· loáº¡i mÃ n hÃ¬nh, váº­y thÃ¬ style sao cho xuá»ƒ, chÆ°a ká»ƒ cÃ²n Ä‘áº¿n tá»‘i Æ°u cÃ¡c file áº£nh cho app.</p><p>ChÃ­nh vÃ¬ váº­y, <code>dp</code> ra Ä‘á»i.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="32-dp"></a>3.2. DP<a class="hash-link" href="#32-dp" title="Direct link to heading">#</a></h3><p>Google Ä‘á»‹nh nghÄ©a nÃ³ nhÆ° sau:</p><blockquote><p>One dp is a virtual pixel unit that&#x27;s roughly equal to one pixel on a medium-density screen (160dpi; the &quot;baseline&quot; density). Android translates this value to the appropriate number of real pixels for each other density.</p></blockquote><p>Náº¿u báº¡n Ä‘Ã£ Ä‘á»c bÃ i trÆ°á»›c cá»§a mÃ¬nh vá» CSS pixel, thÃ¬ cÃ³ thá»ƒ tháº¥y nÃ³ khÃ¡ quen thuá»™c pháº£i khÃ´ng nÃ o, Ä‘Ã¢y cÅ©ng lÃ  1 <em>virtual unit</em>.</p><p><strong>1dp tÆ°Æ¡ng Ä‘Æ°Æ¡ng 1 px trÃªn mÃ n hÃ¬nh 160dpi</strong>. CÃ³ nghÄ©a lÃ  <code>1dp = 1 / 160 = 0.00625 (inch) = 1px (160dpi)</code></p><p>Äá»ƒ quy Ä‘á»•i <code>dp</code> sang <code>px</code> trÃªn cÃ¡c loáº¡i mÃ n hÃ¬nh khÃ¡c, ta nhÃ¢n dp vá»›i 1 sá»‘, gá»i lÃ  scale factor (tá»‰ lá»‡ DPI cá»§a mÃ n hÃ¬nh so vá»›i chuáº©n 160dpi).</p><p>VÃ­ dá»¥ mÃ¡y 320dpi. <code>1dp = 1 * 320 / 160 = 2px</code></p><p>Android sáº½ tá»± Ä‘á»™ng convert sang pixel thiáº¿t bá»‹ cho ta, nÃªn ta chá»‰ cáº§n dÃ¹ng <code>dp</code> lÃ  trÃªn má»i thiáº¿t bá»‹, pháº§n tá»­ cá»§a ta sáº½ Ä‘á»u cÃ³ kÃ­ch thÆ°á»›c báº±ng nhau (ngoáº¡i lá»‡ sáº½ Ä‘á» cáº­p sau).</p><p>Khi ta dá»±ng UI, nÃªn táº­n dá»¥ng tá»‘i Ä‘a <code>dp</code>, trÃ¡nh sá»­ dá»¥ng <code>px</code>.</p><p>BÃªn cáº¡nh Ä‘Ã³, Google cÅ©ng khuyÃªn ta khÃ´ng nÃªn sá»­ dá»¥ng <code>dp</code> cho text, mÃ  hÃ£y dÃ¹ng <code>sp</code>. ÄÃ¢y cÅ©ng lÃ  má»™t loáº¡i density-independent, nhÆ°ng nÃ³ cÃ³ thá»ƒ bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi tÃ¹y chá»n cá»§a ngÆ°á»i dÃ¹ng. NgÆ°á»i dÃ¹ng chá»n cá»¡ chá»¯ to, thÃ¬ 1sp cÅ©ng lá»›n lÃªn theo. VÃ¬ váº­y, cÅ©ng trÃ¡nh dÃ¹ng <code>sp</code> khi thiáº¿t káº¿ layout.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="33-density-bucket"></a>3.3 Density Bucket<a class="hash-link" href="#33-density-bucket" title="Direct link to heading">#</a></h3><p><code>dp</code> ra Ä‘á»i, nhÆ°ng cÅ©ng chÆ°a giáº£i quyáº¿t Ä‘Æ°á»£c háº¿t cÃ¡c váº¥n Ä‘á». ÄÃ³ chÃ­nh lÃ  vá» resource hÃ¬nh áº£nh. Style cho áº£nh thÃ¬ cÃ³ thá»ƒ sá»­ dá»¥ng dp Ä‘Æ°á»£c (áº£nh sáº½ bá»‹ kÃ©o to, hoáº·c co láº¡i cho Ä‘á»§ size cáº§n thiáº¿t), nhÆ°ng resource thÃ¬ Ä‘Ã¢u cÃ³ thá»ƒ to nhá» tÃ¹y Ã½ Ä‘Æ°á»£c, thÃ´ng sá»‘ cá»§a nÃ³ luÃ´n lÃ  cá»‘ Ä‘á»‹nh.</p><p>Láº¥y vÃ­ dá»¥ vá» 1 hÃ¬nh áº£nh 500x500px (resolution), vá»›i 2 mÃ n hÃ¬nh cÃ³ kÃ­ch thÆ°á»›c báº±ng nhau, nhÆ°ng khÃ¡c Ä‘á»™ phÃ¢n giáº£i (khÃ¡c DPI), 1 chiáº¿c lÃ  360x640, 1 chiáº¿c lÃ  720x1280.</p><p>HÃ¬nh áº£nh trÃªn náº¿u hiá»ƒn thá»‹ trÃªn mÃ n hÃ¬nh 360x640 thÃ¬ cháº³ng pháº£i sáº½ dÆ° thá»«a sao? VÃ¬ chiá»u rá»™ng mÃ n hÃ¬nh chá»‰ cÃ³ 360px. CÃ²n trÃªn mÃ n hÃ¬nh 720x1280, thÃ¬ nÃ³ cháº£ Ä‘Ã¡ng lÃ  bao. VÃ¬ váº­y ta cáº§n sá»­ dá»¥ng hÃ¬nh áº£nh cÃ³ Ä‘á»™ phÃ¢n giáº£i tháº¥p hÆ¡n cho mÃ n hÃ¬nh 360x640.</p><p>NhÆ°ng khÃ´ng láº½ cá»© má»—i Ä‘á»™ phÃ¢n giáº£i láº¡i táº¡o 1 hÃ¬nh áº£nh tÆ°Æ¡ng á»©ng? Váº­y thÃ¬ app size cá»§a ta sáº½ bÃ¹ng ná»• luÃ´n.</p><p>VÃ¬ láº½ Ä‘Ã³ mÃ  ra Ä‘á»i <code>density bucket</code>.</p><p>Äá»ƒ cho Ä‘Æ¡n giáº£n, cÃ¡c loáº¡i mÃ n hÃ¬nh cÃ³ DPI gáº§n báº±ng nhau sáº½ Ä‘Æ°á»£c lÃ m trÃ²n rá»“i gom vÃ o 1 nhÃ³m. VÃ­ dá»¥ nhÆ° mÃ¡y 293dpi, Android sáº½ coi nhÆ° mÃ¡y Ä‘Ã³ lÃ  320dpi, khi Ä‘Ã³ 1dp = 2px. CÃ²n nhiá»u loáº¡i khÃ¡c ná»¯a, nhÆ°ng mÃ¬nh chá»‰ nÃªu ra 4 bucket Ä‘Ã¡ng chÃº Ã½, best practice lÃ  support cáº£ 4 bucket nÃ y.</p><table><thead><tr><th>Bucket name</th><th>Density bucket</th><th>DPI</th><th>Scale Factor</th></tr></thead><tbody><tr><td>Medium</td><td>mdpi</td><td>160</td><td>1.00</td></tr><tr><td>High</td><td>hdpi</td><td>240</td><td>1.50</td></tr><tr><td>Extra High</td><td>xhdpi</td><td>320</td><td>2.00</td></tr><tr><td>Extra Extra High</td><td>xxhdpi</td><td>480</td><td>3.00</td></tr></tbody></table><p>Nhá»¯ng gÃ¬ báº¡n cáº§n lÃ m lÃ  nÃ©m háº¿t hÃ¬nh áº£nh cá»§a cÃ¡c bucket vÃ o thÆ° má»¥c tÆ°Æ¡ng á»©ng. Android sáº½ tá»± detect vÃ  chá»n hÃ¬nh áº£nh tá»‘i Æ°u nháº¥t cho báº¡n (láº¥y tá»« DPI cao nháº¥t vá»).</p><p><img src="https://images.viblo.asia/653192f1-8c27-469d-a007-1ac22681ea23.png"></p><p><img src="https://images.viblo.asia/d606e411-f5cc-4151-b13e-4b2dfd626097.png"></p><p>CÅ©ng vÃ¬ viá»‡c lÃ m trÃ²n DPI nÃ y, mÃ  1dp cá»§a ta trÃªn cÃ¡c thiáº¿t bá»‹ cÃ³ thá»ƒ khÃ´ng báº±ng nhau, nhÆ°ng <strong>luÃ´n xáº¥p xá»‰ 1/160 = 0.00625 inch</strong></p><table><thead><tr><th>Density</th><th>Bucket</th><th>Scale factor</th><th>Physical Size (inch)</th></tr></thead><tbody><tr><td>293dpi</td><td>xhdpi - 320dpi</td><td>2</td><td>1 * 2 / 293 = 0.00686</td></tr><tr><td>320dpi</td><td>xhdpi</td><td>2</td><td>1 * 2 / 320 = 0.00625</td></tr><tr><td>330 dpi</td><td>xhdpi</td><td>2</td><td>1 * 2 / 330 = 0.00606</td></tr></tbody></table><p>Äiá»u nÃ y cÅ©ng Ä‘em Ä‘áº¿n cho ta 1 lá»£i Ã­ch, Ä‘Ã³ lÃ  vá»›i cÃ¡c sá»‘ mÃ¡y density khÃ¡c nhau, nhÆ°ng cÃ¹ng Ä‘á»™ phÃ¢n giáº£i, kÃ­ch thÆ°á»›c bá» ngang cá»§a ta tÃ­nh báº±ng dp Ä‘á»u báº±ng nhau. Láº¥y vÃ­ dá»¥ 3 mÃ¡y 720x1280, 1 mÃ¡y 293 dpi, 1 mÃ¡y 320 dpi, 1 mÃ¡y 330 dpi.</p><table><thead><tr><th>Density</th><th>Width (without Density Bucket)</th><th>Width (with density bucket)</th></tr></thead><tbody><tr><td>293dpi</td><td>720 / (293 / 160) = 393dp</td><td>360dp</td></tr><tr><td>320dpi</td><td>720 / (320 / 160) = 360dp</td><td>360dp</td></tr><tr><td>330dpi</td><td>720 / (330 / 160) = 349dp</td><td>360dp</td></tr></tbody></table><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-vÃ­-dá»¥"></a>4. VÃ­ dá»¥<a class="hash-link" href="#4-vÃ­-dá»¥" title="Direct link to heading">#</a></h1><p>Sau khi nhá»“i 1 Ä‘á»‘ng lÃ½ thuyáº¿t vÃ o Ä‘áº§u, ta hÃ£y thá»­ lÃ m 1 bÃ i táº­p nho nhá», Ä‘á»ƒ Ã¡p dá»¥ng chÃºng. HÃ£y thá»­ tá»± tÃ­nh toÃ¡n thÃ´ng sá»‘ cho Ä‘iá»‡n thoáº¡i cá»§a mÃ¬nh xem.</p><p>Äiá»‡n thoáº¡i mÃ¬nh 5inch, Ä‘á»™ phÃ¢n giáº£i 720x1280.</p><p>Ta dá»… dÃ ng tÃ­nh toÃ¡n Ä‘Æ°á»£c chiá»u dÃ i vÃ  chiá»u rá»™ng cá»§a mÃ¡y, dá»±a vÃ o Ä‘á»‹nh lÃ½ Pytago:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly tx"><div tabindex="0" class="prism-code language-tx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">5**2 = (1280 * x)**2 + (720 * x)**2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">width = 720 * x = 2.4513 (inch)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">height = 1280 * x = 4.3579 (inch)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Tá»« Ä‘Ã³ ta cÃ³ thá»ƒ tÃ­nh táº¥t cáº£ cÃ¡c thÃ´ng sá»‘ khÃ¡c:</p><table><thead><tr><th>ThÃ´ng sá»‘</th><th>GiÃ¡ trá»‹</th></tr></thead><tbody><tr><td>Device density</td><td>720 / 2.4513 = 294 dpi</td></tr><tr><td>Density bucket</td><td>xhdpi - 320dpi</td></tr><tr><td>Scale factor</td><td>320 / 160 = 2.00</td></tr><tr><td>Width</td><td>720 / 2 = 360dp</td></tr><tr><td>Height</td><td>1280 / 2 = 640dp</td></tr><tr><td>DIP</td><td>1dp = 2px = 0.0068 (inch)</td></tr></tbody></table><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-káº¿t-luáº­n"></a>5. Káº¿t luáº­n<a class="hash-link" href="#5-káº¿t-luáº­n" title="Direct link to heading">#</a></h1><p>Sá»± ra Ä‘á»i cá»§a <code>dp</code> vÃ  <code>density bucket</code> quáº£ thá»±c Ä‘Ã£ giÃºp ta trÃ¡nh Ä‘Æ°á»£c khÃ´ng Ã­t ráº¯c rá»‘i trong khi phÃ¡t triá»ƒn á»©ng dá»¥ng Android, tá»‘i Æ°u hÃ¬nh áº£nh cho app. BÃ i viáº¿t khÃ´ng trÃ¡nh khá»i sai sÃ³t, náº¿u cÃ³ sáº¡n, hÃ£y cá»© gÃ³p Ã½, mÃ¬nh sáº½ tiáº¿p thu vÃ  chá»‰nh sá»­a cho phÃ¹ há»£p.</p><p>ÄÃ¢y cÃ³ láº½ lÃ  bÃ i cuá»‘i cá»§a mÃ¬nh trong series vá» nhá»¯ng thá»© bÃ© nhá» mÃ  Ã­t ai Ä‘á»ƒ Ã½ trong khi thiáº¿t káº¿ giao diá»‡n Web, mobile. CÃ¡m Æ¡n má»i ngÆ°á»i Ä‘Ã£ Ä‘á»c bÃ i! - náº¿u cÃ¡c báº¡n Ä‘á»c Ä‘áº¿n táº­n dÃ²ng nÃ y =))</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-link-tham-kháº£o"></a>6. Link tham kháº£o<a class="hash-link" href="#6-link-tham-kháº£o" title="Direct link to heading">#</a></h1><ol><li><a href="https://developer.android.com/training/multiscreen/screendensities" target="_blank" rel="noopener noreferrer">https://developer.android.com/training/multiscreen/screendensities</a></li><li><a href="https://www.highgroundgaming.com/tas/gaming-mouse-guide/low-vs-high-dpi-example/" target="_blank" rel="noopener noreferrer">https://www.highgroundgaming.com/tas/gaming-mouse-guide/low-vs-high-dpi-example/</a></li><li><a href="https://facebook.github.io/react-native/docs/height-and-width.html#fixed-dimensions" target="_blank" rel="noopener noreferrer">https://facebook.github.io/react-native/docs/height-and-width.html#fixed-dimensions</a></li><li><a href="https://www.avconcepts.com/2015/09/24/4k-ultra-hd-vs-hd-projection/" target="_blank" rel="noopener noreferrer">https://www.avconcepts.com/2015/09/24/4k-ultra-hd-vs-hd-projection/</a></li><li><a href="https://www.captechconsulting.com/blogs/understanding-density-independence-in-android" target="_blank" rel="noopener noreferrer">https://www.captechconsulting.com/blogs/understanding-density-independence-in-android</a></li><li><a href="https://medium.com/@sashaserg/a-mysterious-density-independent-pixel-a-quick-introduction-to-android-design-111d68be7cf5" target="_blank" rel="noopener noreferrer">https://medium.com/@sashaserg/a-mysterious-density-independent-pixel-a-quick-introduction-to-android-design-111d68be7cf5</a></li></ol></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/frontend">frontend</a><a class="margin-horiz--sm" href="/blog/tags/android">android</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/cung-tim-hieu-ve-nguyen-tu-cua-the-gioi-front-end-phan-1-pixel">CÃ¹ng tÃ¬m hiá»ƒu vá» nguyÃªn tá»­ cá»§a tháº¿ giá»›i FrontEnd (Pháº§n 1 - Pixel)</a></h2><div class="margin-vert--md"><time datetime="2018-10-27T00:00:00.000Z" class="blogPostDate_fNvV">October 27, 2018 Â· 7 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p><img src="https://images.viblo.asia/356f907a-e15f-4de7-a14c-e60c6553537b.png"></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-má»Ÿ-Ä‘áº§u"></a>1. Má»Ÿ Ä‘áº§u<a class="hash-link" href="#1-má»Ÿ-Ä‘áº§u" title="Direct link to heading">#</a></h1><p>Náº¿u lÃ  má»™t nhÃ  phÃ¡t triá»ƒn á»©ng dá»¥ng Web hay Android, thÃ¬ cháº¯c háº³n báº¡n Ä‘Ã£ dÃ¹ng cÃ¡c Ä‘Æ¡n vá»‹ Ä‘á»™ dÃ i nhÆ° <code>px</code>, <code>dp</code> Ä‘á»ƒ táº¡o style cho cÃ¡c pháº§n tá»­ trÃªn giao diá»‡n.</p><p>CÃ³ láº½ nhiá»u ngÆ°á»i sáº½ nghÄ© ráº±ng: MÃ n hÃ¬nh mÃ¬nh FullHD, Ä‘á»™ phÃ¢n giáº£i 1920x1080, thÃ¬ cá»© 1920px mÃ  vÃ£ vÃ o css thÃ´i, nghÄ© ngá»£i lÃ m gÃ¬ nhiá»u. NhÆ°ng liá»‡u cÃ³ tháº­t lÃ  nhÆ° váº­y khÃ´ng? ChÃºng ta hÃ£y cÃ¹ng tÃ¬m hiá»ƒu</p><p>TL;DR</p><blockquote><p>1px = 1/96 inch</p><p>1dp = 1/160 inch</p></blockquote><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-pixel---nguyÃªn-tá»­-cá»§a-tháº¿-giá»›i-web"></a>2. Pixel - nguyÃªn tá»­ cá»§a tháº¿ giá»›i Web<a class="hash-link" href="#2-pixel---nguyÃªn-tá»­-cá»§a-tháº¿-giá»›i-web" title="Direct link to heading">#</a></h1><p><strong>LÆ°u Ã½:</strong>
TrÆ°á»›c tiÃªn, ta cáº§n pháº£i lÃ m rÃµ 1 Ä‘iá»u: 1px cá»§a CSS khÃ¡c vá»›i 1px cá»§a thiáº¿t bá»‹ (Ä‘á»™ phÃ¢n giáº£i). 1px CSS cÃ³ thá»ƒ tÆ°Æ¡ng á»©ng vá»›i 1 hoáº·c nhiá»u px cá»§a thiáº¿t bá»‹.</p><p>CÃ³ ráº¥t nhiá»u loáº¡i mÃ n hÃ¬nh, Ä‘á»™ phÃ¢n giáº£i, kÃ­ch thÆ°á»›c khÃ¡c nhau. NÃ³ lÃ m khÃ³ láº­p trÃ¬nh viÃªn trong viá»‡c dá»±ng giao diá»‡n, Ä‘Æ°á»£c mÃ n hÃ¬nh nÃ y thÃ¬ láº¡i há»ng mÃ n hÃ¬nh kia. VÃ¬ váº­y w3 Ä‘Ã£ quy Æ°á»›c 1 Ä‘Æ¡n vá»‹ chuáº©n, dÃ¹ng cho má»i thiáº¿t bá»‹: <strong>px</strong>.</p><p>Äá»‹nh nghÄ©a trÃªn <a href="https://www.w3.org/TR/css-values-4/#px" target="_blank" rel="noopener noreferrer">w3</a></p><blockquote><p>1px = 1/96th of 1in</p></blockquote><p>Tuy nhiÃªn, khi nhÃ¬n xuá»‘ng dÆ°á»›i má»™t chÃºt, ta cÃ³ thá»ƒ tháº¥y thÃªm</p><blockquote><p>For a CSS device, these dimensions are anchored either:</p><p>â€‹ i. by relating the physical units to their physical measurements, or</p><p>â€‹ ii. by relating the pixel unit to the reference pixel.</p></blockquote><p>NhÃ¬n sÆ¡ qua thÃ¬ khÃ¡ lÃ  khÃ³ hiá»ƒu, nhÆ°ng ta cÃ³ thá»ƒ hÃ¬nh dung Ä‘Æ°á»£c 1 Ä‘iá»u, pixel cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh toÃ¡n theo 2 cÃ¡ch.</p><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="21-by-relating-the-physical-units-to-their-physical-measurements"></a>2.1 By relating the physical units to their physical measurements<a class="hash-link" href="#21-by-relating-the-physical-units-to-their-physical-measurements" title="Direct link to heading">#</a></h6><p>Ã Ä‘áº§u lÃ  dÃ nh cho cÃ¡c thiáº¿t bá»‹ Ä‘Ã²i há»i Ä‘á»™ chÃ­nh xÃ¡c cao vá» Ä‘á»™ dÃ i, vÃ­ dá»¥ nhÆ° mÃ¡y in. Ta pháº£i sá»­ dá»¥ng cÃ¡c Ä‘Æ¡n vá»‹ <code>inch</code>, <code>cm</code>, ... Ä‘Ãºng nhÆ° Ä‘á»™ dÃ i thá»±c táº¿ cá»§a chÃºng. Khi Ä‘Ã³, <code>1px</code> sáº½ tÆ°Æ¡ng Ä‘Æ°Æ¡ng <strong>0.267mm</strong> (25.6/96). Ta sáº½ khÃ´ng Ä‘á» cáº­p Ä‘áº¿n nhá»¯ng loáº¡i thiáº¿t bá»‹ nÃ y trong bÃ i.</p><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="22-by-relating-the-pixel-unit-to-the-reference-pixel"></a>2.2 By relating the pixel unit to the reference pixel<a class="hash-link" href="#22-by-relating-the-pixel-unit-to-the-reference-pixel" title="Direct link to heading">#</a></h6><p>Äá»‘i vá»›i cÃ¡c thiáº¿t bá»‹ trÃ¬nh chiáº¿u (báº¥t ká»ƒ Ä‘á»™ phÃ¢n giáº£i, mÃ n hÃ¬nh Retina hay thá»© gÃ¬ tháº§n thÃ¡nh khÃ¡c), cÃ¡c thiáº¿t bá»‹ mÃ  cÃ³ khoáº£ng cÃ¡ch nhÃ¬n báº¥t thÆ°á»ng, <strong>px</strong> sáº½ lÃ  Ä‘Æ¡n vá»‹ Ä‘á»ƒ tÃ­nh ra <code>inch</code>, <code>cm</code>, ...</p><p>VÃ  w3 khuyÃªn ráº±ng, nÃªn sá»­ dá»¥ng <strong>reference pixel</strong> Ä‘á»ƒ tÃ­nh ra tá»‰ lá»‡ quy Ä‘á»•i 1px CSS nÃ y vá»›i sá»‘ pixel thiáº¿t bá»‹ (mÃ n hÃ¬nh 4096â€‰Ã—â€‰2160 cÃ³ thá»ƒ sáº½ khÃ´ng cÃ²n lÃ  4096px trong CSS ná»¯a). Hay nÃ³i cÃ¡ch khÃ¡c lÃ  tÃ­nh xem 1px CSS báº±ng bao nhiÃªu.</p><p>Láº¡i má»™t Ä‘Æ¡n vá»‹ háº¡i nÃ£o ná»¯a, vÃ  w3 Ä‘á»‹nh nghÄ©a nÃ³ nhÆ° sau:</p><blockquote><p>The reference pixel is the visual angle of one pixel on a device with a pixel density of 96dpi and a distance from the reader of an armâ€™s length. For a nominal armâ€™s length of 28 inches, the visual angle is therefore about 0.0213 degrees. For reading at armâ€™s length, 1px thus corresponds to about 0.26 mm (1/96 inch).</p></blockquote><p>NhÆ° váº­y, <code>reference pixel</code> lÃ  má»™t <strong>visual angle</strong> cá»§a <strong>1px</strong> trÃªn mÃ n hÃ¬nh <strong>96dpi</strong>. Khoáº£ng cÃ¡ch nhÃ¬n lÃ  1 sáº£i tay (khoáº£ng 28in Ä‘á»‘i vá»›i ngÆ°á»i bÃ¬nh thÆ°á»ng) - Ä‘Ã¢y lÃ  khoáº£ng cÃ¡ch ngá»“i PC thÃ´ng thÆ°á»ng.</p><p>Tá»« khÃ¡i niá»‡m nÃ y láº¡i Ä‘áº» ra khÃ¡i niá»‡m khÃ¡c :v Ta hÃ£y báº¯t Ä‘áº§u vá»›i DPI</p><p><strong>DPI</strong> (Dots Per Inch): tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i PPI (Pixels Per Inch), nÃ³ cho ta biáº¿t 1inch mÃ n hÃ¬nh thiáº¿t bá»‹ cÃ³ bao nhiÃªu pixel thiáº¿t bá»‹. 96dpi nghÄ©a lÃ  1inch cÃ³ 96 pixel. NhÆ° váº­y 1px cá»§a mÃ n hÃ¬nh 96dpi sáº½ lÃ  2.56 / 96 ~ <strong>0.26mm</strong></p><p>DPI cÃ ng lá»›n, mÃ n hÃ¬nh hiá»ƒn thá»‹ cÃ ng chi tiáº¿t. DPI Ä‘Æ°á»£c tÃ­nh dá»±a trÃªn kÃ­ch thÆ°á»›c thiáº¿t bá»‹ vÃ  Ä‘á»™ phÃ¢n giáº£i cá»§a thiáº¿t bá»‹.</p><p>VD mÃ n hÃ¬nh cÃ´ng ty mÃ¬nh dÃ¹ng lÃ  Dell P2319H, 23in (58,42cm), Ä‘á»™ phÃ¢n giáº£i 1920x1080</p><p><img src="https://images.viblo.asia/c5529984-c033-4c36-abb1-9dd73be39f03.jpg"></p><p>Ãp dá»¥ng Pytago: ta cÃ³</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">(1920x)^2 + (1080x)^2 = 58.42^2 (cm^2)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>TÃ­nh nhanh, ta Ä‘Æ°á»£c x = 0.0265cm. NhÆ° váº­y, mÃ¡y mÃ¬nh cÃ³ chiá»u rá»™ng lÃ  1920x = 19.89in, vÃ  DPI = 1920 / 19.89 = 96.53</p><p><strong>Visual angle</strong> lÃ  gÃ³c v Ä‘Æ°á»£c biá»ƒu thá»‹ dÆ°á»›i hÃ¬nh sau:</p><p><img src="https://images.viblo.asia/835cce17-7a60-43d8-adc0-ead0a1d00de8.jpg"></p><p>Ãp dá»¥ng vÃ o, báº¥m mÃ¡y tÃ­nh:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">v = 2 x arctan((2.56/96) / (2x28x2.56)) =&gt; 0.0213 (Ä‘á»™)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Vá»›i reference pixel lÃ  <strong>0.0213 Ä‘á»™</strong>, khoáº£ng cÃ¡ch nhÃ¬n <strong>28in</strong>, 1px CSS luÃ´n cÃ³ giÃ¡ trá»‹ lÃ  <strong>0.26mm</strong>. VÃ¬ váº­y giá»¯a 2 mÃ n hÃ¬nh PC cÃ¹ng kÃ­ch thÆ°á»›c, nhÆ°ng cÃ³ Ä‘á»™ phÃ¢n giáº£i khÃ¡c nhau (vÃ­ dá»¥ 1 cÃ¡i FullHD, 1 cÃ¡i 4K), 1 element cÃ³ width 10px sáº½ luÃ´n cÃ³ kÃ­ch thÆ°á»›c váº­t lÃ½ báº±ng nhau (2.6mm).</p><p><img src="https://images.viblo.asia/4f52ddec-b90b-42f3-9556-b3cf12e6f4d8.png"></p><p>Vá»›i mÃ n hÃ¬nh FullHD, 1px CSS sáº½ á»©ng vá»›i 1px cá»§a thiáº¿t bá»‹, cÃ²n vá»›i mÃ n Retina cÄƒng Ä‘Ã©t, 1px CSS á»©ng vá»›i 2px thiáº¿t bá»‹, nhÆ°ng kÃ­ch thÆ°á»›c tháº­t cá»§a chÃºng Ä‘á»u lÃ  0.26mm.</p><p>Khoáº£ng cÃ¡ch tá»›i mÃ n hÃ¬nh cÃ ng cao, Ä‘á»™ lá»›n cá»§a 1px cÃ ng tÄƒng lÃªn. á» khoáº£ng cÃ¡ch 3.5m, 1px cÃ³ giÃ¡ trá»‹ lÃªn tá»›i 1.3mm, vÃ  1in lÃºc nÃ y khoáº£ng 124.8mm (gáº¥p gáº§n 5 láº§n giÃ¡ trá»‹ thá»±c).</p><p><img src="https://images.viblo.asia/a666ffa1-d5ba-4e25-9f16-4231d6f0a08a.png"></p><p>Loanh quanh má»™t há»“i, ta váº«n chÆ°a giáº£i thÃ­ch Ä‘Æ°á»£c váº¥n Ä‘á» ban Ä‘áº§u: Ta cÃ³ thá»ƒ coi 1px trÃªn mÃ n hÃ¬nh PC lÃ  1px CSS hay khÃ´ng?</p><p>CÃ¢u tráº£ lá»i lÃ  cÃ³. Bá»Ÿi vÃ¬ mÃ n hÃ¬nh PC, laptop hiá»‡n nay Ä‘a sá»‘ Ä‘á»u cÃ³ Ä‘á»™ phÃ¢n giáº£i khoáº£ng 96dpi, nÃªn 1px thiáº¿t bá»‹ vá»«a Ä‘Ãºng vá»›i 1px CSS.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-pixel-trÃªn-trÃ¬nh-duyá»‡t-mobile"></a>3. Pixel trÃªn trÃ¬nh duyá»‡t Mobile<a class="hash-link" href="#3-pixel-trÃªn-trÃ¬nh-duyá»‡t-mobile" title="Direct link to heading">#</a></h1><p>Liá»‡u cÃ¡c báº¡n cÃ³ bao giá» tháº¯c máº¯c: MÃ n hÃ¬nh Ä‘iá»‡n thoáº¡i toÃ n HD 720x1280, FullHD 1080x1920, ... mÃ  sao khi responsive láº¡i pháº£i sá»­ dá»¥ng media query &lt; 576px?</p><p>Cháº¯c háº³n cÃ¡c báº¡n Ä‘Ã£ tá»± cÃ³ cÃ¢u tráº£ lá»i cho mÃ¬nh. VÃ¬ khi sá»­ dá»¥ng <strong>reference pixel</strong>, 1px trÃªn Ä‘iá»‡n thoáº¡i sáº½ khÃ´ng cÃ²n lÃ  1px cá»§a CSS ná»¯a.</p><p>Do DPI Ä‘iá»‡n thoáº¡i cao chÄƒng? VÃ­ dá»¥ Ä‘iá»‡n thoáº¡i mÃ¬nh cÃ³ DPI lÃ  294, Ä‘á»™ phÃ¢n giáº£i 720x1280, váº­y thÃ¬ 1px CSS (0.26mm) = 3px thiáº¿t bá»‹ (0.087mm). Váº­y thÃ¬ lÃ  240x427?</p><p>KhÃ´ng, má»™t pháº§n Ä‘Ãºng lÃ  do DPI, vÃ  1 lÃ½ do ná»¯a lÃ  vÃ¬ ta cáº§m Ä‘iá»‡n thoáº¡i gáº§n hÆ¡n nhiá»u so vá»›i khoáº£ng cÃ¡ch ngá»“i trÆ°á»›c mÃ n hÃ¬nh PC, Laptop (khoáº£ng 18in)</p><p><img src="https://images.viblo.asia/ff59e444-6b0f-430e-85b2-b4afa3494ec9.jpg"></p><p>Ãp dá»¥ng Ä‘á»‹nh lÃ½ Talet trong tam giÃ¡c, ta tÃ­nh Ä‘Æ°á»£c 1px CSS giá» chá»‰ cÃ²n:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">18 * 0.26 / 28 = 0.167mm</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Láº¡i láº¥y Ä‘iá»‡n thoáº¡i 5in, Ä‘á»™ phÃ¢n giáº£i 720x1280 cá»§a mÃ¬nh, 1px = 0.087mm</p><p>Dá»… tháº¥y 1px CSS = 2px thiáº¿t bá»‹. VÃ¬ tháº¿ mÃ n hÃ¬nh rá»™ng 720px cá»§a ta giá» chá»‰ cÃ²n 360px trong máº¯t CSS. Tá»‰ lá»‡ 2:1 nÃ y, gá»i lÃ  <code>devicePixelRatio</code></p><p>Con sá»‘ nÃ y sáº½ Ä‘Æ°á»£c nhÃ  sáº£n xuáº¥t tÃ­nh toÃ¡n vÃ  cung cáº¥p khi sáº£n xuáº¥t 1 thiáº¿t bá»‹ nÃ o Ä‘Ã³. Vá»›i Javascript, ta cÃ³ thá»ƒ dÃ¹ng hÃ m sau Ä‘á»ƒ láº¥y Ä‘Æ°á»£c <code>devicePixelRatio</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><div tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token dom variable" style="color:rgb(191, 199, 213)">window</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">devicePixelRatio</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-káº¿t-luáº­n"></a>4. Káº¿t luáº­n<a class="hash-link" href="#4-káº¿t-luáº­n" title="Direct link to heading">#</a></h1><p>Tháº¿ giá»›i Frontend khÃ¡ háº¡i nÃ£o vá»›i cÃ¡c loáº¡i mÃ n hÃ¬nh khÃ¡c nhau, nÃªn ngÆ°á»i ta Ä‘Ã£ pháº£i quy Æ°á»›c 1 Ä‘Æ¡n vá»‹ chuáº©n dÃ¹ng cho má»i thiáº¿t bá»‹ trong cÃ¹ng 1 khoáº£ng cÃ¡ch nhÃ¬n. Äiá»u nÃ y Ä‘Ã£ giÃºp anh em dev chÃºng ta dá»… thá»Ÿ hÆ¡n nhiá»u.</p><p>Hy vá»ng bÃ i viáº¿t nÃ y giÃºp má»i ngÆ°á»i hiá»ƒu thÃªm vá» Ä‘Æ¡n vá»‹ px mÃ  mÃ¬nh váº«n sá»­ dá»¥ng thÆ°á»ng ngÃ y.</p><p>Äá»‹nh viáº¿t thÃªm cáº£ vá» <code>dp</code> trong Android mÃ  cáº£m tháº¥y bÃ i dÃ i quÃ¡ rá»“i, cÃ³ láº½ mÃ¬nh sáº½ Ä‘á»ƒ ká»³ tá»›i, mong cÃ¡c báº¡n á»§ng há»™.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-tham-kháº£o"></a>5. Tham kháº£o<a class="hash-link" href="#5-tham-kháº£o" title="Direct link to heading">#</a></h1><ul><li><p><a href="https://www.w3.org/TR/css-values-4/#px" target="_blank" rel="noopener noreferrer">w3</a></p></li><li><p><a href="https://www.html5rocks.com/en/mobile/high-dpi/" target="_blank" rel="noopener noreferrer">html5rocks</a></p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noopener noreferrer">Mozilla Docs</a></p></li><li><p>HÃ¬nh áº£nh thÃ¬ láº¥y tÃ¹m lum quÃ¡ mÃ  quÃªn lÆ°u nguá»“n T.T</p></li></ul></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/frontend">frontend</a><a class="margin-horiz--sm" href="/blog/tags/css">css</a><a class="margin-horiz--sm" href="/blog/tags/html">html</a></div></footer></article><article class="margin-bottom--xl"><header><h2 class="margin-bottom--sm blogPostTitle_GeHD"><a href="/blog/tdd-bdd-noi-de-hon-lam">TDD/BDD - NÃ³i dá»… hÆ¡n lÃ m</a></h2><div class="margin-vert--md"><time datetime="2018-09-22T00:00:00.000Z" class="blogPostDate_fNvV">September 22, 2018 Â· 7 min read</time></div><div class="avatar margin-vert--md"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="LÃª SÄ© BÃ­ch"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer">LÃª SÄ© BÃ­ch</a></h4><small class="avatar__subtitle">Ruby on Rails/React Developer</small></div></div></header><div class="markdown"><p>Má»™t vÃ i lÆ°u Ã½ trÆ°á»›c khi báº¯t Ä‘áº§u.</p><ul><li>Code demo trong bÃ i sáº½ sá»­ dá»¥ng rspec, capybara, factory_bot (Ruby/Rails), hÆ°á»›ng tá»›i Ä‘á»‘i tÆ°á»£ng Web developer.</li><li>BÃ i viáº¿t khÃ´ng trÃ¡nh khá»i thiáº¿u sÃ³t, náº¿u cÃ³ chá»— nÃ o khÃ´ng Ä‘Ãºng, má»i ngÆ°á»i cá»© quÄƒng gáº¡ch á»Ÿ dÆ°á»›i comment :v</li></ul><p>Ã”ng cha ta cÃ³ cÃ¢u &quot;Dá»¥c tá»‘c báº¥t Ä‘áº¡t&quot;. TrÆ°á»›c khi Ä‘i vÃ o chi tiáº¿t, ta hÃ£y cÃ¹ng Ä‘iá»ƒm qua má»™t vÃ i khÃ¡i niá»‡m trÆ°á»›c.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-test-lÃ -gÃ¬"></a>1. Test lÃ  gÃ¬?<a class="hash-link" href="#1-test-lÃ -gÃ¬" title="Direct link to heading">#</a></h1><p>Náº¿u báº¡n lÃ  má»™t developer, cháº¯c háº³n sáº½ khÃ´ng láº¡ láº«m gÃ¬ khÃ¡i niá»‡m &quot;testing&quot;.</p><p>VÃ­ dá»¥ khi báº¡n láº­p trÃ¬nh chá»©c nÄƒng Ä‘Äƒng nháº­p cá»§a 1 trang web. Sau má»™t há»“i hÃ¬ há»¥c code, cháº¯c háº³n báº¡n sáº½ vÃ o trang Ä‘Ã³, tiáº¿n hÃ nh Ä‘Äƒng nháº­p, rá»“i chá» xem code mÃ¬nh cÃ³ cháº¡y Ä‘Ãºng hay khÃ´ng :v</p><p>Tuy nhiÃªn giá» Ä‘Ã¢y, Ä‘a sá»‘ Ä‘á»u sá»­ dá»¥ng cÃ¡c automated test script Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a quÃ¡ trÃ¬nh test. HÆ¡n tháº¿, nÃ³ cÃ²n giÃºp nhá»¯ng ngÆ°á»i maintainer sau nÃ y cÃ³ thá»ƒ hiá»ƒu <del>cÃ¡i Ä‘á»‘ng há»• lá»‘n</del> code báº¡n Ä‘á»ƒ láº¡i cháº¡y nhÆ° tháº¿ nÃ o.</p><p>Test khÃ¡c vá»›i Debug.</p><p>CÃ¡c loáº¡i test nÃªn chÃº Ã½:</p><ul><li>Unit test: test riÃªng láº» tá»«ng class/function, viáº¿t khÃ¡ dá»….</li><li>Integration test, Feature test: á»Ÿ Ä‘Ã¢y báº¯t Ä‘áº§u cÃ³ sá»± káº¿t há»£p giá»¯a nhiá»u module vá»›i nhau Ä‘á»ƒ mÃ´ táº£ 1 (hay nhiá»u) chá»©c nÄƒng cá»§a á»©ng dá»¥ng.</li></ul><p>MÃ u sáº¯c Ä‘áº·c trÆ°ng:</p><ul><li>Äá»: xin chia buá»“n test cá»§a báº¡n Ä‘Ã£ táº¡ch =))</li><li>Xanh: chÃºc má»«ng, test Ä‘Ã£ pass, code cá»§a báº¡n &quot;cÃ³ thá»ƒ&quot; Ä‘Ã£ cháº¡y Ä‘Ãºng.</li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-tdd---test-driven-development"></a>2. TDD - Test Driven Development<a class="hash-link" href="#2-tdd---test-driven-development" title="Direct link to heading">#</a></h1><p>Dá»‹ch ra thÃ¬ sáº½ lÃ  <strong>PhÃ¡t triá»ƒn vá»›i trá»ng tÃ¢m lÃ  kiá»ƒm thá»­ (test)</strong>, hay nÃ´m na lÃ  test trÆ°á»›c code sau.</p><p><img src="https://images.viblo.asia/bd25076f-2ddb-4b27-888e-d58ab8e8c286.png" alt="TDD"></p><ul><li><p>TrÆ°á»›c tiÃªn ta viáº¿t cÃ¡c test script vÃ  cháº¡y chÃºng, táº¥t nhiÃªn lÃ  sáº½ fail vÃ¬ lÃ m gÃ¬ cÃ³ code =))</p><p>VD ta muá»‘n viáº¿t 1 hÃ m tÃ­nh sá»‘ Fibonacci:</p><p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6693d2c78bc8132bb9b65be861148ca574a738ef" alt="Fibonacci"></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># spec/fibonacci_spec.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">describe &quot;#fibonacci_of&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  context &quot;one&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    it &quot;returns 1&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      expect(fibonacci_of(1)).to eq 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  context &quot;two&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    it &quot;returns 1&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      expect(fibonacci_of(2)).to eq 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  context &quot;greater than two&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    it &quot;returns sum of two elements before&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      expect(fibonacci_of(4)).to eq 3</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Rá»“i ta má»›i báº¯t tay vÃ o code, cháº¡y test, náº¿u fail thÃ¬ láº¡i hÃ¬ há»¥c sá»­a, há»ng Ä‘Ã¢u vÃ¡ Ä‘Ã³. LÃºc nÃ y báº¡n chÆ°a cáº§n báº­n tÃ¢m vá» viá»‡c code mÃ¬nh cÃ³ dá»… hiá»ƒu/Ä‘áº¹p khÃ´ng.</p><p>VÃ  sau 1 há»“i thÃ¬ cuá»‘i cÃ¹ng test ta cÅ©ng pass :v</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># fibonacci.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def fibonacci_of(n)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  case n</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  when 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  when 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    fibonacci_of(n - 1) + fibonacci_of(n - 2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Ta sáº½ nhÃ¬n láº¡i Ä‘á»‘ng há»• lá»‘n mÃ  ta vá»«a viáº¿t ra, tá»‰a tÃ³t láº¡i cho Ä‘áº¹p máº¯t, tÃ¡ch service cÃ¡c thá»©. VÃ  nhá»› ráº±ng Ä‘á»«ng lÃ m cho test Ä‘á» lÃ²m.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># fibonacci.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">def fibonacci_of(n)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  return 1 if [1, 2].include?(n)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  fibonacci_of(n - 1) + fibonacci_of(n - 2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul><p><strong>LÆ°u Ã½:</strong> KhÃ´ng pháº£i cá»© test pass lÃ  app cá»§a ta Ä‘Ã£ cháº¡y Ä‘Ãºng, viá»‡c nÃ y cÃ²n bao gá»“m nhiá»u yáº¿u tá»‘ khÃ¡c nhÆ°</p><ul><li>Ta cÃ³ hiá»ƒu Ä‘Ãºng yÃªu cáº§u cá»§a khÃ¡ch hÃ ng khÃ´ng</li><li>Test cá»§a ta Ä‘Ã£ bao gá»“m háº¿t cÃ¡c trÆ°á»ng há»£p cÃ³ thá»ƒ chÆ°a</li></ul><p>CÃ³ thá»ƒ dá»… dÃ ng nháº­n tháº¥y, hÃ m <code>#fibonacci_of</code> á»Ÿ trÃªn sáº½ cháº¿t ngay láº­p tá»©c náº¿u gáº·p tham sá»‘ <code>&lt;= 0</code>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-bdd---behavior-driven-development"></a>3. BDD - Behavior Driven Development<a class="hash-link" href="#3-bdd---behavior-driven-development" title="Direct link to heading">#</a></h1><p><img src="http://blog.andolasoft.com/wp-content/uploads/2015/05/TDD-vs-BDD.jpg" alt="BDD"></p><p>Káº¿ thá»«a ngÆ°á»i tiá»n nhiá»‡m TDD vá»›i phÆ°Æ¡ng chÃ¢m &quot;Test trÆ°á»›c code sau&quot;, BDD chá»‰ khÃ¡c chÃºt lÃ  ta sáº½ táº­p trung vÃ o hÃ nh vi ngÆ°á»i dÃ¹ng (feature).</p><p>Theo Ä‘Ã³, ta sáº½ viáº¿t cÃ¡c feature test trÆ°á»›c (mÃ´ táº£ má»™t tÃ­nh nÄƒng cá»§a á»©ng dá»¥ng, hoáº·c usecase/userstory). Vá»›i má»—i feature test Ä‘Ã³, ta cÃ³ thá»ƒ sáº½ pháº£i triá»ƒn khai thÃªm 1 vÃ i unit test/integration test cho cÃ¡c class/function cáº§n thiáº¿t trong feature test.</p><p>VÃ­ dá»¥: Ta muá»‘n xÃ¢y dá»±ng tÃ­nh nÄƒng táº¡o album cho á»©ng dá»¥ng quáº£n lÃ½ album nháº¡c.</p><p>TrÆ°á»›c háº¿t hÃ£y hÃ¬nh dung tÃ­nh nÄƒng nÃ y trong Ä‘áº§u:</p><blockquote><p>Admin tá»« trang index albums (/albums), báº¥m nÃºt &quot;Add album&quot;, 1 form sáº½ hiá»‡n ra Ä‘á»ƒ nháº­p thÃ´ng tin album (bao gá»“m title vÃ  artist name).</p><p>Náº¿u anh admin nÃ y nháº­p Ä‘Ãºng, hÃ£y redirect sang trang index vÃ  hiá»ƒn thá»‹ album má»›i nÃ y, cÃ²n khÃ´ng thÃ¬ hÃ£y hiá»‡n lá»—i Ä‘á»ƒ anh admin cÃ²n biáº¿t Ä‘Æ°á»ng mÃ  láº§n.</p></blockquote><p>Feature test cá»§a ta sáº½ nhÆ° sau:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># spec/features/create_album_spec.rb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RSpec.feature &quot;album creating process&quot;, type: :feature do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  context &quot;all fields are filled correctly&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    it &quot;create a new album&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      visit &#x27;/albums&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      click_link &#x27;Add album&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      within &#x27;form#album_form&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fill_in &#x27;Title&#x27;, with: &#x27;Chay ngay di&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fill_in &#x27;Artist name&#x27;, with: &quot;Sep&#x27;ss&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      click_button &#x27;Create&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      expect(page).to have_content(&#x27;Chay ngay di&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  context &quot;title is blank&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    it &quot;show errors&quot; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      visit &#x27;/albums&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      click_link &#x27;Add album&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      within &#x27;form#album_form&#x27; do</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fill_in &#x27;Artist name&#x27;, with: &quot;Sep&#x27;ss&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      click_button &#x27;Create&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      expect(page).to have_content(&quot;Title can&#x27;t be blank&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Náº¿u lÃ m theo Ä‘Ãºng flow cá»§a Rails, ta sáº½ pháº£i viáº¿t unit test cho:</p><ul><li>Controller: index, create - test xem logic bÃªn trong Ä‘Ã£ Ä‘Ãºng chÆ°a, status code ra sao.</li><li>View: new, index - test xem trÆ°á»ng há»£p cÃ³ lá»—i thÃ¬ form hiá»ƒn thá»‹ sao, hay trÆ°á»ng há»£p khÃ´ng cÃ³ album thÃ¬ view index cÃ³ thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng biáº¿t hay khÃ´ng.</li><li>Model: album - test xem validate cÃ³ hoáº¡t Ä‘á»™ng hay khÃ´ng.</li></ul><p>Chi tiáº¿t thÃ¬ mÃ¬nh xin lÆ°á»£c bá»›t vÃ¬ dÃ i quÃ¡, báº¡n cÃ³ thá»ƒ tham kháº£o thÃªm á»Ÿ <a href="http://hanamirb.org/guides/1.2/getting-started/" target="_blank" rel="noopener noreferrer">Ä‘Ã¢y</a>.</p><p>Náº¿u báº¡n bÄƒn khoÄƒn nÃªn test cÃ¡i gÃ¬ trong Rails, cÃ³ thá»ƒ tham kháº£o bÃ i <a href="https://m.patrikonrails.com/how-i-test-my-rails-applications-cf150e347a6b" target="_blank" rel="noopener noreferrer">nÃ y</a>.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-cÃ¡c-nguyÃªn-táº¯c-khi-viáº¿t-test-tdd"></a>3. CÃ¡c nguyÃªn táº¯c khi viáº¿t test (TDD)<a class="hash-link" href="#3-cÃ¡c-nguyÃªn-táº¯c-khi-viáº¿t-test-tdd" title="Direct link to heading">#</a></h1><ol><li><p>Chá»‰ viáº¿t code khi nÃ³ cáº§n thiáº¿t Ä‘á»ƒ test cá»§a báº¡n pass.</p><p>VD báº¡n viáº¿t má»™t hÃ m láº¥y vá» email cá»§a ngÆ°á»i dÃ¹ng theo <code>id</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly ruby"><div tabindex="0" class="prism-code language-ruby codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">def get_user_mail_by_id(id)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  user = User.find(id)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  user.mail</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">end</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>á» Ä‘Ã¢y báº¯t buá»™c pháº£i truy váº¥n CSDL Ä‘á»ƒ tÃ¬m ra user. KhÃ´ng dÃ¹ng <code>find</code> thÃ¬ láº¥y thÃ´ng tin user tháº¿ nÃ o :v</p></li><li><p>Chá»‰ viáº¿t nÃªn unit test trong pháº¡m vi vá»«a Ä‘á»§.</p></li></ol><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-Æ°u-Ä‘iá»ƒm"></a>4. Æ¯u Ä‘iá»ƒm<a class="hash-link" href="#4-Æ°u-Ä‘iá»ƒm" title="Direct link to heading">#</a></h1><ul><li><p>Nhá»¯ng ngÆ°á»i nÃ£o to trÃªn tháº¿ giá»›i Ä‘Ã£ chá»©ng minh Ä‘Æ°á»£c TDD giÃºp thay Ä‘á»•i mindset cá»§a báº¡n, vÃ  báº¡n sáº½ trá»Ÿ thÃ nh nhá»¯ng láº­p trÃ¬nh viÃªn tá»‘t hÆ¡n.</p><p>NÃ³ Ä‘Ã²i há»i báº¡n pháº£i thu táº­p trung hÆ¡n vÃ o nhá»¯ng chi tiáº¿t nhá» Ä‘á»ƒ test cá»§a mÃ¬nh pass, hÆ¡n lÃ  suy nghÄ© váº©n vÆ¡ vá» cáº£ cÃ¡i app to Ä‘Ã¹ng.</p></li><li><p>NgoÃ i kiá»ƒm thá»­, test cÅ©ng lÃ  docs cho maintainer sau nÃ y, nÃ³ cung cáº¥p chi tiáº¿t vá» cÃ¡c Ä‘áº·c táº£ ká»¹ thuáº­t (specification) cá»§a app.</p></li><li><p>Ãt bug hÆ¡n, dá»… báº£o trÃ¬, phÃ¡t hiá»‡n lá»—i sá»›m.</p></li><li><p>Cho báº¡n biáº¿t code mÃ  báº¡n vá»«a viáº¿t xong nÃ³ lÃ m há»ng cáº£ app khÃ´ng =))</p></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-káº¿t-luáº­n"></a>5. Káº¿t luáº­n<a class="hash-link" href="#5-káº¿t-luáº­n" title="Direct link to heading">#</a></h1><ul><li><p>TDD/BDD thá»±c sá»± ráº¥t tá»‘t, náº¿u báº¡n muá»‘n trá»Ÿ thÃ nh má»™t láº­p trÃ¬nh viÃªn tá»‘t hÆ¡n, hÃ£y cá»‘ gáº¯ng tryhard :v</p></li><li><p>ThÆ°á»ng má»i ngÆ°á»i hay cÃ³ xu hÆ°á»›ng code xong má»›i viáº¿t test, vÃ  mÃ¬nh cÅ©ng lÃ  má»™t trong sá»‘ Ä‘Ã³ =)). Tuy váº­y, hÃ£y cá»‘ gáº¯ng viáº¿t test case cá»§a mÃ¬nh tháº­t minh báº¡ch, dá»… hiá»ƒu, vÃ¬ chÃ­nh báº£n thÃ¢n ta vÃ  cÃ¡c maintainer sau nÃ y.</p></li></ul><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-tham-kháº£o"></a>6. Tham kháº£o<a class="hash-link" href="#6-tham-kháº£o" title="Direct link to heading">#</a></h1><ul><li><p><a href="https://medium.com/pacroy/test-driven-development-tdd-resource-site-tdd-pacroy-com-a02e02396f32" target="_blank" rel="noopener noreferrer">Test-Driven Development (TDD) Resource Site</a></p></li><li><p><a href="http://blog.andolasoft.com/2014/06/rails-things-you-must-know-about-tdd-and-bdd.html" target="_blank" rel="noopener noreferrer">Rails: Things you must know about TDD and BDD</a></p></li><li><p><a href="https://www.madetech.com/blog/9-benefits-of-test-driven-development" target="_blank" rel="noopener noreferrer">9 Benefits of Test Driven Development</a></p></li><li><p><a href="https://apiumhub.com/tech-blog-barcelona/advantages-of-test-driven-development/" target="_blank" rel="noopener noreferrer">20 ADVANTAGES OF TEST DRIVEN DEVELOPMENT</a></p></li><li><p><a href="http://hanamirb.org/guides/1.2/getting-started/" target="_blank" rel="noopener noreferrer">Hanami Official Guide</a></p></li><li><p><a href="https://m.patrikonrails.com/how-i-test-my-rails-applications-cf150e347a6b" target="_blank" rel="noopener noreferrer">How I test Rails applications</a></p></li></ul></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/tdd">tdd</a><a class="margin-horiz--sm" href="/blog/tags/bdd">bdd</a><a class="margin-horiz--sm" href="/blog/tags/testing">testing</a><a class="margin-horiz--sm" href="/blog/tags/ruby-on-rails">ruby-on-rails</a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Self notes</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/moonlight8978/moonlight8978.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://stackoverflow.com/users/8068639/moonlight8978" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 moonlight8978. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2e9fde40.js"></script>
<script src="/assets/js/main.f5ae6226.js"></script>
</body>
</html>